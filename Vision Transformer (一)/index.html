
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://localhost:8000/Vision%20Transformer%20%28%E4%B8%80%29/">
      
      
        <link rel="prev" href="../Self-Supervised%20Learning%20MoCoV2%2C3/">
      
      
        <link rel="next" href="../Vision%20Transformer%20%20%28%E4%BA%8C%29/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Vision Transformer  (‰∏Ä) - One Last Kiss</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-M0R7V8QGQ7"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-M0R7V8QGQ7",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-M0R7V8QGQ7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="One Last Kiss" class="md-header__button md-logo" aria-label="One Last Kiss" data-md-component="logo">
      
  <img src="../img/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            One Last Kiss
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Vision Transformer  (‰∏Ä)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aletolia/aletolia.github.io.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aletolia/aletolia.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
    
  
  üè† Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Mygo/" class="md-tabs__link">
          
  
    
  
  ‚õèÔ∏è CV and Multimodels

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Session%201/" class="md-tabs__link">
          
  
    
  
  üöÄ Re:0 Road to CPath & Visualization

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../1.1%20Single-cell%20RNA%20sequencing/" class="md-tabs__link">
          
  
    
  
  üí§ Re:0 Road to scRNA-seq Analysis

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Large-scale%20foundation%20model%20on%20single-cell%20transcriptomics/" class="md-tabs__link">
          
  
    
  
  üß¨ scRNA Analysis

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../%E7%AC%AC%201%20%E7%AB%A0%20python%20%E5%85%A5%E9%97%A8/" class="md-tabs__link">
          
  
    
  
  üìê Data Structures

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Best%20practices%20for%20single-cell%20analysis%20across%20modalities/" class="md-tabs__link">
          
  
    
  
  üí° Reviews

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="One Last Kiss" class="md-nav__button md-logo" aria-label="One Last Kiss" data-md-component="logo">
      
  <img src="../img/icon.png" alt="logo">

    </a>
    One Last Kiss
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aletolia/aletolia.github.io.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aletolia/aletolia.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    üè† Home
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            üè† Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ‚õèÔ∏è CV and Multimodels
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            ‚õèÔ∏è CV and Multimodels
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mygo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MyGO: Discrete Modality Information as Fine-Grained Tokens for Multi-modal Knowledge Graph Completion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GMM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GMM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DINO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DINO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mamba/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mamba
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ViT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ViT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Self-Supervised%20Learning%20MoCo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MoCo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Self-Supervised%20Learning%20MoCoV2%2C3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MoCo V2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Vision Transformer  (‰∏Ä)
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Vision Transformer  (‰∏Ä)
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      ÁõÆÂΩï
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-self-attention" class="md-nav__link">
    <span class="md-ellipsis">
      1 ‰∏ÄÂàá‰ªé Self-attention ÂºÄÂßã
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-transformer" class="md-nav__link">
    <span class="md-ellipsis">
      2 Transformer ÁöÑÂÆûÁé∞Âíå‰ª£Á†ÅËß£ËØª
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Transformer ÁöÑÂÆûÁé∞Âíå‰ª£Á†ÅËß£ËØª">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-transformerdetection-detr" class="md-nav__link">
    <span class="md-ellipsis">
      3 Transformer+DetectionÔºöÂºïÂÖ•ËßÜËßâÈ¢ÜÂüüÁöÑÈ¶ñÂàõ DETR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      ÊÄªÁªìÔºö
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      ÂèÇËÄÉÊñáÁåÆÔºö
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%20%28%E4%BA%8C%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (‰∫å)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E4%B8%89%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer  (‰∏â)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E5%9B%9B%29%20%28TNT%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (Âõõ)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E7%9F%A5%E8%AF%86%E8%92%B8%E9%A6%8F%20%E9%A2%84%E8%AE%AD%E7%BB%83%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (Áü•ËØÜËí∏È¶è È¢ÑËÆ≠ÁªÉÔºâ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28PyramidTNT%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer(Pyramid TNT)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0%E5%92%8C%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E4%B8%93%E9%A2%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ÂÇÖÈáåÂè∂Á∫ßÊï∞ÂíåÂÇÖÈáåÂè∂ÂèòÊç¢‰∏ìÈ¢ò
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Python%20%E5%AD%98%E5%82%A8%E4%B8%8E%E8%AF%BB%E5%8F%96%20HDF5%20%E6%96%87%E4%BB%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python Â≠òÂÇ®‰∏éËØªÂèñ HDF5 Êñá‰ª∂
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Segment%20Anything%20in%20Medical%20Images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Segment Anything in Medical Images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Mamba%20Efficient%20Visual%20Representation%20Learning%20with%20Bidirectional%20State%20Space%20Model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Mamba Efficient Visual Representation Learning with Bidirectional State Space Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_18" >
        
          
          <label class="md-nav__link" for="__nav_2_18" id="__nav_2_18_label" tabindex="">
            
  
  <span class="md-ellipsis">
    üöë ÂåªÂ≠¶ÂΩ±ÂÉèÁõ∏ÂÖ≥
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_18">
            <span class="md-nav__icon md-icon"></span>
            üöë ÂåªÂ≠¶ÂΩ±ÂÉèÁõ∏ÂÖ≥
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Why%20is%20the%20winner%20the%20best/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why is the winner the best
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PORPOISE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PORPOISE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HIPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling Vision Transformers to Gigapixel Images via Hierarchical Self-Supervised Learning(HIPT)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Data-efficient%20and%20weakly%20supervised%20computational%20pathology%20on%20whole-slide%20images%28CLAM%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data efficient and weakly supervised computational pathology on whole slide images(CLAM)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Towards%20a%20general-purpose%20foundation%20model%20for%20computational%20pathology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Towards a general purpose foundation model for computational pathology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20whole-slide%20foundation%20model%20for%20digital%20pathology%20from%20real-world%20data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A whole slide foundation model for digital pathology from real world data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20visual-language%20foundation%20model%20for%20computational%20pathology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A visual language foundation model for computational pathology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Recurrent%20memory%20with%20optimal%20polynomial%20projections./" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recurrent memory with optimal polynomial projections.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Modeling%20Dense%20Multimodal%20Interactions%20Between%20Biological%20Pathways%20and%20Histology%20for%20Survival%20Prediction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Dense Multimodal Interactions Between Biological Pathways and Histology for Survival Prediction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Inferring%20super-resolution%20tissue%20architecture%20by%20integrating%20spatial%20transcriptomics%20with%20histology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inferring super resolution tissue architecture by integrating spatial transcriptomics with histology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Prediction%20of%20recurrence%20risk%20in%20endometrial%20cancer%20with%20multimodal%20deep%20learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prediction of recurrence risk in endometrial cancer with multimodal deep learning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üöÄ Re:0 Road to CPath & Visualization
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üöÄ Re:0 Road to CPath & Visualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ÁêÜËß£ÂÖ®ÂπÖÂàáÁâáÂõæÂÉè
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%202/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Âú®ËÆ°ÁÆóÁóÖÁêÜÂ≠¶‰∏≠Áî®‰∫éÁôåÁóáËØäÊñ≠ÁöÑÂº±ÁõëÁù£Ê∑±Â∫¶Â≠¶‰π†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Âü∫‰∫éÊ≥®ÊÑèÂäõÁöÑÂ§öÁ§∫‰æãÂ≠¶‰π†ÂèØËß£ÈáäÊÄß
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../How%20to%20visualize%20Attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to visualize Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AttentionViz%20A%20Global%20View%20of%20Transformer%20Attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AttentionViz A Global View of Transformer Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformer%20Interpretability%20Beyond%20Attention%20Visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer Interpretability Beyond Attention Visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Visualization%20Work%20Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualization Work Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Attention%20Generation%20Work%20Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attention Generation Work Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ü™õ PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            ü™õ PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Autograd%20mechanics%20%E2%80%94%20PyTorch%202_3%20documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autograd mechanics ‚Äî PyTorch 2 3 documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PyTorch%20Autograd%20Explained%20-%20In-depth%20Tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Autograd Explained   In depth Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üí§ Re:0 Road to scRNA-seq Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            üí§ Re:0 Road to scRNA-seq Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Using Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Using Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚è≥ CHAPTER 1 ÁÆÄ‰ªã
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            ‚è≥ CHAPTER 1 ÁÆÄ‰ªã
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.1%20Single-cell%20RNA%20sequencing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1.The building block of life
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.2%20Raw%20Data%20Processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 Raw data processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.3%20Analysis%20frameworks%20and%20tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Analysis frameworks and tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üåè CHAPTER 2 Êï∞ÊçÆÂáÜÂ§á‰∏éÂèØËßÜÂåñ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            üåè CHAPTER 2 Êï∞ÊçÆÂáÜÂ§á‰∏éÂèØËßÜÂåñ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1%20quality_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 Quality Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2%20normalization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 Normalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.3_feature_selection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 Feature selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.4_dimensionality_reduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4 Dimensionality Reduction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_3" id="__nav_4_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üçÄ CHAPTER 3 ËØÜÂà´ÁªÜËÉûÁªìÊûÑ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_3">
            <span class="md-nav__icon md-icon"></span>
            üçÄ CHAPTER 3 ËØÜÂà´ÁªÜËÉûÁªìÊûÑ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.1clustering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 Clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.2annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 Annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 Data integration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4" id="__nav_4_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚è±Ô∏è CHAPTER 4 Êé®Êñ≠ÁªÜËÉûËΩ®Ëøπ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4">
            <span class="md-nav__icon md-icon"></span>
            ‚è±Ô∏è CHAPTER 4 Êé®Êñ≠ÁªÜËÉûËΩ®Ëøπ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pseudotemporal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 Pseudotemporal ordering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rna_velocity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 RNA velocity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lineage_tracing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 Lineage tracing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_5" >
        
          
          <label class="md-nav__link" for="__nav_4_1_5" id="__nav_4_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üéÅ CHAPTER 5 Â∫îÂØπÁâπÊÆäÊÉÖÂÜµ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_5">
            <span class="md-nav__icon md-icon"></span>
            üéÅ CHAPTER 5 Â∫îÂØπÁâπÊÆäÊÉÖÂÜµ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../differential_gene_expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 Differential gene expression analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compositional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 Compositional analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gsea_pathway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 Gene set enrichment and pathway analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perturbation_modeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4 Perturbation modeling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_6" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6" id="__nav_4_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚öôÔ∏è CHAPTER 6 Êú∫Âà∂Âª∫Ê®°
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6">
            <span class="md-nav__icon md-icon"></span>
            ‚öôÔ∏è CHAPTER 6 Êú∫Âà∂Âª∫Ê®°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gene_regulatory_networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 Gene regulatory networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cell_cell_communication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 Cell-cell communication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_7" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7" id="__nav_4_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üîì CHAPTER 7 ÂèçÂç∑ÁßØ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7">
            <span class="md-nav__icon md-icon"></span>
            üîì CHAPTER 7 ÂèçÂç∑ÁßØ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bulk_deconvolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1 Bulk deconvolution
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ÁÆÄÊòéÊòìÊáÇÁöÑÂçïÁªÜËÉûÂàÜÊûêÊµÅÁ®ãÔºà‰ΩøÁî® R ËØ≠Ë®ÄÔºâ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            ÁÆÄÊòéÊòìÊáÇÁöÑÂçïÁªÜËÉûÂàÜÊûêÊµÅÁ®ãÔºà‰ΩøÁî® R ËØ≠Ë®ÄÔºâ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%89%8D%E8%A8%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ÂâçË®Ä
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ÁéØÂ¢ÉÈÖçÁΩÆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.1%20%E6%9E%84%E5%BB%BA%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E5%88%86%E6%9E%90%E7%8E%AF%E5%A2%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1 ÊûÑÂª∫ÂçïÁªÜËÉû RNA seq ÂàÜÊûêÁéØÂ¢É
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.2%20R%20%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 R ÁéØÂ¢ÉÂÆâË£Ö
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.3%20Docker%20%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Docker ÂÆâË£Ö
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.4%20%E5%9C%A8%20Docker%20%E4%B8%AD%E5%90%AF%E5%8A%A8%20Rstudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4 Âú® Docker ‰∏≠ÂêØÂä® Rstudio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.5%20%E6%9C%89%E5%85%B3%20Bioconductor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5 ÊúâÂÖ≥ Bioconductor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1%20R%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 R ÁöÑÂü∫Êú¨Áî®Ê≥ï
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2%20%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%20DataFrame%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 Â¶Ç‰ΩïÂ§ÑÁêÜ DataFrameÔºü
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.3%20%E4%BD%BF%E7%94%A8%20ggplot2%20%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 ‰ΩøÁî® ggplot2 ÂèØËßÜÂåñÊï∞ÊçÆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.1%20PCA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 PCA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.2%20%E4%BD%BF%E7%94%A8%20clusterPlofiler%20%E8%BF%9B%E8%A1%8C%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 ‰ΩøÁî® clusterPlofiler ËøõË°åÂØåÈõÜÂàÜÊûê
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3%20%E5%9F%BA%E5%9B%A0%E6%9C%AC%E4%BD%93%EF%BC%88GO%EF%BC%89%E4%B8%AD%E5%90%84%20BP%E3%80%81MF%20%E5%92%8C%20CC%20%E7%9A%84%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 Âü∫Âõ†Êú¨‰ΩìÔºàGOÔºâ‰∏≠ÂêÑ BP„ÄÅMF Âíå CC ÁöÑÂØåÈõÜÂàÜÊûê
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3%20%E4%BD%BF%E7%94%A8%20DEseq2%20%E6%8F%90%E5%8F%96%20RNA-seq%20%E5%88%86%E6%9E%90%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%20DEG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 ‰ΩøÁî® DEseq2 ÊèêÂèñ RNA seq ÂàÜÊûêÊï∞ÊçÆ‰∏≠ÁöÑ DEG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.4%20%E4%BD%BF%E7%94%A8%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88KEGG%E3%80%81Reactome%20%E7%AD%89%EF%BC%89%E8%BF%9B%E8%A1%8C%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4 ‰ΩøÁî®ÂÖ∂‰ªñÊï∞ÊçÆÂ∫ìÔºàKEGG„ÄÅReactome Á≠âÔºâËøõË°åÂØåÈõÜÂàÜÊûê
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.1%20scRNA-seq%20%E6%A6%82%E8%A6%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 scRNA seq Ê¶ÇË¶Å
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.2%20%E5%87%86%E5%A4%87%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 ÂáÜÂ§á‰ΩøÁî® Seurat ËøõË°åÂàÜÊûê
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.3%20%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 ‰ΩøÁî® Seurat ËøõË°åÊï∞ÊçÆÈ¢ÑÂ§ÑÁêÜ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.4%20%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%9A%84%E4%B8%80%E8%88%AC%E9%A1%BA%E5%BA%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4 ‰ΩøÁî® Seurat ËøõË°åÊï∞ÊçÆÂàÜÊûêÁöÑ‰∏ÄËà¨È°∫Â∫è
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.1%20%E5%A6%82%E4%BD%95%E6%9F%A5%E6%89%BE%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 Â¶Ç‰ΩïÊü•ÊâæÂçïÁªÜËÉû RNA seq Êï∞ÊçÆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.2%20%E4%B8%BA%E6%AF%8F%E4%B8%AA%E7%B0%87%E8%87%AA%E5%8A%A8%E6%B7%BB%E5%8A%A0%E7%BB%86%E8%83%9E%E6%B3%A8%E9%87%8A%E6%A0%87%E7%AD%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 ‰∏∫ÊØè‰∏™Á∞áËá™Âä®Ê∑ªÂä†ÁªÜËÉûÊ≥®ÈáäÊ†áÁ≠æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.3%20%E4%BD%BF%E7%94%A8%20FeaturePlot%20%E6%A3%80%E6%9F%A5%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 ‰ΩøÁî® FeaturePlot Ê£ÄÊü•Âü∫Âõ†Ë°®Ëææ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.4%20%E5%B0%86%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9B%B8%E4%BA%92%E7%BB%93%E5%90%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4 Â∞ÜÂçïÁªÜËÉû RNA seq Êï∞ÊçÆÈõÜÁõ∏‰∫íÁªìÂêà
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.5%20%E7%BA%A0%E6%AD%A3%E6%89%B9%E6%AC%A1%E6%95%88%E5%BA%94%EF%BC%8C%E6%AF%94%E8%BE%83%E5%AF%B9%E7%85%A7%E7%BB%84%E5%92%8C%E5%88%BA%E6%BF%80%E7%BB%84/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.5 Á∫†Ê≠£ÊâπÊ¨°ÊïàÂ∫îÔºåÊØîËæÉÂØπÁÖßÁªÑÂíåÂà∫ÊøÄÁªÑ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.6%20%E7%A1%AE%E5%AE%9A%E6%AF%8F%E4%B8%AA%E7%BE%A4%E7%BB%84%E7%9A%84%E6%A0%87%E8%AE%B0%E5%9F%BA%E5%9B%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.6 Á°ÆÂÆöÊØè‰∏™Áæ§ÁªÑÁöÑÊ†áËÆ∞Âü∫Âõ†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.1%20%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%20Cell%20Ranger%20%E7%BB%9F%E8%AE%A1%20scRNA-seq%20%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%B0%B4%E5%B9%B3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 Â¶Ç‰Ωï‰ΩøÁî® Cell Ranger ÁªüËÆ° scRNA seq Êï∞ÊçÆ‰∏≠ÁöÑÂü∫Âõ†Ë°®ËææÊ∞¥Âπ≥
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.2%20%E4%BD%BF%E7%94%A8%20Cell%20Ranger%20%E5%A4%84%E7%90%86%20NCBI%20Sequence%20Read%20Archive%20%28SRA%29%20%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 ‰ΩøÁî® Cell Ranger Â§ÑÁêÜ NCBI Sequence Read Archive (SRA) Êï∞ÊçÆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.1%20%E5%85%B3%E4%BA%8E%20scRNA-seq%20%E6%95%B0%E6%8D%AE%E7%9A%84%E8%B4%A8%E9%87%8F%E6%8E%A7%E5%88%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1 ÂÖ≥‰∫é scRNA seq Êï∞ÊçÆÁöÑË¥®ÈáèÊéßÂà∂
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.2%20%E4%BD%BF%E7%94%A8%20DoubleFinder%20%E6%A3%80%E6%B5%8B%E5%8F%8C%E9%87%8D%E7%BB%86%E8%83%9E/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.2 ‰ΩøÁî® DoubleFinder Ê£ÄÊµãÂèåÈáçÁªÜËÉû
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.3%20%E7%94%A8%20CellBender%20%E5%8E%BB%E9%99%A4%E8%83%8C%E6%99%AF%20RNA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.3 Áî® CellBender ÂéªÈô§ËÉåÊôØ RNA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üß¨ scRNA Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üß¨ scRNA Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üêç Using Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            üêç Using Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Large-scale%20foundation%20model%20on%20single-cell%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Large scale foundation model on single cell transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scGPT%20toward%20building%20a%20foundation%20model%20for%20single-cell%20multi-omics%20using%20generative%20AI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scGPT toward building a foundation model for single cell multi omics using generative AI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scBERT%20as%20a%20large-scale%20pretrained%20deep%20language%20model%20for%20cell%20type%20annotation%20of%20single-cell%20RNA-seq%20data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scBERT as a large scale pretrained deep language model for cell type annotation of single cell RNA seq data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RNA%20velocity%20of%20single%20cells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RNA velocity of single cells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TFvelo_gene%20regulation%20inspired%20RNA%20velocity%20estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TFvelo gene regulation inspired RNA velocity estimation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Disentanglement%20of%20single-cell%20data%20with%20biolord/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disentanglement of single cell data with biolord
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E2%AD%90%E2%AD%90%E2%AD%90C5aR1%20inhibition%20reprograms%20tumor%20associated%20macrophages%20and%20reverses%20PARP%20inhibitor%20resistance%20in%20breast%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ‚≠ê‚≠ê‚≠êC5aR1 inhibition reprograms tumor associated macrophages and reverses PARP inhibitor resistance in breast cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Spatial%20transition%20tensor%20of%20single%20cells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial transition tensor of single cells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Statistical%20method%20scDEED%20for%20detecting%20dubious%202D%20single-cell%20embeddings%20and%20optimizing%20t-SNE%20and%20UMAP%20hyperparameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistical method scDEED for detecting dubious 2D single cell embeddings and optimizing t SNE and UMAP hyperparameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scRank%20infers%20drug-responsive%20cell%20types%20from%20untreated%20scRNA-seq%20data%20using%20a%20target-perturbed%20gene%20regulatory%20network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scRank infers drug responsive cell types from untreated scRNA seq data using a target perturbed gene regulatory network
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìî ÊñáÁåÆ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            üìî ÊñáÁåÆ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ZNF689%20deficiency%20promotes%20intratumor%20heterogeneity%20and%20immunotherapy%20resistance%20in%20triple-negative%20breast%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZNF689 deficiency promotes intratumor heterogeneity and immunotherapy resistance in triple negative breast cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tumour%20vasculature%20at%20single-cell%20resolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tumour vasculature at single-cell resolution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scRNA-seq%20of%20gastric%20tumor%20shows%20complex%20intercellular%20interaction%20with%20an%20alternative%20T%20cell%20exhaustion%20trajectory%EF%BC%88%E5%8F%82%E8%80%83%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scRNA seq of gastric tumor shows complex intercellular interaction with an alternative T cell exhaustion trajectoryÔºàÂèÇËÄÉÔºâ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20analysis%20reveals%20new%20evolutionary%20complexity%20in%20uveal%20melanoma%EF%BC%88%E5%8F%82%E8%80%83%202%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis reveals new evolutionary complexity in uveal melanomaÔºàÂèÇËÄÉ 2Ôºâ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20characterization%20of%20macrophages%20in%20uveal%20melanoma%20uncovers%20transcriptionally%20heterogeneous%20subsets%20conferring%20poor%20prognosis%20and%20aggressive%20behavior%EF%BC%88%E8%8C%83%E4%BE%8B%201%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell characterization of macrophages in uveal melanoma uncovers transcriptionally heterogeneous subsets conferring poor prognosis and aggressive behaviorÔºàËåÉ‰æã 1Ôºâ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ScRNA-seq%20of%20gastric%20cancer%20tissues%20reveals%20differences%20in%20the%20immune%20microenvironment%20of%20primary%20tumors%20and%20metastases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScRNA seq of gastric cancer tissues reveals differences in the immune microenvironment of primary tumors and metastases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Blimp-1%20and%20c-Maf%20regulate%20immune%20gene%20networks%20to%20protect%20against%20distinct%20pathways%20of%20pathobiont-induced%20colitis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blimp 1 and c Maf regulate immune gene networks to protect against distinct pathways of pathobiont induced colitis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single%20cell%20analysis%20unveils%20B%20cell-dominated%20immune%20subtypes%20in%20HNSCC%20for%20enhanced%20prognostic%20and%20therapeutic%20stratification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis unveils B cell dominated immune subtypes in HNSCC for enhanced prognostic and therapeutic stratification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20spatial%20multi-omics%20and%20deep%20learning%20dissect%20enhancer-driven%20gene%20regulatory%20networks%20in%20liver%20zonation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell spatial multi omics and deep learning dissect enhancer driven gene regulatory networks in liver zonation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Neutrophil%20profiling%20illuminates%20anti-tumor%20antigen%20presenting%20potency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neutrophil profiling illuminates anti tumor antigen presenting potency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20blueprint%20for%20tumor-infiltrating%20B%20cells%20across%20human%20cancers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A blueprint for tumor infiltrating B cells across human cancers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20transcriptomic%20analyses%20reveal%20distinct%20immune%20cell%20contributions%20to%20epithelial%20barrier%20dysfunction%20in%20checkpoint%20inhibitor%20colitis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell transcriptomic analyses reveal distinct immune cell contributions to epithelial barrier dysfunction in checkpoint inhibitor colitis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Systematic%20dissection%20of%20tumor-normal%20single-cell%20ecosystems%20across%20a%20thousand%20tumors%20of%2030%20cancer%20types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Systematic dissection of tumor normal single cell ecosystems across a thousand tumors of 30 cancer types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../The%20aged%20tumor%20microenvironment%20limits%20T%20cell%20control%20of%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The aged tumor microenvironment limits T cell control of cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TIM-3%2B%20CD8%20T%20cells%20with%20a%20terminally%20exhausted%20phenotype%20retain%20functional%20capacity%20in%20hematological%20malignancies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TIM 3+ CD8 T cells with a terminally exhausted phenotype retain functional capacity in hematological malignancies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20lactate-SREBP2%20signaling%20axis%20drives%20tolerogenic%20dendritic%20cell%20maturation%20and%20promotes%20cancer%20progression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A lactate SREBP2 signaling axis drives tolerogenic dendritic cell maturation and promotes cancer progression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20human%20omentum-specific%20mesothelial-like%20stromal%20population%20inhibits%20adipogenesis%20through%20IGFBP2%20secretion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A human omentum specific mesothelial like stromal population inhibits adipogenesis through IGFBP2 secretion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Interferon-stimulated%20neutrophils%20as%20a%20predictor%20of%20immunotherapy%20response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interferon stimulated neutrophils as a predictor of immunotherapy response
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Repression%20of%20latent%20NF-%CE%BAB%20enhancers%20by%20PDX1%20regulates%20%CE%B2%20cell%20functional%20heterogeneity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repression of latent NF Œ∫B enhancers by PDX1 regulates Œ≤ cell functional heterogeneity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20systematic%20pan-cancer%20study%20on%20deep%20learning-based%20prediction%20of%20multi-omic%20biomarkers%20from%20routine%20pathology%20images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A systematic pan cancer study on deep learning based prediction of multi omic biomarkers from routine pathology images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20and%20spatial%20transcriptomics%20analysis%20of%20non-small%20cell%20lung%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell and spatial transcriptomics analysis of non small cell lung cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Seeing%20data%20as%20t-SNE%20and%20UMAP%20do/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seeing data as t SNE and UMAP do
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mapping%20the%20cellular%20biogeography%20of%20human%20bone%20marrow%20niches%20using%20single-cell%20transcriptomics%20and%20proteomic%20imaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mapping the cellular biogeography of human bone marrow niches using single cell transcriptomics and proteomic imaging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Onco-fetal%20Reprogramming%20of%20Endothelial%20Cells%20Drives%20Immunosuppressive%20Macrophages%20in%20Hepatocellular%20Carcinoma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Onco fetal Reprogramming of Endothelial Cells Drives Immunosuppressive Macrophages in Hepatocellular Carcinoma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20analysis%20of%20anti-BCMA%20CAR%20T%20cell%20therapy%20in%20patients%20with%20central%20nervous%20system%20autoimmunity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis of anti BCMA CAR T cell therapy in patients with central nervous system autoimmunity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20sequencing%20depicts%20tumor%20architecture%20and%20empowers%20clinical%20decision%20in%20metastatic%20conjunctival%20melanoma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell sequencing depicts tumor architecture and empowers clinical decision in metastatic conjunctival melanoma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PR-SET7%20epigenetically%20restrains%20uterine%20interferon%20response%20and%20cell%20death%20governing%20proper%20postnatal%20stromal%20development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PR SET7 epigenetically restrains uterine interferon response and cell death governing proper postnatal stromal development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Clonal%20associations%20between%20lymphocyte%20subsets%20and%20functional%20states%20in%20rheumatoid%20arthritis%20synovium/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clonal associations between lymphocyte subsets and functional states in rheumatoid arthritis synovium
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìê Data Structures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìê Data Structures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%201%20%E7%AB%A0%20python%20%E5%85%A5%E9%97%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 1 Á´† python ÂÖ•Èó®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%202%20%E7%AB%A0%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 2 Á´† Èù¢ÂêëÂØπË±°ÁºñÁ®ã
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%203%20%E7%AB%A0%20%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 3 Á´† ÁÆóÊ≥ïÂàÜÊûê
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%204%20%E7%AB%A0%20%E9%80%92%E5%BD%92/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 4 Á´† ÈÄíÂΩí
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%205%20%E7%AB%A0%20%E5%9F%BA%E4%BA%8E%E6%95%B0%E7%BB%84%E7%9A%84%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 5 Á´† Âü∫‰∫éÊï∞ÁªÑÁöÑÂ∫èÂàó
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%206%20%E7%AB%A0%20%E6%A0%88%E3%80%81%E9%98%9F%E5%88%97%E5%92%8C%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 6 Á´† Ê†à„ÄÅÈòüÂàóÂíåÂèåÁ´ØÈòüÂàó
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%207%20%E7%AB%A0%20%E9%93%BE%E8%A1%A8%28Linked%20Lists%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 7 Á´† ÈìæË°®(Linked Lists)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%208%20%E7%AB%A0%20%E6%A0%91%20%E2%98%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 8 Á´† Ê†ë ‚òÖ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%209%20%E7%AB%A0%20%E4%BC%98%E5%85%88%E7%BA%A7%E9%98%9F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Á¨¨ 9 Á´† ‰ºòÂÖàÁ∫ßÈòüÂàó
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üí° Reviews
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            üí° Reviews
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üß≠ scRNA analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            üß≠ scRNA analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Best%20practices%20for%20single-cell%20analysis%20across%20modalities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Best practices for single cell analysis across modalities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Multi-omics%20integration%20in%20biomedical%20research%20%E2%80%93%20A%20metabolomics-centric%20review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi omics integration in biomedical research ‚Äì A metabolomics centric review
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Museum%20of%20spatial%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Museum of spatial transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20guide%20to%20artificial%20intelligence%20for%20cancer%20researchers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A guide to artificial intelligence for cancer researchers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ü¶† Metabolism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            ü¶† Metabolism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20analysis%20as%20a%20driver%20for%20discovery%2C%20diagnosis%2C%20and%20therapy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic analysis as a driver for discovery, diagnosis, and therapy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20heterogeneity%20in%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic heterogeneity in cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Toward%20modeling%20metabolic%20state%20from%20single-cell%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toward modeling metabolic state from single cell transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20reprogramming%20and%20cancer%20progression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic reprogramming and cancer progression
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protein
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Protein
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Proteomic%20and%20interactomic%20insights%20into%20the%20molecular%20basis%20of%20cell%20functional%20diversity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proteomic and interactomic insights into the molecular basis of cell functional diversity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      ÁõÆÂΩï
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-self-attention" class="md-nav__link">
    <span class="md-ellipsis">
      1 ‰∏ÄÂàá‰ªé Self-attention ÂºÄÂßã
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-transformer" class="md-nav__link">
    <span class="md-ellipsis">
      2 Transformer ÁöÑÂÆûÁé∞Âíå‰ª£Á†ÅËß£ËØª
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Transformer ÁöÑÂÆûÁé∞Âíå‰ª£Á†ÅËß£ËØª">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-transformerdetection-detr" class="md-nav__link">
    <span class="md-ellipsis">
      3 Transformer+DetectionÔºöÂºïÂÖ•ËßÜËßâÈ¢ÜÂüüÁöÑÈ¶ñÂàõ DETR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      ÊÄªÁªìÔºö
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      ÂèÇËÄÉÊñáÁåÆÔºö
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/aletolia/aletolia.github.io.git/edit/master/docs/Vision Transformer (‰∏Ä).md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/aletolia/aletolia.github.io.git/raw/master/docs/Vision Transformer (‰∏Ä).md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Vision Transformer  (‰∏Ä)</h1>

<div class="admonition note">
<p class="admonition-title">Attention</p>
<p>ÂéüÊñáÂú∞ÂùÄÔºöhttps://zhuanlan.zhihu.com/p/340149804</p>
</div>
<h2 id="_1">ÁõÆÂΩï<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>Transformer ÊòØ Google ÁöÑÂõ¢ÈòüÂú® 2017 Âπ¥ÊèêÂá∫ÁöÑ‰∏ÄÁßç NLP ÁªèÂÖ∏Ê®°ÂûãÔºåÁé∞Âú®ÊØîËæÉÁÅ´ÁÉ≠ÁöÑ Bert ‰πüÊòØÂü∫‰∫é Transformer„ÄÇTransformer Ê®°Âûã‰ΩøÁî®‰∫Ü Self-Attention Êú∫Âà∂Ôºå<strong>‰∏çÈááÁî®</strong> RNN ÁöÑ<strong>È°∫Â∫èÁªìÊûÑ</strong>Ôºå‰ΩøÂæóÊ®°Âûã<strong>ÂèØ‰ª•Âπ∂Ë°åÂåñËÆ≠ÁªÉ</strong>ÔºåËÄå‰∏îËÉΩÂ§ü<strong>Êã•ÊúâÂÖ®Â±Ä‰ø°ÊÅØ„ÄÇ</strong></p>
<h2 id="1-self-attention">1 ‰∏ÄÂàá‰ªé Self-attention ÂºÄÂßã<a class="headerlink" href="#1-self-attention" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>1.1 Â§ÑÁêÜ Sequence Êï∞ÊçÆÁöÑÊ®°ÂûãÔºö</strong></li>
</ul>
<p>Transformer ÊòØ‰∏Ä‰∏™ Sequence to Sequence modelÔºåÁâπÂà´‰πãÂ§ÑÂú®‰∫éÂÆÉÂ§ßÈáèÁî®Âà∞‰∫Ü self-attention„ÄÇ</p>
<p>Ë¶ÅÂ§ÑÁêÜ‰∏Ä‰∏™ SequenceÔºåÊúÄÂ∏∏ÊÉ≥Âà∞ÁöÑÂ∞±ÊòØ‰ΩøÁî® RNNÔºåÂÆÉÁöÑËæìÂÖ•ÊòØ‰∏Ä‰∏≤ vector sequenceÔºåËæìÂá∫ÊòØÂè¶‰∏Ä‰∏≤ vector sequenceÔºåÂ¶Ç‰∏ãÂõæ 1 Â∑¶ÊâÄÁ§∫„ÄÇ</p>
<p>Â¶ÇÊûúÂÅáËÆæÊòØ‰∏Ä‰∏™ single directional ÁöÑ RNNÔºåÈÇ£ÂΩìËæìÂá∫ <span class="arithmatex">\(b_4\)</span> Êó∂ÔºåÈªòËÆ§ <span class="arithmatex">\(a_1,a_2,a_3,a_4\)</span> ÈÉΩÂ∑≤ÁªèÁúãËøá‰∫Ü„ÄÇÂ¶ÇÊûúÂÅáËÆæÊòØ‰∏Ä‰∏™ bi-directional ÁöÑ RNNÔºåÈÇ£ÂΩìËæìÂá∫ <span class="arithmatex">\(b_{‰ªªÊÑè}\)</span> Êó∂ÔºåÈªòËÆ§ <span class="arithmatex">\(a_1,a_2,a_3,a_4\)</span> ÈÉΩÂ∑≤ÁªèÁúãËøá‰∫Ü„ÄÇRNN ÈùûÂ∏∏ÊìÖÈïø‰∫éÂ§ÑÁêÜ input ÊòØ‰∏Ä‰∏™ sequence ÁöÑÁä∂ÂÜµ„ÄÇ</p>
<p>ÈÇ£ RNN Êúâ‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢òÂë¢ÔºüÂÆÉÁöÑÈóÆÈ¢òÂ∞±Âú®‰∫éÔºöRNN Âæà‰∏çÂÆπÊòìÂπ∂Ë°åÂåñ (hard to parallel)„ÄÇ</p>
<p>‰∏∫‰ªÄ‰πàËØ¥ RNN Âæà‰∏çÂÆπÊòìÂπ∂Ë°åÂåñÂë¢ÔºüÂÅáËÆæÂú® single directional ÁöÑ RNN ÁöÑÊÉÖÂΩ¢‰∏ãÔºå‰Ω†‰ªäÂ§©Ë¶ÅÁÆóÂá∫ <span class="arithmatex">\(b_4\)</span> ÔºåÂ∞±ÂøÖÈ°ªË¶ÅÂÖàÁúã <span class="arithmatex">\(a_1\)</span> ÂÜçÁúã <span class="arithmatex">\(a_2\)</span> ÂÜçÁúã <span class="arithmatex">\(a_3\)</span> ÂÜçÁúã <span class="arithmatex">\(a_4\)</span> ÔºåÊâÄ‰ª•Ëøô‰∏™ËøáÁ®ãÂæàÈöæÂπ≥Ë°åÂ§ÑÁêÜ„ÄÇ</p>
<p>ÊâÄ‰ª•‰ªäÂ§©Â∞±Êúâ‰∫∫ÊèêÂá∫Êää CNN ÊãøÊù•Âèñ‰ª£ RNNÔºåÂ¶Ç‰∏ãÂõæ 1 Âè≥ÊâÄÁ§∫„ÄÇÂÖ∂‰∏≠ÔºåÊ©òËâ≤ÁöÑ‰∏âËßíÂΩ¢Ë°®Á§∫‰∏Ä‰∏™ filterÔºåÊØèÊ¨°Êâ´Ëøá 3 ‰∏™ÂêëÈáè <span class="arithmatex">\(a\)</span> ÔºåÊâ´Ëøá‰∏ÄËΩÆ‰ª•ÂêéÔºåÂ∞±ËæìÂá∫‰∫Ü‰∏ÄÊéíÁªìÊûúÔºå‰ΩøÁî®Ê©òËâ≤ÁöÑÂ∞èÂúÜÁÇπË°®Á§∫„ÄÇ</p>
<p>ËøôÊòØÁ¨¨‰∏Ä‰∏™Ê©òËâ≤ÁöÑ filter ÁöÑËøáÁ®ãÔºåËøòÊúâÂÖ∂‰ªñÁöÑ filterÔºåÊØîÂ¶ÇÂõæ 2 ‰∏≠ÁöÑÈªÑËâ≤ÁöÑ filterÔºåÂÆÉÁªèÂéÜÁùÄ‰∏éÊ©òËâ≤ÁöÑ filter Áõ∏‰ººÁöÑËøáÁ®ãÔºåÂèàËæìÂá∫‰∏ÄÊéíÁªìÊûúÔºå‰ΩøÁî®ÈªÑËâ≤ÁöÑÂ∞èÂúÜÁÇπË°®Á§∫„ÄÇ</p>
<p><img alt="" src="https://pic2.zhimg.com/v2-7a6a6f0977b06b3372b129a09a3ccb31_r.jpg" /></p>
<p><img alt="" src="https://pic2.zhimg.com/v2-cabda788832922a8f141542a334ccb61_r.jpg" /></p>
<p>ÊâÄ‰ª•ÔºåÁî® CNNÔºå‰Ω†Á°ÆÂÆû‰πüÂèØ‰ª•ÂÅöÂà∞Ë∑ü RNN ÁöÑËæìÂÖ•ËæìÂá∫Á±ª‰ººÁöÑÂÖ≥Á≥ªÔºå‰πüÂèØ‰ª•ÂÅöÂà∞ËæìÂÖ•ÊòØ‰∏Ä‰∏™ sequenceÔºåËæìÂá∫ÊòØÂè¶Â§ñ‰∏Ä‰∏™ sequence„ÄÇ</p>
<p>‰ΩÜÊòØÔºåË°®Èù¢‰∏ä CNN Âíå RNN ÂèØ‰ª•ÂÅöÂà∞Áõ∏ÂêåÁöÑËæìÂÖ•ÂíåËæìÂá∫Ôºå‰ΩÜÊòØ CNN Âè™ËÉΩËÄÉËôëÈùûÂ∏∏ÊúâÈôêÁöÑÂÜÖÂÆπ„ÄÇÊØîÂ¶ÇÂú®Êàë‰ª¨Âè≥‰æßÁöÑÂõæ‰∏≠ CNN ÁöÑ filter Âè™ËÄÉËôë‰∫Ü 3 ‰∏™ vectorÔºå‰∏çÂÉè RNN ÂèØ‰ª•ËÄÉËôë‰πãÂâçÁöÑÊâÄÊúâ vector„ÄÇ‰ΩÜÊòØ CNN ‰πü‰∏çÊòØÊ≤°ÊúâÂäûÊ≥ïËÄÉËôëÂæàÈïøÊó∂Èó¥ÁöÑ dependency ÁöÑÔºå‰Ω†Âè™ÈúÄË¶ÅÂ†ÜÂè† filterÔºåÂ§öÂ†ÜÂè†Âá†Â±ÇÔºå‰∏äÂ±ÇÁöÑ filter Â∞±ÂèØ‰ª•ËÄÉËôëÊØîËæÉÂ§öÁöÑËµÑËÆØÔºåÊØîÂ¶ÇÔºåÁ¨¨‰∫åÂ±ÇÁöÑ filter (ËìùËâ≤ÁöÑ‰∏âËßíÂΩ¢) Áúã‰∫Ü 6 ‰∏™ vectorÔºåÊâÄ‰ª•ÔºåÂè™Ë¶ÅÂè†ÂæàÂ§öÂ±ÇÔºåÂ∞±ËÉΩÂ§üÁúãÂæàÈïøÊó∂Èó¥ÁöÑËµÑËÆØ„ÄÇ</p>
<p>ËÄå CNN ÁöÑ‰∏Ä‰∏™Â•ΩÂ§ÑÊòØÔºöÂÆÉÊòØÂèØ‰ª•Âπ∂Ë°åÂåñÁöÑ (can parallel)Ôºå‰∏çÈúÄË¶ÅÁ≠âÂæÖÁ∫¢Ëâ≤ÁöÑ filter ÁÆóÂÆåÔºåÂÜçÁÆóÈªÑËâ≤ÁöÑ filter„ÄÇ‰ΩÜÊòØÂøÖÈ°ªË¶ÅÂè†ÂæàÂ§öÂ±Ç filterÔºåÊâçÂèØ‰ª•ÁúãÂà∞ÈïøÊó∂ÁöÑËµÑËÆØ„ÄÇÊâÄ‰ª•‰ªäÂ§©Êúâ‰∏Ä‰∏™ÊÉ≥Ê≥ïÔºöself-attentionÔºåÂ¶Ç‰∏ãÂõæ 3 ÊâÄÁ§∫ÔºåÁõÆÁöÑÊòØ‰ΩøÁî® self-attention layer Âèñ‰ª£ RNN ÊâÄÂÅöÁöÑ‰∫ãÊÉÖ„ÄÇ</p>
<p><img alt="" src="https://pic2.zhimg.com/v2-e3ef96ccae817226577ee7a3c28fa16d_r.jpg" /></p>
<p><strong>ÊâÄ‰ª•ÈáçÁÇπÊòØÔºöÊàë‰ª¨Êúâ‰∏ÄÁßçÊñ∞ÁöÑ layerÔºåÂè´ self-attentionÔºåÂÆÉÁöÑËæìÂÖ•ÂíåËæìÂá∫Âíå RNN ÊòØ‰∏ÄÊ®°‰∏ÄÊ†∑ÁöÑÔºåËæìÂÖ•‰∏Ä‰∏™ sequenceÔºåËæìÂá∫‰∏Ä‰∏™ sequenceÔºåÂÆÉÁöÑÊØè‰∏Ä‰∏™ËæìÂá∫ <span class="arithmatex">\(b_1-b_4\)</span> ÈÉΩÁúãËøá‰∫ÜÊï¥‰∏™ÁöÑËæìÂÖ• sequenceÔºåËøô‰∏ÄÁÇπ‰∏é bi-directional RNN Áõ∏Âêå„ÄÇ‰ΩÜÊòØÁ•ûÂ•áÁöÑÂú∞ÊñπÊòØÔºöÂÆÉÁöÑÊØè‰∏Ä‰∏™ËæìÂá∫ <span class="arithmatex">\(b_1-b_4\)</span> ÂèØ‰ª•Âπ∂Ë°åÂåñËÆ°ÁÆó„ÄÇ</strong></p>
<ul>
<li><strong>1.2 Self-attentionÔºö</strong></li>
</ul>
<p><strong>ÈÇ£‰πà self-attention ÂÖ∑‰ΩìÊòØÊÄé‰πàÂÅöÁöÑÂë¢Ôºü</strong></p>
<p><img alt="" src="https://pic3.zhimg.com/v2-8537e0996a586b7c37d5e345b6c4402a_r.jpg" /></p>
<p>È¶ñÂÖàÂÅáËÆæÊàë‰ª¨ÁöÑ input ÊòØÂõæ 4 ÁöÑ <span class="arithmatex">\(x_1-x_4\)</span> ÔºåÊòØ‰∏Ä‰∏™ sequenceÔºåÊØè‰∏Ä‰∏™ input (vector) ÂÖà‰πò‰∏ä‰∏Ä‰∏™Áü©Èòµ <span class="arithmatex">\(W\)</span> ÂæóÂà∞ embeddingÔºåÂç≥ÂêëÈáè <span class="arithmatex">\(a_1-a_4\)</span> „ÄÇÊé•ÁùÄËøô‰∏™ embedding ËøõÂÖ• self-attention Â±ÇÔºåÊØè‰∏Ä‰∏™ÂêëÈáè <span class="arithmatex">\(a_1-a_4\)</span> ÂàÜÂà´‰πò‰∏ä 3 ‰∏™‰∏çÂêåÁöÑ transformation matrix <span class="arithmatex">\(W_q,W_k,W_v\)</span> Ôºå‰ª•ÂêëÈáè <span class="arithmatex">\(a_1\)</span> ‰∏∫‰æãÔºåÂàÜÂà´ÂæóÂà∞ 3 ‰∏™‰∏çÂêåÁöÑÂêëÈáè <span class="arithmatex">\(q_1,k_1,v_1\)</span> „ÄÇ</p>
<p><img alt="" src="https://pic4.zhimg.com/v2-197b4f81d688e4bc40843fbe41c96787_r.jpg" /></p>
<p>Êé•‰∏ãÊù•‰ΩøÁî®ÊØè‰∏™ query <span class="arithmatex">\(q\)</span> ÂéªÂØπÊØè‰∏™ key <span class="arithmatex">\(k\)</span> ÂÅö attentionÔºåattention Â∞±ÊòØÂåπÈÖçËøô 2 ‰∏™ÂêëÈáèÊúâÂ§öÊé•ËøëÔºåÊØîÂ¶ÇÊàëÁé∞Âú®Ë¶ÅÂØπ <span class="arithmatex">\(q^1\)</span> Âíå <span class="arithmatex">\(k^1\)</span> ÂÅö attentionÔºåÊàëÂ∞±ÂèØ‰ª•ÊääËøô 2 ‰∏™ÂêëÈáèÂÅö <strong>scaled inner product</strong>ÔºåÂæóÂà∞ <span class="arithmatex">\(\alpha_{1,1}\)</span> „ÄÇÊé•‰∏ãÊù•‰Ω†ÂÜçÊãø <span class="arithmatex">\(q^1\)</span> Âíå <span class="arithmatex">\(k^2\)</span> ÂÅö attentionÔºåÂæóÂà∞ <span class="arithmatex">\(\alpha_{1,2}\)</span> Ôºå‰Ω†ÂÜçÊãø <span class="arithmatex">\(q^1\)</span> Âíå <span class="arithmatex">\(k^3\)</span> ÂÅö attentionÔºåÂæóÂà∞ <span class="arithmatex">\(\alpha_{1,3}\)</span> Ôºå‰Ω†ÂÜçÊãø <span class="arithmatex">\(q^1\)</span> Âíå <span class="arithmatex">\(k^4\)</span> ÂÅö attentionÔºåÂæóÂà∞ <span class="arithmatex">\(\alpha_{1,4}\)</span> „ÄÇÈÇ£Ëøô‰∏™ scaled inner product ÂÖ∑‰ΩìÊòØÊÄé‰πàËÆ°ÁÆóÁöÑÂë¢Ôºü</p>
<div class="arithmatex">\[\alpha_{1,i}=q^1\cdot k^i/\sqrt{d} \tag{1}\]</div>
<p>Âºè‰∏≠Ôºå <span class="arithmatex">\(d\)</span> ÊòØ <span class="arithmatex">\(q\)</span> Ë∑ü <span class="arithmatex">\(k\)</span> ÁöÑÁª¥Â∫¶„ÄÇÂõ†‰∏∫ <span class="arithmatex">\(q\cdot k\)</span> ÁöÑÊï∞ÂÄº‰ºöÈöèÁùÄ dimension ÁöÑÂ¢ûÂ§ßËÄåÂ¢ûÂ§ßÔºåÊâÄ‰ª•Ë¶ÅÈô§‰ª• <span class="arithmatex">\(\sqrt{\text{dimension}}\)</span> ÁöÑÂÄºÔºåÁõ∏ÂΩì‰∫éÂΩí‰∏ÄÂåñÁöÑÊïàÊûú„ÄÇ</p>
<p>Êé•‰∏ãÊù•Ë¶ÅÂÅöÁöÑ‰∫ãÂ¶ÇÂõæ 6 ÊâÄÁ§∫ÔºåÊääËÆ°ÁÆóÂæóÂà∞ÁöÑÊâÄÊúâ <span class="arithmatex">\(\alpha_{1,i}\)</span> ÂÄºÂèñ <span class="arithmatex">\(\text{softmax}\)</span> Êìç‰Ωú„ÄÇ</p>
<p><img alt="" src="https://pic2.zhimg.com/v2-58f7bf32a29535b57205ac2dab557be1_r.jpg" /></p>
<p>ÂèñÂÆå <span class="arithmatex">\(\text{softmax}\)</span> Êìç‰Ωú‰ª•ÂêéÔºåÊàë‰ª¨ÂæóÂà∞‰∫Ü <span class="arithmatex">\(\hat \alpha_{1,i}\)</span> ÔºåÊàë‰ª¨Áî®ÂÆÉÂíåÊâÄÊúâÁöÑ <span class="arithmatex">\(v^i\)</span> ÂÄºËøõË°åÁõ∏‰πò„ÄÇÂÖ∑‰ΩìÊù•ËÆ≤ÔºåÊää <span class="arithmatex">\(\hat \alpha_{1,1}\)</span> ‰πò‰∏ä <span class="arithmatex">\(v^1\)</span> ÔºåÊää <span class="arithmatex">\(\hat \alpha_{1,2}\)</span> ‰πò‰∏ä <span class="arithmatex">\(v^2\)</span> ÔºåÊää <span class="arithmatex">\(\hat \alpha_{1,3}\)</span> ‰πò‰∏ä <span class="arithmatex">\(v^3\)</span> ÔºåÊää <span class="arithmatex">\(\hat \alpha_{1,4}\)</span> ‰πò‰∏ä <span class="arithmatex">\(v^4\)</span> ÔºåÊääÁªìÊûúÈÄöÈÄöÂä†Ëµ∑Êù•ÂæóÂà∞ <span class="arithmatex">\(b^1\)</span> ÔºåÊâÄ‰ª•Ôºå‰ªäÂ§©Âú®‰∫ßÁîü <span class="arithmatex">\(b^1\)</span> ÁöÑËøáÁ®ã‰∏≠Áî®‰∫ÜÊï¥‰∏™ sequence ÁöÑËµÑËÆØ (Considering the whole sequence)„ÄÇÂ¶ÇÊûúË¶ÅËÄÉËôë local ÁöÑ informationÔºåÂàôÂè™ÈúÄË¶ÅÂ≠¶‰π†Âá∫Áõ∏Â∫îÁöÑ <span class="arithmatex">\(\hat \alpha_{1,i}=0\)</span> Ôºå <span class="arithmatex">\(b^1\)</span> Â∞±‰∏çÂÜçÂ∏¶ÊúâÈÇ£‰∏™ÂØπÂ∫îÂàÜÊîØÁöÑ‰ø°ÊÅØ‰∫ÜÔºõÂ¶ÇÊûúË¶ÅËÄÉËôë global ÁöÑ informationÔºåÂàôÂè™ÈúÄË¶ÅÂ≠¶‰π†Âá∫Áõ∏Â∫îÁöÑ <span class="arithmatex">\(\hat \alpha_{1,i}\ne0\)</span> Ôºå <span class="arithmatex">\(b^1\)</span> Â∞±Â∏¶ÊúâÂÖ®ÈÉ®ÁöÑÂØπÂ∫îÂàÜÊîØÁöÑ‰ø°ÊÅØ‰∫Ü„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-b7e1ffade85d4dbe3350f23e6854c272_r.jpg" /></p>
<p>ÂêåÊ†∑ÁöÑÊñπÊ≥ïÔºå‰πüÂèØ‰ª•ËÆ°ÁÆóÂá∫ <span class="arithmatex">\(b^2,b^3,b^4\)</span> ÔºåÂ¶Ç‰∏ãÂõæ 8 ÊâÄÁ§∫Ôºå <span class="arithmatex">\(b^2\)</span> Â∞±ÊòØÊãø query <span class="arithmatex">\(q^2\)</span> ÂéªÂØπÂÖ∂‰ªñÁöÑ <span class="arithmatex">\(k\)</span> ÂÅö attentionÔºåÂæóÂà∞ <span class="arithmatex">\(\hat \alpha_{2,i}\)</span> ÔºåÂÜç‰∏é value ÂÄº <span class="arithmatex">\(v^i\)</span> Áõ∏‰πòÂèñ weighted sum ÂæóÂà∞ÁöÑ„ÄÇ</p>
<p><img alt="" src="https://pic2.zhimg.com/v2-f7b03e1979c6ccd1dab4b579654c8cd5_r.jpg" /></p>
<p>ÁªèËøá‰∫Ü‰ª•‰∏ä‰∏ÄËøû‰∏≤ËÆ°ÁÆóÔºåself-attention layer ÂÅöÁöÑ‰∫ãÊÉÖË∑ü RNN ÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂè™ÊòØÂÆÉÂèØ‰ª•Âπ∂Ë°åÁöÑÂæóÂà∞ layer ËæìÂá∫ÁöÑÁªìÊûúÔºåÂ¶ÇÂõæ 9 ÊâÄÁ§∫„ÄÇÁé∞Âú®Êàë‰ª¨Ë¶ÅÁî®Áü©ÈòµË°®Á§∫‰∏äËø∞ÁöÑËÆ°ÁÆóËøáÁ®ã„ÄÇ</p>
<p><img alt="" src="https://pic2.zhimg.com/v2-67bc90b683b40488e922dcd5abcaa089_r.jpg" /></p>
<p>È¶ñÂÖàËæìÂÖ•ÁöÑ embedding ÊòØ <span class="arithmatex">\(I=[a^1,a^2,a^3,a^4]\)</span> ÔºåÁÑ∂ÂêéÁî® <span class="arithmatex">\(I\)</span> ‰πò‰ª• transformation matrix <span class="arithmatex">\(W^q\)</span> ÂæóÂà∞ <span class="arithmatex">\(Q=[q^1,q^2,q^3,q^4]\)</span> ÔºåÂÆÉÁöÑÊØè‰∏ÄÂàó‰ª£Ë°®ÁùÄ‰∏Ä‰∏™ vector <span class="arithmatex">\(q\)</span> „ÄÇÂêåÁêÜÔºåÁî® <span class="arithmatex">\(I\)</span> ‰πò‰ª• transformation matrix <span class="arithmatex">\(W^k\)</span> ÂæóÂà∞ <span class="arithmatex">\(K=[k^1,k^2,k^3,k^4]\)</span> ÔºåÂÆÉÁöÑÊØè‰∏ÄÂàó‰ª£Ë°®ÁùÄ‰∏Ä‰∏™ vector <span class="arithmatex">\(k\)</span> „ÄÇÁî® <span class="arithmatex">\(I\)</span> ‰πò‰ª• transformation matrix <span class="arithmatex">\(W^v\)</span> ÂæóÂà∞ <span class="arithmatex">\(V=[v^1,v^2,v^3,v^4]\)</span> ÔºåÂÆÉÁöÑÊØè‰∏ÄÂàó‰ª£Ë°®ÁùÄ‰∏Ä‰∏™ vector <span class="arithmatex">\(v\)</span> „ÄÇ</p>
<p><img alt="" src="https://pic2.zhimg.com/v2-b081f7cbc5ecd2471567426e696bde15_r.jpg" /></p>
<p>Êé•‰∏ãÊù•ÊòØ <span class="arithmatex">\(k\)</span> ‰∏é <span class="arithmatex">\(q\)</span> ÁöÑ attention ËøáÁ®ãÔºåÊàë‰ª¨ÂèØ‰ª•Êää vector <span class="arithmatex">\(k\)</span> Ê®™ËøáÊù•ÂèòÊàêË°åÂêëÈáèÔºå‰∏éÂàóÂêëÈáè <span class="arithmatex">\(q\)</span> ÂÅöÂÜÖÁßØÔºåËøôÈáåÁúÅÁï•‰∫Ü <span class="arithmatex">\(\sqrt{d}\)</span> „ÄÇËøôÊ†∑Ôºå <span class="arithmatex">\(\alpha\)</span> Â∞±Êàê‰∏∫‰∫Ü <span class="arithmatex">\(4\times4\)</span> ÁöÑÁü©ÈòµÔºåÂÆÉÁî± 4 ‰∏™Ë°åÂêëÈáèÊãºÊàêÁöÑÁü©ÈòµÂíå 4 ‰∏™ÂàóÂêëÈáèÊãºÊàêÁöÑÁü©ÈòµÂÅöÂÜÖÁßØÂæóÂà∞ÔºåÂ¶ÇÂõæ 11 ÊâÄÁ§∫„ÄÇ</p>
<p>Âú®ÂæóÂà∞ <span class="arithmatex">\(\hat A\)</span> ‰ª•ÂêéÔºåÂ¶Ç‰∏äÊñáÊâÄËø∞ÔºåË¶ÅÂæóÂà∞ <span class="arithmatex">\(b^1\)</span>Ôºå Â∞±Ë¶Å‰ΩøÁî® <span class="arithmatex">\(\hat \alpha_{1,i}\)</span> ÂàÜÂà´‰∏é <span class="arithmatex">\(v^i\)</span> Áõ∏‰πòÂÜçÊ±ÇÂíåÂæóÂà∞ÔºåÊâÄ‰ª• <span class="arithmatex">\(\hat A\)</span> Ë¶ÅÂÜçÂ∑¶‰πò <span class="arithmatex">\(V\)</span> Áü©Èòµ„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-6cc342a83d25ac76b767b5bbf27d9d6e_r.jpg" /></p>
<p><img alt="" src="https://pic2.zhimg.com/v2-52a5e6b928dc44db73f85001b2d1133d_r.jpg" /></p>
<p><img alt="" src="https://pic4.zhimg.com/v2-1b7d30f098f02488c48c3601f8e13033_r.jpg" /></p>
<p>Âà∞ËøôÈáå‰Ω†‰ºöÂèëÁé∞Ëøô‰∏™ËøáÁ®ãÂèØ‰ª•Ë¢´Ë°®Á§∫‰∏∫ÔºåÂ¶ÇÂõæ 12 ÊâÄÁ§∫ÔºöËæìÂÖ•Áü©Èòµ <span class="arithmatex">\(I\in R (d,N)\)</span> ÂàÜÂà´‰πò‰∏ä 3 ‰∏™‰∏çÂêåÁöÑÁü©Èòµ <span class="arithmatex">\(W_q,W_k,W_v \in R (d,d)\)</span> ÂæóÂà∞ 3 ‰∏™‰∏≠Èó¥Áü©Èòµ <span class="arithmatex">\(Q,K,V\in R (d,N)\)</span> „ÄÇÂÆÉ‰ª¨ÁöÑÁª¥Â∫¶ÊòØÁõ∏ÂêåÁöÑ„ÄÇÊää <span class="arithmatex">\(K\)</span> ËΩ¨ÁΩÆ‰πãÂêé‰∏é <span class="arithmatex">\(Q\)</span> Áõ∏‰πòÂæóÂà∞ Attention Áü©Èòµ <span class="arithmatex">\(A\in R (N,N)\)</span> Ôºå‰ª£Ë°®ÊØè‰∏Ä‰∏™‰ΩçÁΩÆ‰∏§‰∏§‰πãÈó¥ÁöÑ attention„ÄÇÂÜçÂ∞ÜÂÆÉÂèñ <span class="arithmatex">\(\text{softmax}\)</span> Êìç‰ΩúÂæóÂà∞ <span class="arithmatex">\(\hat A\in R (N,N)\)</span> ÔºåÊúÄÂêéÂ∞ÜÂÆÉ‰πò‰ª• <span class="arithmatex">\(V\)</span> Áü©ÈòµÂæóÂà∞ËæìÂá∫ vector <span class="arithmatex">\(O\in R (d,N)\)</span> „ÄÇ</p>
<div class="arithmatex">\[\hat A=\text{softmax}(A)=K^T\cdot Q \tag{2}\]</div>
<div class="arithmatex">\[O=V\cdot\hat A\tag{3}\]</div>
<p><img alt="" src="https://pic2.zhimg.com/v2-8628bf2c2bb9a7ee2c4a0fb870ab32b9_r.jpg" /></p>
<ul>
<li><strong>1.3 Multi-head Self-attentionÔºö</strong></li>
</ul>
<p>ËøòÊúâ‰∏ÄÁßç multi-head ÁöÑ self-attentionÔºå‰ª• 2 ‰∏™ head ÁöÑÊÉÖÂÜµ‰∏∫‰æãÔºöÁî± <span class="arithmatex">\(a^i\)</span> ÁîüÊàêÁöÑ <span class="arithmatex">\(q^i\)</span> Ëøõ‰∏ÄÊ≠•‰πò‰ª• 2 ‰∏™ËΩ¨ÁßªÁü©ÈòµÂèò‰∏∫ <span class="arithmatex">\(q^{i,1}\)</span> Âíå <span class="arithmatex">\(q^{i,2}\)</span> ÔºåÂêåÁêÜÁî± <span class="arithmatex">\(a^i\)</span> ÁîüÊàêÁöÑ <span class="arithmatex">\(k^i\)</span> Ëøõ‰∏ÄÊ≠•‰πò‰ª• 2 ‰∏™ËΩ¨ÁßªÁü©ÈòµÂèò‰∏∫ <span class="arithmatex">\(k^{i,1}\)</span> Âíå <span class="arithmatex">\(k^{i,2}\)</span> ÔºåÁî± <span class="arithmatex">\(a^i\)</span> ÁîüÊàêÁöÑ <span class="arithmatex">\(v^i\)</span> Ëøõ‰∏ÄÊ≠•‰πò‰ª• 2 ‰∏™ËΩ¨ÁßªÁü©ÈòµÂèò‰∏∫ <span class="arithmatex">\(v^{i,1}\)</span> Âíå <span class="arithmatex">\(v^{i,2}\)</span> „ÄÇÊé•‰∏ãÊù• <span class="arithmatex">\(q^{i,1}\)</span> ÂÜç‰∏é <span class="arithmatex">\(k^{i,1}\)</span> ÂÅö attentionÔºåÂæóÂà∞ weighted sum ÁöÑÊùÉÈáç <span class="arithmatex">\(\alpha\)</span> ÔºåÂÜç‰∏é <span class="arithmatex">\(v^{i,1}\)</span> ÂÅö weighted sum ÂæóÂà∞ÊúÄÁªàÁöÑ <span class="arithmatex">\(b^{i,1}(i=1,2,...,N)\)</span> „ÄÇÂêåÁêÜÂæóÂà∞ <span class="arithmatex">\(b^{i,2}(i=1,2,...,N)\)</span> „ÄÇÁé∞Âú®Êàë‰ª¨Êúâ‰∫Ü <span class="arithmatex">\(b^{i,1}(i=1,2,...,N)\in R(d,1)\)</span> Âíå <span class="arithmatex">\(b^{i,2}(i=1,2,...,N)\in R(d,1)\)</span> ÔºåÂèØ‰ª•ÊääÂÆÉ‰ª¨ concat Ëµ∑Êù•ÔºåÂÜçÈÄöËøá‰∏Ä‰∏™ transformation matrix Ë∞ÉÊï¥Áª¥Â∫¶Ôºå‰Ωø‰πã‰∏éÂàöÊâçÁöÑ <span class="arithmatex">\(b^{i}(i=1,2,...,N)\in R(d,1)\)</span> Áª¥Â∫¶‰∏ÄËá¥ (ËøôÊ≠•Â¶ÇÂõæ 13 ÊâÄÁ§∫)„ÄÇ</p>
<p><img alt="" src="https://pic1.zhimg.com/v2-688516477ad57f01a4abe5fd1a36e510_r.jpg" /></p>
<p><img alt="" src="https://pic3.zhimg.com/v2-b0891e9352874c9eee469372b85ecbe2_r.jpg" /></p>
<p><img alt="" src="https://pic1.zhimg.com/v2-df5d332304c2fd217705f210edd18bf4_r.jpg" /></p>
<p>‰ªé‰∏ãÂõæ 14 ÂèØ‰ª•ÁúãÂà∞ Multi-Head Attention ÂåÖÂê´Â§ö‰∏™ Self-Attention Â±ÇÔºåÈ¶ñÂÖàÂ∞ÜËæìÂÖ• <span class="arithmatex">\(X\)</span> ÂàÜÂà´‰º†ÈÄíÂà∞ 2 ‰∏™‰∏çÂêåÁöÑ Self-Attention ‰∏≠ÔºåËÆ°ÁÆóÂæóÂà∞ 2 ‰∏™ËæìÂá∫ÁªìÊûú„ÄÇÂæóÂà∞ 2 ‰∏™ËæìÂá∫Áü©Èòµ‰πãÂêéÔºåMulti-Head Attention Â∞ÜÂÆÉ‰ª¨ÊãºÊé•Âú®‰∏ÄËµ∑ (Concat)ÔºåÁÑ∂Âêé‰º†ÂÖ•‰∏Ä‰∏™ Linear Â±ÇÔºåÂæóÂà∞ Multi-Head Attention ÊúÄÁªàÁöÑËæìÂá∫ <span class="arithmatex">\(Z\)</span> „ÄÇÂèØ‰ª•ÁúãÂà∞ Multi-Head Attention ËæìÂá∫ÁöÑÁü©Èòµ <span class="arithmatex">\(Z\)</span> ‰∏éÂÖ∂ËæìÂÖ•ÁöÑÁü©Èòµ <span class="arithmatex">\(X\)</span> ÁöÑÁª¥Â∫¶ÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ</p>
<p><img alt="" src="https://pic2.zhimg.com/v2-f784c73ae6eb34a00108b64e3db394fd_r.jpg" /></p>
<p>ËøôÈáåÊúâ‰∏ÄÁªÑ Multi-head Self-attention ÁöÑËß£ÊûúÔºåÂÖ∂‰∏≠ÁªøËâ≤ÈÉ®ÂàÜÊòØ‰∏ÄÁªÑ query Âíå keyÔºåÁ∫¢Ëâ≤ÈÉ®ÂàÜÊòØÂè¶Â§ñ‰∏ÄÁªÑ query Âíå keyÔºåÂèØ‰ª•ÂèëÁé∞ÁªøËâ≤ÈÉ®ÂàÜÂÖ∂ÂÆûÊõ¥ÂÖ≥Ê≥® global ÁöÑ‰ø°ÊÅØÔºåËÄåÁ∫¢Ëâ≤ÈÉ®ÂàÜÂÖ∂ÂÆûÊõ¥ÂÖ≥Ê≥® local ÁöÑ‰ø°ÊÅØ„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-6b6c906cfca399506d324cac3292b04a_r.jpg" /></p>
<ul>
<li><strong>1.4 Positional EncodingÔºö</strong></li>
</ul>
<p>‰ª•‰∏äÊòØ multi-head self-attention ÁöÑÂéüÁêÜÔºå‰ΩÜÊòØËøòÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÊòØÔºöÁé∞Âú®ÁöÑ self-attention ‰∏≠Ê≤°Êúâ‰ΩçÁΩÆÁöÑ‰ø°ÊÅØÔºå‰∏Ä‰∏™ÂçïËØçÂêëÈáèÁöÑ ‚ÄúËøëÂú®Âí´Â∞∫‚Äù ‰ΩçÁΩÆÁöÑÂçïËØçÂêëÈáèÂíå ‚ÄúËøúÂú®Â§©Ê∂Ø‚Äù ‰ΩçÁΩÆÁöÑÂçïËØçÂêëÈáèÊïàÊûúÊòØ‰∏ÄÊ†∑ÁöÑÔºåÊ≤°ÊúâË°®Á§∫‰ΩçÁΩÆÁöÑ‰ø°ÊÅØ(No position information in self attention)„ÄÇÊâÄ‰ª•‰Ω†ËæìÂÖ• "A Êâì‰∫Ü B" ÊàñËÄÖ "B Êâì‰∫Ü A" ÁöÑÊïàÊûúÂÖ∂ÂÆûÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂõ†‰∏∫Âπ∂Ê≤°ÊúâËÄÉËôë‰ΩçÁΩÆÁöÑ‰ø°ÊÅØ„ÄÇÊâÄ‰ª•Âú® self-attention ÂéüÊù•ÁöÑ paper ‰∏≠Ôºå‰ΩúËÄÖ‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÊâÄÂÅöÁöÑ‰∫ãÊÉÖÊòØÂ¶Ç‰∏ãÂõæ 16 ÊâÄÁ§∫Ôºö</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-b8886621fc841085300f5bb21de26f0e_r.jpg" /></p>
<p><img alt="" src="https://pic4.zhimg.com/v2-7814595d02ef37cb762b3ef998fae267_r.jpg" /></p>
<p>ÂÖ∑‰ΩìÁöÑÂÅöÊ≥ïÊòØÔºöÁªôÊØè‰∏Ä‰∏™‰ΩçÁΩÆËßÑÂÆö‰∏Ä‰∏™Ë°®Á§∫‰ΩçÁΩÆ‰ø°ÊÅØÁöÑÂêëÈáè <span class="arithmatex">\(e^i\)</span> ÔºåËÆ©ÂÆÉ‰∏é <span class="arithmatex">\(a^i\)</span> Âä†Âú®‰∏ÄËµ∑‰πãÂêé‰Ωú‰∏∫Êñ∞ÁöÑ <span class="arithmatex">\(a^i\)</span> ÂèÇ‰∏éÂêéÈù¢ÁöÑËøêÁÆóËøáÁ®ãÔºå‰ΩÜÊòØËøô‰∏™ÂêëÈáè <span class="arithmatex">\(e^i\)</span> ÊòØÁî±‰∫∫Â∑•ËÆæÂÆöÁöÑÔºåËÄå‰∏çÊòØÁ•ûÁªèÁΩëÁªúÂ≠¶‰π†Âá∫Êù•ÁöÑ„ÄÇÊØè‰∏Ä‰∏™‰ΩçÁΩÆÈÉΩÊúâ‰∏Ä‰∏™‰∏çÂêåÁöÑ <span class="arithmatex">\(e^i\)</span> „ÄÇ</p>
<p>ÈÇ£Âà∞ËøôÈáå‰∏Ä‰∏™Ëá™ÁÑ∂ËÄåÁÑ∂ÁöÑÈóÆÈ¢òÊòØÔºö<strong>‰∏∫‰ªÄ‰πàÊòØ <span class="arithmatex">\(e^i\)</span> ‰∏é <span class="arithmatex">\(a^i\)</span> Áõ∏Âä†Ôºü‰∏∫‰ªÄ‰πà‰∏çÊòØ concatenateÔºüÂä†Ëµ∑Êù•‰ª•ÂêéÔºåÂéüÊù•Ë°®Á§∫‰ΩçÁΩÆÁöÑËµÑËÆØ‰∏çÂ∞±Ê∑∑Âà∞ <span class="arithmatex">\(a^i\)</span> ÈáåÈù¢Âéª‰∫ÜÂêóÔºü‰∏çÂ∞±ÂæàÈöæË¢´ÊâæÂà∞‰∫ÜÂêóÔºü</strong></p>
<p><strong>ËøôÈáåÊèê‰æõ‰∏ÄÁßçËß£Á≠îËøô‰∏™ÈóÆÈ¢òÁöÑÊÄùË∑ØÔºö</strong></p>
<p>Â¶ÇÂõæ 15 ÊâÄÁ§∫ÔºåÊàë‰ª¨ÂÖàÁªôÊØè‰∏Ä‰∏™‰ΩçÁΩÆÁöÑ <span class="arithmatex">\(x^i\in R(d,1)\)</span> append ‰∏Ä‰∏™ one-hot ÁºñÁ†ÅÁöÑÂêëÈáè <span class="arithmatex">\(p^i\in R(N,1)\)</span> ÔºåÂæóÂà∞‰∏Ä‰∏™Êñ∞ÁöÑËæìÂÖ•ÂêëÈáè <span class="arithmatex">\(x_p^i\in R(d+N,1)\)</span> ÔºåËøô‰∏™ÂêëÈáè‰Ωú‰∏∫Êñ∞ÁöÑËæìÂÖ•Ôºå‰πò‰ª•‰∏Ä‰∏™ transformation matrix <span class="arithmatex">\(W=[W^I,W^P]\in R(d,d+N)\)</span> „ÄÇÈÇ£‰πàÔºö</p>
<div class="arithmatex">\[W\cdot x_p^i=[W^I,W^P]\cdot\begin{bmatrix}x^i\\p^i \end{bmatrix}=W^I\cdot x^i+W^P\cdot p^i=a^i+e^i \tag{4}\]</div>
<p><strong>ÊâÄ‰ª•Ôºå<span class="arithmatex">\(e^i\)</span> ‰∏é <span class="arithmatex">\(a^i\)</span> Áõ∏Âä†Â∞±Á≠âÂêå‰∫éÊääÂéüÊù•ÁöÑËæìÂÖ• <span class="arithmatex">\(x^i\)</span> concat ‰∏Ä‰∏™Ë°®Á§∫‰ΩçÁΩÆÁöÑÁã¨ÁÉ≠ÁºñÁ†Å <span class="arithmatex">\(p^i\)</span> ÔºåÂÜçÂÅö transformation„ÄÇ</strong></p>
<p><strong>Ëøô‰∏™‰∏é‰ΩçÁΩÆÁºñÁ†Å‰πòËµ∑Êù•ÁöÑÁü©Èòµ</strong> <span class="arithmatex">\(W^P\)</span> ÊòØÊâãÂ∑•ËÆæËÆ°ÁöÑÔºåÂ¶ÇÂõæ 17 ÊâÄÁ§∫ (ÈªëËâ≤Ê°Ü‰ª£Ë°®‰∏Ä‰∏™‰ΩçÁΩÆÁöÑÁºñÁ†Å)„ÄÇ</p>
<p><img alt="" src="https://pic4.zhimg.com/v2-8b7cf3525520292bdfa159463d9717db_r.jpg" /></p>
<p>Transformer ‰∏≠Èô§‰∫ÜÂçïËØçÁöÑ EmbeddingÔºåËøòÈúÄË¶Å‰ΩøÁî®‰ΩçÁΩÆ Embedding Ë°®Á§∫ÂçïËØçÂá∫Áé∞Âú®Âè•Â≠ê‰∏≠ÁöÑ‰ΩçÁΩÆ„ÄÇÂõ†‰∏∫ Transformer ‰∏çÈááÁî® RNN ÁöÑÁªìÊûÑÔºåËÄåÊòØ‰ΩøÁî®ÂÖ®Â±Ä‰ø°ÊÅØÔºå‰∏çËÉΩÂà©Áî®ÂçïËØçÁöÑÈ°∫Â∫è‰ø°ÊÅØÔºåËÄåËøôÈÉ®ÂàÜ‰ø°ÊÅØÂØπ‰∫é NLP Êù•ËØ¥ÈùûÂ∏∏ÈáçË¶Å„ÄÇÊâÄ‰ª• Transformer ‰∏≠‰ΩøÁî®‰ΩçÁΩÆ Embedding ‰øùÂ≠òÂçïËØçÂú®Â∫èÂàó‰∏≠ÁöÑÁõ∏ÂØπÊàñÁªùÂØπ‰ΩçÁΩÆ„ÄÇ</p>
<p>‰ΩçÁΩÆ Embedding Áî® PE Ë°®Á§∫ÔºåPE ÁöÑÁª¥Â∫¶‰∏éÂçïËØç Embedding ÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇPE ÂèØ‰ª•ÈÄöËøáËÆ≠ÁªÉÂæóÂà∞Ôºå‰πüÂèØ‰ª•‰ΩøÁî®ÊüêÁßçÂÖ¨ÂºèËÆ°ÁÆóÂæóÂà∞„ÄÇÂú® Transformer ‰∏≠ÈááÁî®‰∫ÜÂêéËÄÖÔºåËÆ°ÁÆóÂÖ¨ÂºèÂ¶Ç‰∏ãÔºö</p>
<div class="arithmatex">\[\begin{align}PE_{(pos, 2i)} = sin(pos/10000^{2i/d_{model}}) \\ PE_{(pos, 2i+1)} = cos(pos/10000^{2i/d_{model}}) \end{align}\tag{5}\]</div>
<p>Âºè‰∏≠Ôºå <span class="arithmatex">\(pos\)</span> Ë°®Á§∫ token Âú® sequence ‰∏≠ÁöÑ‰ΩçÁΩÆÔºå‰æãÂ¶ÇÁ¨¨‰∏Ä‰∏™ token "Êàë" ÁöÑ <span class="arithmatex">\(pos=0\)</span> „ÄÇ</p>
<p><span class="arithmatex">\(i\)</span> ÔºåÊàñËÄÖÂáÜÁ°ÆÊÑè‰πâ‰∏äÊòØ <span class="arithmatex">\(2i\)</span> Âíå <span class="arithmatex">\(2i+1\)</span> Ë°®Á§∫‰∫Ü Positional Encoding ÁöÑÁª¥Â∫¶Ôºå<span class="arithmatex">\(i\)</span> ÁöÑÂèñÂÄºËåÉÂõ¥ÊòØÔºö <span class="arithmatex">\(\left[ 0,\ldots ,{{{d}_{model}}}/{2}\; \right)\)</span> „ÄÇÊâÄ‰ª•ÂΩì <span class="arithmatex">\(pos\)</span> ‰∏∫ 1 Êó∂ÔºåÂØπÂ∫îÁöÑ Positional Encoding ÂèØ‰ª•ÂÜôÊàêÔºö</p>
<p><span class="arithmatex">\(PE\left( 1 \right)=\left[ \sin \left( {1}/{{{10000}^{{0}/{512}\;}}}\; \right),\cos \left( {1}/{{{10000}^{{0}/{512}\;}}}\; \right),\sin \left( {1}/{{{10000}^{{2}/{512}\;}}}\; \right),\cos \left( {1}/{{{10000}^{{2}/{512}\;}}}\; \right),\ldots \right]\)</span></p>
<p>Âºè‰∏≠Ôºå <span class="arithmatex">\({{d}_{model}}=512\)</span>„ÄÇÂ∫ïÊï∞ÊòØ 10000„ÄÇ‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî® 10000 Âë¢ÔºåËøô‰∏™Â∞±Á±ª‰ºº‰∫éÁéÑÂ≠¶‰∫ÜÔºåÂéüËÆ∫Êñá‰∏≠ÂÆåÂÖ®Ê≤°ÊúâÊèêÂïäÔºåËøôÈáå‰∏çÂæó‰∏çËØ¥ËØ¥ËÆ∫ÊñáÁöÑ readability ÁöÑÈóÆÈ¢òÔºåÂç≥‰æøÊòØÂæàÂ§öÈ´òÂºïÁöÑÊñáÁ´†ÔºåÊúÄÂü∫Êú¨ÁöÑÂÜÖÂÆπÈÉΩËÆ®ËÆ∫‰∏çÊ∏ÖÊ•öÔºåÊâÄ‰ª•ÊâçÂá∫Áé∞ÂÉè‰∏äÈù¢ÊèêÈóÆÈáåÁöÑËÆ®ËÆ∫ÔºåËØ¥ÂÆûËØùËøô‰∫õËÆ∫ÊñáËøòËøúËøúÊ≤°ÊúâÂÅöÂà∞ easy to follow„ÄÇËøôÈáåÊàëÁªôÂá∫‰∏Ä‰∏™ÂÅáÊÉ≥Ôºö<span class="arithmatex">\({{10000}^{{1}/{512}}}\)</span> ÊòØ‰∏Ä‰∏™ÊØîËæÉÊé•Ëøë 1 ÁöÑÊï∞Ôºà1.018ÔºâÔºåÂ¶ÇÊûúÁî® 100000ÔºåÂàôÊòØ 1.023„ÄÇËøôÈáåÂè™ÊòØÁåúÊÉ≥‰∏Ä‰∏ãÔºåÂÖ∂ÂÆûÂ§ßÂÆ∂Â∫îËØ•ÂÆåÂÖ®ÂèØ‰ª•‰ΩøÁî®Âè¶‰∏Ä‰∏™Â∫ïÊï∞„ÄÇ</p>
<p>Ëøô‰∏™ÂºèÂ≠êÁöÑÂ•ΩÂ§ÑÊòØÔºö</p>
<ul>
<li>ÊØè‰∏™‰ΩçÁΩÆÊúâ‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑ positional encoding„ÄÇ</li>
<li>‰Ωø <span class="arithmatex">\(PE\)</span> ËÉΩÂ§üÈÄÇÂ∫îÊØîËÆ≠ÁªÉÈõÜÈáåÈù¢ÊâÄÊúâÂè•Â≠êÊõ¥ÈïøÁöÑÂè•Â≠êÔºåÂÅáËÆæËÆ≠ÁªÉÈõÜÈáåÈù¢ÊúÄÈïøÁöÑÂè•Â≠êÊòØÊúâ 20 ‰∏™ÂçïËØçÔºåÁ™ÅÁÑ∂Êù•‰∫Ü‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ 21 ÁöÑÂè•Â≠êÔºåÂàô‰ΩøÁî®ÂÖ¨ÂºèËÆ°ÁÆóÁöÑÊñπÊ≥ïÂèØ‰ª•ËÆ°ÁÆóÂá∫Á¨¨ 21 ‰ΩçÁöÑ Embedding„ÄÇ</li>
<li>ÂèØ‰ª•ËÆ©Ê®°ÂûãÂÆπÊòìÂú∞ËÆ°ÁÆóÂá∫Áõ∏ÂØπ‰ΩçÁΩÆÔºåÂØπ‰∫éÂõ∫ÂÆöÈïøÂ∫¶ÁöÑÈó¥Ë∑ù <span class="arithmatex">\(k\)</span> Ôºå‰ªªÊÑè‰ΩçÁΩÆÁöÑ <span class="arithmatex">\(PE_{pos+k}\)</span> ÈÉΩÂèØ‰ª•Ë¢´ <span class="arithmatex">\(PE_{pos}\)</span> ÁöÑÁ∫øÊÄßÂáΩÊï∞Ë°®Á§∫ÔºåÂõ†‰∏∫‰∏âËßíÂáΩÊï∞ÁâπÊÄßÔºö</li>
</ul>
<div class="arithmatex">\[cos(\alpha+\beta) = cos(\alpha)cos(\beta)-sin(\alpha)sin(\beta) \\
\]</div>
<div class="arithmatex">\[sin(\alpha+\beta) = sin(\alpha)cos(\beta) + cos(\alpha)sins(\beta) \\
\]</div>
<p>Èô§‰∫Ü‰ª•‰∏äÁöÑÂõ∫ÂÆö‰ΩçÁΩÆÁºñÁ†Å‰ª•Â§ñÔºåËøòÊúâÂÖ∂‰ªñÁöÑÂæàÂ§öË°®Á§∫ÊñπÊ≥ïÔºö</p>
<p>ÊØîÂ¶Ç‰∏ãÂõæ 18a Â∞±ÊòØ sin-cos ÁöÑÂõ∫ÂÆö‰ΩçÁΩÆÁºñÁ†Å„ÄÇÂõæ b Â∞±ÊòØÂèØÂ≠¶‰π†ÁöÑ‰ΩçÁΩÆÁºñÁ†Å„ÄÇÂõæ c Âíå d ÂàÜÂà´ FLOATER Âíå RNN Ê®°ÂûãÂ≠¶‰π†ÁöÑ‰ΩçÁΩÆÁºñÁ†Å„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-4ef2648c2bebe2621c0c03001c0e1b92_r.jpg" /></p>
<p>Êé•‰∏ãÊù•Êàë‰ª¨ÁúãÁúã self-attention Âú® sequence2sequence model ÈáåÈù¢ÊòØÊÄé‰πà‰ΩøÁî®ÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•Êää Encoder-Decoder ‰∏≠ÁöÑ RNN Áî® self-attention Âèñ‰ª£Êéâ„ÄÇ</p>
<p><img alt="" src="https://pic4.zhimg.com/v2-287ebca58558012f9459f3f1d5bc3827_r.jpg" /></p>
<p>Âú® self-attention ÁöÑÊúÄÂêé‰∏ÄÈÉ®ÂàÜÊàë‰ª¨Êù•ÂØπÊØî‰∏ã self-attention Âíå CNN ÁöÑÂÖ≥Á≥ª„ÄÇÂ¶ÇÂõæ 19Ôºå‰ªäÂ§©Âú®‰ΩøÁî® self-attention ÂéªÂ§ÑÁêÜ‰∏ÄÂº†ÂõæÁâáÁöÑÊó∂ÂÄôÔºå1 ÁöÑÈÇ£‰∏™ pixel ‰∫ßÁîü queryÔºåÂÖ∂‰ªñÁöÑÂêÑ‰∏™ pixel ‰∫ßÁîü key„ÄÇÂú®ÂÅö inner-product ÁöÑÊó∂ÂÄôÔºåËÄÉËôëÁöÑ‰∏çÊòØ‰∏Ä‰∏™Â∞èÁöÑËåÉÂõ¥ÔºåËÄåÊòØ‰∏ÄÊï¥Âº†ÂõæÁâá„ÄÇ</p>
<p>‰ΩÜÊòØÂú®ÂÅö CNN ÁöÑÊó∂ÂÄôÊòØÂè™ËÄÉËôëÊÑüÂèóÈáéÁ∫¢Ê°ÜÈáåÈù¢ÁöÑËµÑËÆØÔºåËÄå‰∏çÊòØÂõæÁâáÁöÑÂÖ®Â±Ä‰ø°ÊÅØ„ÄÇÊâÄ‰ª• CNN ÂèØ‰ª•Áúã‰ΩúÊòØ‰∏ÄÁßçÁÆÄÂåñÁâàÊú¨ÁöÑ self-attention„ÄÇ</p>
<p>ÊàñËÄÖÂèØ‰ª•ÂèçËøáÊù•ËØ¥Ôºåself-attention ÊòØ‰∏ÄÁßçÂ§çÊùÇÂåñÁöÑ CNNÔºåÂú®ÂÅö CNN ÁöÑÊó∂ÂÄôÊòØÂè™ËÄÉËôëÊÑüÂèóÈáéÁ∫¢Ê°ÜÈáåÈù¢ÁöÑËµÑËÆØÔºåËÄåÊÑüÂèóÈáéÁöÑËåÉÂõ¥ÂíåÂ§ßÂ∞èÊòØÁî±‰∫∫ÂÜ≥ÂÆöÁöÑ„ÄÇ‰ΩÜÊòØ self-attention Áî± attention ÊâæÂà∞Áõ∏ÂÖ≥ÁöÑ pixelÔºåÂ∞±Â•ΩÂÉèÊòØÊÑüÂèóÈáéÁöÑËåÉÂõ¥ÂíåÂ§ßÂ∞èÊòØËá™Âä®Ë¢´Â≠¶Âá∫Êù•ÁöÑÔºåÊâÄ‰ª• CNN ÂèØ‰ª•ÁúãÂÅöÊòØ self-attention ÁöÑÁâπ‰æãÔºåÂ¶ÇÂõæ 20 ÊâÄÁ§∫„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-f28a8b0295863ab78d92a281ae55fce2_r.jpg" /></p>
<p><img alt="" src="https://pic4.zhimg.com/v2-f268035371aa22a350a317fc237a04f7_r.jpg" /></p>
<p>Êó¢ÁÑ∂ self-attention ÊòØÊõ¥Âπø‰πâÁöÑ CNNÔºåÂàôËøô‰∏™Ê®°ÂûãÊõ¥Âä† flexible„ÄÇËÄåÊàë‰ª¨ËÆ§‰∏∫Ôºå‰∏Ä‰∏™Ê®°ÂûãË∂ä flexibleÔºåËÆ≠ÁªÉÂÆÉÊâÄÈúÄË¶ÅÁöÑÊï∞ÊçÆÈáèÂ∞±Ë∂äÂ§öÔºåÊâÄ‰ª•Âú®ËÆ≠ÁªÉ self-attention Ê®°ÂûãÊó∂Â∞±ÈúÄË¶ÅÊõ¥Â§öÁöÑÊï∞ÊçÆÔºåËøô‰∏ÄÁÇπÂú®‰∏ãÈù¢‰ªãÁªçÁöÑËÆ∫Êñá ViT ‰∏≠ÊúâÂç∞ËØÅÔºåÂÆÉÈúÄË¶ÅÁöÑÊï∞ÊçÆÈõÜÊòØÊúâ 3 ‰∫øÂº†ÂõæÁâáÁöÑ JFT-300ÔºåËÄåÂ¶ÇÊûú‰∏ç‰ΩøÁî®Ëøô‰πàÂ§öÊï∞ÊçÆËÄåÂè™‰ΩøÁî® ImageNetÔºåÂàôÊÄßËÉΩ‰∏çÂ¶Ç CNN„ÄÇ</p>
<h2 id="2-transformer">2 Transformer ÁöÑÂÆûÁé∞Âíå‰ª£Á†ÅËß£ËØª<a class="headerlink" href="#2-transformer" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>2.1 Transformer ÂéüÁêÜÂàÜÊûêÔºö</strong></li>
</ul>
<p><img alt="" src="https://pic4.zhimg.com/v2-1719966a223d98ad48f98c2e4d71add7_r.jpg" /></p>
<p><strong>EncoderÔºö</strong></p>
<p>Ëøô‰∏™Âõæ 21 ËÆ≤ÁöÑÊòØ‰∏Ä‰∏™ seq2seq ÁöÑ modelÔºåÂ∑¶‰æß‰∏∫ Encoder blockÔºåÂè≥‰æß‰∏∫ Decoder block„ÄÇÁ∫¢Ëâ≤Âúà‰∏≠ÁöÑÈÉ®ÂàÜ‰∏∫ Multi-Head AttentionÔºåÊòØÁî±Â§ö‰∏™ Self-Attention ÁªÑÊàêÁöÑÔºåÂèØ‰ª•ÁúãÂà∞ Encoder block ÂåÖÂê´‰∏Ä‰∏™ Multi-Head AttentionÔºåËÄå Decoder block ÂåÖÂê´‰∏§‰∏™ Multi-Head Attention (ÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™Áî®Âà∞ Masked)„ÄÇMulti-Head Attention ‰∏äÊñπËøòÂåÖÊã¨‰∏Ä‰∏™ Add &amp; Norm Â±ÇÔºåAdd Ë°®Á§∫ÊÆãÂ∑ÆËøûÊé• (Residual Connection) Áî®‰∫éÈò≤Ê≠¢ÁΩëÁªúÈÄÄÂåñÔºåNorm Ë°®Á§∫ Layer NormalizationÔºåÁî®‰∫éÂØπÊØè‰∏ÄÂ±ÇÁöÑÊøÄÊ¥ªÂÄºËøõË°åÂΩí‰∏ÄÂåñ„ÄÇÊØîÂ¶ÇËØ¥Âú® Encoder Input Â§ÑÁöÑËæìÂÖ•ÊòØÊú∫Âô®Â≠¶‰π†ÔºåÂú® Decoder Input Â§ÑÁöÑËæìÂÖ•ÊòØ &lt; BOS&gt;ÔºåËæìÂá∫ÊòØ machine„ÄÇÂÜç‰∏ã‰∏Ä‰∏™Êó∂ÂàªÂú® Decoder Input Â§ÑÁöÑËæìÂÖ•ÊòØ machineÔºåËæìÂá∫ÊòØ learning„ÄÇ‰∏çÊñ≠ÈáçÂ§çÁü•ÈÅìËæìÂá∫ÊòØÂè•ÁÇπ (.) ‰ª£Ë°®ÁøªËØëÁªìÊùü„ÄÇ</p>
<p>Êé•‰∏ãÊù•Êàë‰ª¨ÁúãÁúãËøô‰∏™ Encoder Âíå Decoder ÈáåÈù¢ÂàÜÂà´ÈÉΩÂÅö‰∫Ü‰ªÄ‰πà‰∫ãÊÉÖÔºåÂÖàÁúãÂ∑¶ÂçäÈÉ®ÂàÜÁöÑ EncoderÔºöÈ¶ñÂÖàËæìÂÖ• <span class="arithmatex">\(X\in R (n_x,N)\)</span> ÈÄöËøá‰∏Ä‰∏™ Input Embedding ÁöÑËΩ¨ÁßªÁü©Èòµ <span class="arithmatex">\(W^X\in R (d,n_x)\)</span> Âèò‰∏∫‰∫Ü‰∏Ä‰∏™Âº†ÈáèÔºåÂç≥‰∏äÊñáÊâÄËø∞ÁöÑ <span class="arithmatex">\(I\in R (d,N)\)</span> ÔºåÂÜçÂä†‰∏ä‰∏Ä‰∏™Ë°®Á§∫‰ΩçÁΩÆÁöÑ Positional Encoding <span class="arithmatex">\(E\in R (d,N)\)</span> ÔºåÂæóÂà∞‰∏Ä‰∏™Âº†ÈáèÔºåÂéªÂæÄÂêéÈù¢ÁöÑÊìç‰Ωú„ÄÇ</p>
<p>ÂÆÉËøõÂÖ•‰∫ÜËøô‰∏™ÁªøËâ≤ÁöÑ blockÔºåËøô‰∏™ÁªøËâ≤ÁöÑ block ‰ºöÈáçÂ§ç <span class="arithmatex">\(N\)</span> Ê¨°„ÄÇËøô‰∏™ÁªøËâ≤ÁöÑ block ÈáåÈù¢Êúâ‰ªÄ‰πàÂë¢ÔºüÂÆÉÁöÑÁ¨¨ 1 Â±ÇÊòØ‰∏Ä‰∏™‰∏äÊñáËÆ≤ÁöÑ multi-head ÁöÑ attention„ÄÇ‰Ω†Áé∞Âú®‰∏Ä‰∏™ sequence <span class="arithmatex">\(I\in R (d,N)\)</span> ÔºåÁªèËøá‰∏Ä‰∏™ multi-head ÁöÑ attentionÔºå‰Ω†‰ºöÂæóÂà∞Âè¶Â§ñ‰∏Ä‰∏™ sequence <span class="arithmatex">\(O\in R (d,N)\)</span> „ÄÇ</p>
<p>‰∏ã‰∏Ä‰∏™ Layer ÊòØ Add &amp; NormÔºåËøô‰∏™ÊÑèÊÄùÊòØËØ¥ÔºöÊää multi-head ÁöÑ attention ÁöÑ layer ÁöÑËæìÂÖ• <span class="arithmatex">\(I\in R (d,N)\)</span> ÂíåËæìÂá∫ <span class="arithmatex">\(O\in R (d,N)\)</span> ËøõË°åÁõ∏Âä†‰ª•ÂêéÔºåÂÜçÂÅö Layer NormalizationÔºåËá≥‰∫é Layer Normalization ÂíåÊàë‰ª¨ÁÜüÊÇâÁöÑ Batch Normalization ÁöÑÂå∫Âà´ÊòØ‰ªÄ‰πàÔºåËØ∑ÂèÇËÄÉÂõæ 20 Âíå 21„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-53267aa305030eb71376296a6fd14cde_r.jpg" /></p>
<p>ÂÖ∂‰∏≠ÔºåBatch Normalization Âíå Layer Normalization ÁöÑÂØπÊØîÂèØ‰ª•Ê¶ÇÊã¨‰∏∫Âõæ 22ÔºåBatch Normalization Âº∫Ë°åËÆ©‰∏Ä‰∏™ batch ÁöÑÊï∞ÊçÆÁöÑÊüê‰∏™ channel ÁöÑ <span class="arithmatex">\(\mu=0,\sigma=1\)</span> ÔºåËÄå Layer Normalization ËÆ©‰∏Ä‰∏™Êï∞ÊçÆÁöÑÊâÄÊúâ channel ÁöÑ <span class="arithmatex">\(\mu=0,\sigma=1\)</span> „ÄÇ</p>
<p><img alt="" src="https://pic1.zhimg.com/v2-4c13b36ec9a6a2d2f4911d2d9e7122b8_r.jpg" /></p>
<p>Êé•ÁùÄÊòØ‰∏Ä‰∏™ Feed Forward ÁöÑÂâçÈ¶àÁΩëÁªúÂíå‰∏Ä‰∏™ Add &amp; Norm Layer„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåËøô‰∏Ä‰∏™ÁªøËâ≤ÁöÑ block ÁöÑÂâç 2 ‰∏™ Layer Êìç‰ΩúÁöÑË°®ËææÂºè‰∏∫Ôºö</p>
<div class="arithmatex">\[\color{darkgreen}{O_1}=\color{green}{\text{Layer Normalization}}(\color{teal}{I}+\color{crimson}{\text{Multi-head Self-Attention}}(\color{teal}{I}))\tag{6}\]</div>
<p>Ëøô‰∏Ä‰∏™ÁªøËâ≤ÁöÑ block ÁöÑÂêé 2 ‰∏™ Layer Êìç‰ΩúÁöÑË°®ËææÂºè‰∏∫Ôºö</p>
<div class="arithmatex">\[\color{darkgreen}{O_2}=\color{green}{\text{Layer Normalization}}(\color{teal}{O_1}+\color{crimson}{\text{Feed Forward Network}}(\color{teal}{O_1}))\tag{7}\]</div>
<div class="arithmatex">\[\color{green}{\text{Block}}(\color{teal}{I})=\color{green}{O_2} \tag{8}\]</div>
<p>ÊâÄ‰ª• Transformer ÁöÑ Encoder ÁöÑÊï¥‰ΩìÊìç‰Ωú‰∏∫Ôºö</p>
<p><span class="arithmatex">\(\color{purple}{\text{Encoder}}(\color{darkgreen}{I})=\color{darkgreen}{\text{Block}}(...\color{darkgreen}{\text{Block}}(\color{darkgreen}{\text{Block}})(\color{teal}{I}))\\\quad N\;times \tag{9}\)</span></p>
<p><strong>DecoderÔºö</strong></p>
<p>Áé∞Âú®Êù•Áúã Decoder ÁöÑÈÉ®ÂàÜÔºåËæìÂÖ•ÂåÖÊã¨ 2 ÈÉ®ÂàÜÔºå‰∏ãÊñπÊòØÂâç‰∏Ä‰∏™ time step ÁöÑËæìÂá∫ÁöÑ embeddingÔºåÂç≥‰∏äÊñáÊâÄËø∞ÁöÑ <span class="arithmatex">\(I\in R (d,N)\)</span> ÔºåÂÜçÂä†‰∏ä‰∏Ä‰∏™Ë°®Á§∫‰ΩçÁΩÆÁöÑ Positional Encoding <span class="arithmatex">\(E\in R (d,N)\)</span> ÔºåÂæóÂà∞‰∏Ä‰∏™Âº†ÈáèÔºåÂéªÂæÄÂêéÈù¢ÁöÑÊìç‰Ωú„ÄÇÂÆÉËøõÂÖ•‰∫ÜËøô‰∏™ÁªøËâ≤ÁöÑ blockÔºåËøô‰∏™ÁªøËâ≤ÁöÑ block ‰ºöÈáçÂ§ç <span class="arithmatex">\(N\)</span> Ê¨°„ÄÇËøô‰∏™ÁªøËâ≤ÁöÑ block ÈáåÈù¢Êúâ‰ªÄ‰πàÂë¢Ôºü</p>
<p>È¶ñÂÖàÊòØ Masked Multi-Head Self-attentionÔºåmasked ÁöÑÊÑèÊÄùÊòØ‰Ωø attention Âè™‰ºö attend on Â∑≤Áªè‰∫ßÁîüÁöÑ sequenceÔºåËøô‰∏™ÂæàÂêàÁêÜÔºåÂõ†‰∏∫ËøòÊ≤°Êúâ‰∫ßÁîüÂá∫Êù•ÁöÑ‰∏úË•ø‰∏çÂ≠òÂú®ÔºåÂ∞±Êó†Ê≥ïÂÅö attention„ÄÇ</p>
<p><strong>ËæìÂá∫ÊòØÔºö</strong> ÂØπÂ∫î <span class="arithmatex">\(\color{crimson}{i}\)</span> ‰ΩçÁΩÆÁöÑËæìÂá∫ËØçÁöÑÊ¶ÇÁéáÂàÜÂ∏É„ÄÇ</p>
<p><strong>ËæìÂÖ•ÊòØÔºö</strong> <span class="arithmatex">\(\color{purple}{Encoder}\)</span> <strong>ÁöÑËæìÂá∫</strong> Âíå <strong>ÂØπÂ∫î</strong> <span class="arithmatex">\(\color{crimson}{i-1}\)</span> <strong>‰ΩçÁΩÆ decoder ÁöÑËæìÂá∫</strong>„ÄÇÊâÄ‰ª•‰∏≠Èó¥ÁöÑ attention ‰∏çÊòØ self-attentionÔºåÂÆÉÁöÑ Key Âíå Value Êù•Ëá™ encoderÔºåQuery Êù•Ëá™‰∏ä‰∏Ä‰ΩçÁΩÆ <span class="arithmatex">\(\color{crimson}{Decoder}\)</span> ÁöÑËæìÂá∫„ÄÇ</p>
<p><strong>Ëß£Á†ÅÔºöËøôÈáåË¶ÅÁâπÂà´Ê≥®ÊÑè‰∏Ä‰∏ãÔºåÁºñÁ†ÅÂèØ‰ª•Âπ∂Ë°åËÆ°ÁÆóÔºå‰∏ÄÊ¨°ÊÄßÂÖ®ÈÉ® Encoding Âá∫Êù•Ôºå‰ΩÜËß£Á†Å‰∏çÊòØ‰∏ÄÊ¨°ÊääÊâÄÊúâÂ∫èÂàóËß£Âá∫Êù•ÁöÑÔºåËÄåÊòØÂÉè</strong> <span class="arithmatex">\(RNN\)</span> <strong>‰∏ÄÊ†∑‰∏Ä‰∏™‰∏Ä‰∏™Ëß£Âá∫Êù•ÁöÑ</strong>ÔºåÂõ†‰∏∫Ë¶ÅÁî®‰∏ä‰∏Ä‰∏™‰ΩçÁΩÆÁöÑËæìÂÖ•ÂΩì‰Ωú attention ÁöÑ query„ÄÇ</p>
<p>ÊòéÁ°Æ‰∫ÜËß£Á†ÅËøáÁ®ã‰πãÂêéÊúÄ‰∏äÈù¢ÁöÑÂõæÂ∞±ÂæàÂ•ΩÊáÇ‰∫ÜÔºåËøôÈáå‰∏ªË¶ÅÁöÑ‰∏çÂêåÂ∞±ÊòØÊñ∞Âä†ÁöÑÂè¶Â§ñË¶ÅËØ¥‰∏Ä‰∏ãÊñ∞Âä†ÁöÑ attention Â§öÂä†‰∫Ü‰∏Ä‰∏™ maskÔºåÂõ†‰∏∫ËÆ≠ÁªÉÊó∂ÁöÑ output ÈÉΩÊòØ Ground TruthÔºåËøôÊ†∑ÂèØ‰ª•Á°Æ‰øùÈ¢ÑÊµãÁ¨¨ <span class="arithmatex">\(\color{crimson}{i}\)</span> ‰∏™‰ΩçÁΩÆÊó∂‰∏ç‰ºöÊé•Ëß¶Âà∞Êú™Êù•ÁöÑ‰ø°ÊÅØ„ÄÇ</p>
<ul>
<li>ÂåÖÂê´‰∏§‰∏™ Multi-Head Attention Â±Ç„ÄÇ</li>
<li>Á¨¨‰∏Ä‰∏™ Multi-Head Attention Â±ÇÈááÁî®‰∫Ü Masked Êìç‰Ωú„ÄÇ</li>
<li>Á¨¨‰∫å‰∏™ Multi-Head Attention Â±ÇÁöÑ KeyÔºåValue Áü©Èòµ‰ΩøÁî® Encoder ÁöÑÁºñÁ†Å‰ø°ÊÅØÁü©Èòµ <span class="arithmatex">\(C\)</span> ËøõË°åËÆ°ÁÆóÔºåËÄå Query ‰ΩøÁî®‰∏ä‰∏Ä‰∏™ Decoder block ÁöÑËæìÂá∫ËÆ°ÁÆó„ÄÇ</li>
<li>ÊúÄÂêéÊúâ‰∏Ä‰∏™ Softmax Â±ÇËÆ°ÁÆó‰∏ã‰∏Ä‰∏™ÁøªËØëÂçïËØçÁöÑÊ¶ÇÁéá„ÄÇ</li>
</ul>
<p>‰∏ãÈù¢ËØ¶ÁªÜ‰ªãÁªç‰∏ã Masked Multi-Head Self-attention ÁöÑÂÖ∑‰ΩìÊìç‰ΩúÔºå<strong>Masked Âú® Scale Êìç‰Ωú‰πãÂêéÔºåsoftmax Êìç‰Ωú‰πãÂâç</strong>„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-58ac6e864d336abce052cf36d480cfee_b.jpg" /></p>
<p>Âõ†‰∏∫Âú®ÁøªËØëÁöÑËøáÁ®ã‰∏≠ÊòØÈ°∫Â∫èÁøªËØëÁöÑÔºåÂç≥ÁøªËØëÂÆåÁ¨¨ <span class="arithmatex">\(i\)</span> ‰∏™ÂçïËØçÔºåÊâçÂèØ‰ª•ÁøªËØëÁ¨¨ <span class="arithmatex">\(i+1\)</span> ‰∏™ÂçïËØç„ÄÇÈÄöËøá Masked Êìç‰ΩúÂèØ‰ª•Èò≤Ê≠¢Á¨¨ <span class="arithmatex">\(i\)</span> ‰∏™ÂçïËØçÁü•ÈÅìÁ¨¨ <span class="arithmatex">\(i+1\)</span> ‰∏™ÂçïËØç‰πãÂêéÁöÑ‰ø°ÊÅØ„ÄÇ‰∏ãÈù¢‰ª• "ÊàëÊúâ‰∏ÄÂè™Áå´" ÁøªËØëÊàê "I have a cat" ‰∏∫‰æãÔºå‰∫ÜËß£‰∏Ä‰∏ã Masked Êìç‰Ωú„ÄÇÂú® Decoder ÁöÑÊó∂ÂÄôÔºåÊòØÈúÄË¶ÅÊ†πÊçÆ‰πãÂâçÁöÑÁøªËØëÔºåÊ±ÇËß£ÂΩìÂâçÊúÄÊúâÂèØËÉΩÁöÑÁøªËØëÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇÈ¶ñÂÖàÊ†πÊçÆËæìÂÖ• "<Begin>" È¢ÑÊµãÂá∫Á¨¨‰∏Ä‰∏™ÂçïËØç‰∏∫ "I"ÔºåÁÑ∂ÂêéÊ†πÊçÆËæìÂÖ• "<Begin> I" È¢ÑÊµã‰∏ã‰∏Ä‰∏™ÂçïËØç "have"„ÄÇ</p>
<p>Decoder ÂèØ‰ª•Âú®ËÆ≠ÁªÉÁöÑËøáÁ®ã‰∏≠‰ΩøÁî® Teacher Forcing <strong>Âπ∂‰∏îÂπ∂Ë°åÂåñËÆ≠ÁªÉÔºåÂç≥Â∞ÜÊ≠£Á°ÆÁöÑÂçïËØçÂ∫èÂàó (<Begin> I have a cat) ÂíåÂØπÂ∫îËæìÂá∫ (I have a cat <end>) ‰º†ÈÄíÂà∞ Decoder„ÄÇÈÇ£‰πàÂú®È¢ÑÊµãÁ¨¨</strong> <span class="arithmatex">\(i\)</span> <strong>‰∏™ËæìÂá∫Êó∂ÔºåÂ∞±Ë¶ÅÂ∞ÜÁ¨¨</strong> <span class="arithmatex">\(i+1\)</span> <strong>‰πãÂêéÁöÑÂçïËØçÊé©Áõñ‰ΩèÔºå</strong>Ê≥®ÊÑè Mask Êìç‰ΩúÊòØÂú® Self-Attention ÁöÑ Softmax ‰πãÂâç‰ΩøÁî®ÁöÑÔºå‰∏ãÈù¢Áî® 0 1 2 3 4 5 ÂàÜÂà´Ë°®Á§∫ "<Begin> I have a cat <end>"„ÄÇ</p>
<p><img alt="" src="https://pic1.zhimg.com/v2-20d6a9f4b3cc8cbae05778816d1af414_r.jpg" /></p>
<p>Ê≥®ÊÑèËøôÈáå transformer Ê®°ÂûãËÆ≠ÁªÉÂíåÊµãËØïÁöÑÊñπÊ≥ï‰∏çÂêåÔºö</p>
<p><strong>ÊµãËØïÊó∂Ôºö</strong></p>
<ol>
<li>ËæìÂÖ• <Begin>ÔºåËß£Á†ÅÂô®ËæìÂá∫ I „ÄÇ</li>
<li>ËæìÂÖ•ÂâçÈù¢Â∑≤ÁªèËß£Á†ÅÁöÑ <Begin> Âíå IÔºåËß£Á†ÅÂô®ËæìÂá∫ have„ÄÇ</li>
<li>ËæìÂÖ•Â∑≤ÁªèËß£Á†ÅÁöÑ <Begin>ÔºåI, have, a, catÔºåËß£Á†ÅÂô®ËæìÂá∫Ëß£Á†ÅÁªìÊùüÊ†áÂøó‰Ωç &lt; end&gt;ÔºåÊØèÊ¨°Ëß£Á†ÅÈÉΩ‰ºöÂà©Áî®ÂâçÈù¢Â∑≤ÁªèËß£Á†ÅËæìÂá∫ÁöÑÊâÄÊúâÂçïËØçÂµåÂÖ•‰ø°ÊÅØ„ÄÇ</li>
</ol>
<p><strong>Transformer ÊµãËØïÊó∂ÁöÑËß£Á†ÅËøáÁ®ãÔºö</strong></p>
<p><strong>ËÆ≠ÁªÉÊó∂Ôºö</strong></p>
<p><strong>‰∏çÈááÁî®‰∏äËø∞Á±ª‰ºº RNN ÁöÑÊñπÊ≥ï</strong>‰∏Ä‰∏™‰∏Ä‰∏™ÁõÆÊ†áÂçïËØçÂµåÂÖ•ÂêëÈáèÈ°∫Â∫èËæìÂÖ•ËÆ≠ÁªÉÔºåÊÉ≥ÈááÁî®<strong>Á±ª‰ººÁºñÁ†ÅÂô®‰∏≠ÁöÑÁü©ÈòµÂπ∂Ë°åÁÆóÊ≥ïÔºå‰∏ÄÊ≠•Â∞±ÊääÊâÄÊúâÁõÆÊ†áÂçïËØçÈ¢ÑÊµãÂá∫Êù•</strong>„ÄÇË¶ÅÂÆûÁé∞Ëøô‰∏™ÂäüËÉΩÂ∞±ÂèØ‰ª•ÂèÇËÄÉÁºñÁ†ÅÂô®ÁöÑÊìç‰ΩúÔºåÊääÁõÆÊ†áÂçïËØçÂµåÂÖ•ÂêëÈáèÁªÑÊàêÁü©Èòµ‰∏ÄÊ¨°ËæìÂÖ•Âç≥ÂèØ„ÄÇÂç≥Ôºö<strong>Âπ∂Ë°åÂåñËÆ≠ÁªÉ„ÄÇ</strong></p>
<p>‰ΩÜÊòØÂú®Ëß£Á†Å have Êó∂ÂÄôÔºå‰∏çËÉΩÂà©Áî®Âà∞ÂêéÈù¢ÂçïËØç a Âíå cat ÁöÑÁõÆÊ†áÂçïËØçÂµåÂÖ•ÂêëÈáè‰ø°ÊÅØÔºåÂê¶ÂàôËøôÂ∞±ÊòØ‰ΩúÂºä (ÊµãËØïÊó∂ÂÄô‰∏çÂèØËÉΩËÉΩÊú™ÂçúÂÖàÁü•)„ÄÇ‰∏∫Ê≠§ÂºïÂÖ• mask„ÄÇÂÖ∑‰ΩìÊòØÔºöÂú®Ëß£Á†ÅÂô®‰∏≠Ôºåself-attention Â±ÇÂè™Ë¢´ÂÖÅËÆ∏Â§ÑÁêÜËæìÂá∫Â∫èÂàó‰∏≠Êõ¥Èù†ÂâçÁöÑÈÇ£‰∫õ‰ΩçÁΩÆÔºåÂú® softmax Ê≠•È™§ÂâçÔºåÂÆÉ‰ºöÊääÂêéÈù¢ÁöÑ‰ΩçÁΩÆÁªôÈöêÂéª„ÄÇ</p>
<p><strong>Masked Multi-Head Self-attention ÁöÑÂÖ∑‰ΩìÊìç‰Ωú</strong>Â¶ÇÂõæ 26 ÊâÄÁ§∫„ÄÇ</p>
<p><strong>Step1Ôºö</strong>ËæìÂÖ•Áü©ÈòµÂåÖÂê´ "<Begin> I have a cat" (0, 1, 2, 3, 4) ‰∫î‰∏™ÂçïËØçÁöÑË°®Á§∫ÂêëÈáèÔºåMask ÊòØ‰∏Ä‰∏™ 5√ó5 ÁöÑÁü©Èòµ„ÄÇÂú® Mask ÂèØ‰ª•ÂèëÁé∞ÂçïËØç 0 Âè™ËÉΩ‰ΩøÁî®ÂçïËØç 0 ÁöÑ‰ø°ÊÅØÔºåËÄåÂçïËØç 1 ÂèØ‰ª•‰ΩøÁî®ÂçïËØç 0, 1 ÁöÑ‰ø°ÊÅØÔºåÂç≥Âè™ËÉΩ‰ΩøÁî®‰πãÂâçÁöÑ‰ø°ÊÅØ„ÄÇËæìÂÖ•Áü©Èòµ <span class="arithmatex">\(X\in R_{N,d_x}\)</span> ÁªèËøá transformation matrix Âèò‰∏∫ 3 ‰∏™Áü©ÈòµÔºöQuery <span class="arithmatex">\(Q\in R_{N,d}\)</span> ÔºåKey <span class="arithmatex">\(K\in R_{N,d}\)</span> Âíå Value <span class="arithmatex">\(V\in R_{N,d}\)</span> „ÄÇ</p>
<p><strong>Step2Ôºö</strong> <span class="arithmatex">\(Q^T\cdot K\)</span> ÂæóÂà∞ Attention Áü©Èòµ <span class="arithmatex">\(A\in R_{N,N}\)</span> ÔºåÊ≠§Êó∂ÂÖà‰∏çÊÄ•‰∫éÂÅö softmax ÁöÑÊìç‰ΩúÔºåËÄåÊòØÂÖà‰∫é‰∏Ä‰∏™ <span class="arithmatex">\(\text{Mask}\in R_{N,N}\)</span> Áü©ÈòµÁõ∏‰πòÔºå‰ΩøÂæó attention Áü©ÈòµÁöÑÊúâ‰∫õ‰ΩçÁΩÆ ÂΩí 0ÔºåÂæóÂà∞ Masked Attention Áü©Èòµ <span class="arithmatex">\(\text{Mask Attention}\in R_{N,N}\)</span> „ÄÇ <span class="arithmatex">\(\text{Mask}\in R_{N,N}\)</span> Áü©ÈòµÊòØ‰∏™‰∏ã‰∏âËßíÁü©ÈòµÔºå‰∏∫‰ªÄ‰πàËøôÊ†∑ËÆæËÆ°ÔºüÊòØÂõ†‰∏∫ÊÉ≥Âú®ËÆ°ÁÆó <span class="arithmatex">\(Z\)</span> Áü©ÈòµÁöÑÊüê‰∏ÄË°åÊó∂ÔºåÂè™ËÄÉËôëÂÆÉÂâçÈù¢ token ÁöÑ‰ΩúÁî®„ÄÇÂç≥ÔºöÂú®ËÆ°ÁÆó <span class="arithmatex">\(Z\)</span> ÁöÑÁ¨¨‰∏ÄË°åÊó∂ÔºåÂàªÊÑèÂú∞Êää <span class="arithmatex">\(\text{Attention}\)</span> Áü©ÈòµÁ¨¨‰∏ÄË°åÁöÑÂêéÈù¢Âá†‰∏™ÂÖÉÁ¥†Â±èËîΩÊéâÔºåÂè™ËÄÉËôë <span class="arithmatex">\(\text{Attention}_{0,0}\)</span> „ÄÇÂú®‰∫ßÁîü have Ëøô‰∏™ÂçïËØçÊó∂ÔºåÂè™ËÄÉËôë IÔºå‰∏çËÄÉËôë‰πãÂêéÁöÑ have a catÔºåÂç≥Âè™‰ºö attend on Â∑≤Áªè‰∫ßÁîüÁöÑ sequenceÔºåËøô‰∏™ÂæàÂêàÁêÜÔºåÂõ†‰∏∫ËøòÊ≤°Êúâ‰∫ßÁîüÂá∫Êù•ÁöÑ‰∏úË•ø‰∏çÂ≠òÂú®ÔºåÂ∞±Êó†Ê≥ïÂÅö attention„ÄÇ</p>
<p><strong>Step3Ôºö</strong>Masked Attention Áü©ÈòµËøõË°å SoftmaxÔºåÊØè‰∏ÄË°åÁöÑÂíåÈÉΩ‰∏∫ 1„ÄÇ‰ΩÜÊòØÂçïËØç 0 Âú®ÂçïËØç 1, 2, 3, 4 ‰∏äÁöÑ attention score ÈÉΩ‰∏∫ 0„ÄÇÂæóÂà∞ÁöÑÁªìÊûúÂÜç‰∏é <span class="arithmatex">\(V\)</span> Áü©ÈòµÁõ∏‰πòÂæóÂà∞ÊúÄÁªàÁöÑ self-attention Â±ÇÁöÑËæìÂá∫ÁªìÊûú <span class="arithmatex">\(Z_1\in R_{N,d}\)</span> „ÄÇ</p>
<p><strong>Step4Ôºö</strong> <span class="arithmatex">\(Z_1\in R_{N,d}\)</span> Âè™ÊòØÊüê‰∏Ä‰∏™ head ÁöÑÁªìÊûúÔºåÂ∞ÜÂ§ö‰∏™ head ÁöÑÁªìÊûú concat Âú®‰∏ÄËµ∑‰πãÂêéÂÜçÊúÄÂêéËøõË°å Linear Transformation ÂæóÂà∞ÊúÄÁªàÁöÑ Masked Multi-Head Self-attention ÁöÑËæìÂá∫ÁªìÊûú <span class="arithmatex">\(Z\in R_{N,d}\)</span> „ÄÇ</p>
<p><img alt="" src="https://pic4.zhimg.com/v2-b32b3c632a20f8daf12103dd05587fd7_r.jpg" /></p>
<p>Á¨¨ 1 ‰∏™ <strong>Masked Multi-Head Self-attention</strong> ÁöÑ <span class="arithmatex">\(\text{Query, Key, Value}\)</span> ÂùáÊù•Ëá™ Output Embedding„ÄÇ</p>
<p>Á¨¨ 2 ‰∏™ <strong>Multi-Head Self-attention</strong> ÁöÑ <span class="arithmatex">\(\text{Query}\)</span> Êù•Ëá™Á¨¨ 1 ‰∏™ Self-attention layer ÁöÑËæìÂá∫Ôºå <span class="arithmatex">\(\text{Key, Value}\)</span> Êù•Ëá™ Encoder ÁöÑËæìÂá∫„ÄÇ</p>
<p><strong>‰∏∫‰ªÄ‰πàËøô‰πàËÆæËÆ°Ôºü</strong>ËøôÈáåÊèê‰æõ‰∏ÄÁßç‰∏™‰∫∫ÁöÑÁêÜËß£Ôºö</p>
<p><span class="arithmatex">\(\text{Key, Value}\)</span> Êù•Ëá™ Transformer Encoder ÁöÑËæìÂá∫ÔºåÊâÄ‰ª•ÂèØ‰ª•ÁúãÂÅö<strong>Âè•Â≠ê (Sequence)/ ÂõæÁâá (image)</strong> ÁöÑ<strong>ÂÜÖÂÆπ‰ø°ÊÅØ (contentÔºåÊØîÂ¶ÇÂè•ÊÑèÊòØÔºö"ÊàëÊúâ‰∏ÄÂè™Áå´"ÔºåÂõæÁâáÂÜÖÂÆπÊòØÔºö"ÊúâÂá†ËæÜËΩ¶ÔºåÂá†‰∏™‰∫∫Á≠âÁ≠â")</strong>„ÄÇ</p>
<p><span class="arithmatex">\(\text{Query}\)</span> Ë°®Ëææ‰∫Ü‰∏ÄÁßçËØâÊ±ÇÔºöÂ∏åÊúõÂæóÂà∞‰ªÄ‰πàÔºåÂèØ‰ª•ÁúãÂÅö<strong>ÂºïÂØº‰ø°ÊÅØ (guide)</strong>„ÄÇ</p>
<p>ÈÄöËøá Multi-Head Self-attention ÁªìÂêàÂú®‰∏ÄËµ∑ÁöÑËøáÁ®ãÂ∞±Áõ∏ÂΩì‰∫éÊòØ<strong>ÊääÊàë‰ª¨ÈúÄË¶ÅÁöÑÂÜÖÂÆπ‰ø°ÊÅØÊåáÂØºË°®ËææÂá∫Êù•</strong>„ÄÇ</p>
<p>Decoder ÁöÑÊúÄÂêéÊòØ Softmax È¢ÑÊµãËæìÂá∫ÂçïËØç„ÄÇÂõ†‰∏∫ Mask ÁöÑÂ≠òÂú®Ôºå‰ΩøÂæóÂçïËØç 0 ÁöÑËæìÂá∫ <span class="arithmatex">\(Z(0,)\)</span> Âè™ÂåÖÂê´ÂçïËØç 0 ÁöÑ‰ø°ÊÅØ„ÄÇSoftmax Ê†πÊçÆËæìÂá∫Áü©ÈòµÁöÑÊØè‰∏ÄË°åÈ¢ÑÊµã‰∏ã‰∏Ä‰∏™ÂçïËØçÔºåÂ¶Ç‰∏ãÂõæ 27 ÊâÄÁ§∫„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-585526f8bfb9b4dfc691dfeb42562962_r.jpg" /></p>
<p>Â¶Ç‰∏ãÂõæ 28 ÊâÄÁ§∫‰∏∫ Transformer ÁöÑÊï¥‰ΩìÁªìÊûÑ„ÄÇ</p>
<p><img alt="" src="https://pic2.zhimg.com/v2-b9372cc3b3a810dba41e1a64d3b296d5_r.jpg" /></p>
<ul>
<li><strong>2.2 Transformer ‰ª£Á†ÅËß£ËØªÔºö</strong></li>
</ul>
<p>‰ª£Á†ÅÊù•Ëá™Ôºö</p>
<p><a href="https://github.com/jadore801120/attention-is-all-you-need-pytorch">https://github.com/jadore801120/attention-is-all-you-need-pytorch</a><strong>ScaledDotProductAttentionÔºö</strong><br />
ÂÆûÁé∞ÁöÑÊòØÂõæ 22 ÁöÑÊìç‰ΩúÔºåÂÖà‰ª§ <span class="arithmatex">\(Q\cdot K^T\)</span> ÔºåÂÜçÂØπÁªìÊûúÊåâ‰Ωç‰πò‰ª• <span class="arithmatex">\(\text{Mask}\)</span> Áü©ÈòµÔºåÂÜçÂÅö <span class="arithmatex">\(\text{Softmax}\)</span> Êìç‰ΩúÔºåÊúÄÂêéÁöÑÁªìÊûú‰∏é <span class="arithmatex">\(V\)</span> Áõ∏‰πòÔºåÂæóÂà∞ self-attention ÁöÑËæìÂá∫„ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class ScaledDotProductAttention(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &#39;&#39;&#39; Scaled Dot-Product Attention &#39;&#39;&#39;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def __init__(self, temperature, attn_dropout=0.1):
<span class="linenos" data-linenos=" 5 "></span>        super().__init__()
<span class="linenos" data-linenos=" 6 "></span>        self.temperature = temperature
<span class="linenos" data-linenos=" 7 "></span>        self.dropout = nn.Dropout(attn_dropout)
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    def forward(self, q, k, v, mask=None):
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>        attn = torch.matmul(q / self.temperature, k.transpose(2, 3))
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>        if mask is not None:
<span class="linenos" data-linenos="14 "></span>            attn = attn.masked_fill(mask == 0, -1e9)
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span>        attn = self.dropout(F.softmax(attn, dim=-1))
<span class="linenos" data-linenos="17 "></span>        output = torch.matmul(attn, v)
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span>        return output, attn
</code></pre></div>
<p><strong>‰ΩçÁΩÆÁºñÁ†Å PositionalEncodingÔºö</strong><br />
ÂÆûÁé∞ÁöÑÊòØÂºè (5) ÁöÑ‰ΩçÁΩÆÁºñÁ†Å„ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class PositionalEncoding(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>    def __init__(self, d_hid, n_position=200):
<span class="linenos" data-linenos=" 4 "></span>        super(PositionalEncoding, self).__init__()
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>        # Not a parameter
<span class="linenos" data-linenos=" 7 "></span>        self.register_buffer(&#39;pos_table&#39;, self._get_sinusoid_encoding_table(n_position, d_hid))
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    def _get_sinusoid_encoding_table(self, n_position, d_hid):
<span class="linenos" data-linenos="10 "></span>        &#39;&#39;&#39; Sinusoid position encoding table &#39;&#39;&#39;
<span class="linenos" data-linenos="11 "></span>        # TODO: make it with torch instead of numpy
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>        def get_position_angle_vec(position):
<span class="linenos" data-linenos="14 "></span>            return [position / np.power(10000, 2 * (hid_j // 2) / d_hid) for hid_j in range(d_hid)]
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span>        sinusoid_table = np.array([get_position_angle_vec(pos_i) for pos_i in range(n_position)])
<span class="linenos" data-linenos="17 "></span>        sinusoid_table[:, 0::2] = np.sin(sinusoid_table[:, 0::2])  # dim 2i
<span class="linenos" data-linenos="18 "></span>        sinusoid_table[:, 1::2] = np.cos(sinusoid_table[:, 1::2])  # dim 2i+1
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>        return torch.FloatTensor(sinusoid_table).unsqueeze(0)#(1,N,d)
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    def forward(self, x):
<span class="linenos" data-linenos="23 "></span>        # x(B,N,d)
<span class="linenos" data-linenos="24 "></span>        return x + self.pos_table[:, :x.size(1)].clone().detach()
</code></pre></div>
<p><strong>MultiHeadAttentionÔºö</strong><br />
ÂÆûÁé∞Âõæ 13Ôºå14 ÁöÑÂ§öÂ§¥ self-attention„ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class MultiHeadAttention(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &#39;&#39;&#39; Multi-Head Attention module &#39;&#39;&#39;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def __init__(self, n_head, d_model, d_k, d_v, dropout=0.1):
<span class="linenos" data-linenos=" 5 "></span>        super().__init__()
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>        self.n_head = n_head
<span class="linenos" data-linenos=" 8 "></span>        self.d_k = d_k
<span class="linenos" data-linenos=" 9 "></span>        self.d_v = d_v
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>        self.w_qs = nn.Linear(d_model, n_head * d_k, bias=False)
<span class="linenos" data-linenos="12 "></span>        self.w_ks = nn.Linear(d_model, n_head * d_k, bias=False)
<span class="linenos" data-linenos="13 "></span>        self.w_vs = nn.Linear(d_model, n_head * d_v, bias=False)
<span class="linenos" data-linenos="14 "></span>        self.fc = nn.Linear(n_head * d_v, d_model, bias=False)
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span>        self.attention = ScaledDotProductAttention(temperature=d_k ** 0.5)
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>        self.dropout = nn.Dropout(dropout)
<span class="linenos" data-linenos="19 "></span>        self.layer_norm = nn.LayerNorm(d_model, eps=1e-6)
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    def forward(self, q, k, v, mask=None):
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span>        d_k, d_v, n_head = self.d_k, self.d_v, self.n_head
<span class="linenos" data-linenos="25 "></span>        sz_b, len_q, len_k, len_v = q.size(0), q.size(1), k.size(1), v.size(1)
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span>        residual = q
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span>        # Pass through the pre-attention projection: b x lq x (n*dv)
<span class="linenos" data-linenos="31 "></span>        # Separate different heads: b x lq x n x dv
<span class="linenos" data-linenos="32 "></span>        q = self.w_qs(q).view(sz_b, len_q, n_head, d_k)
<span class="linenos" data-linenos="33 "></span>        k = self.w_ks(k).view(sz_b, len_k, n_head, d_k)
<span class="linenos" data-linenos="34 "></span>        v = self.w_vs(v).view(sz_b, len_v, n_head, d_v)
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span>        # Transpose for attention dot product: b x n x lq x dv
<span class="linenos" data-linenos="37 "></span>        q, k, v = q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2)
<span class="linenos" data-linenos="38 "></span>
<span class="linenos" data-linenos="39 "></span>        if mask is not None:
<span class="linenos" data-linenos="40 "></span>            mask = mask.unsqueeze(1)   # For head axis broadcasting.
<span class="linenos" data-linenos="41 "></span>
<span class="linenos" data-linenos="42 "></span>        q, attn = self.attention(q, k, v, mask=mask)
<span class="linenos" data-linenos="43 "></span>
<span class="linenos" data-linenos="44 "></span>        #q (sz_b,n_head,N=len_q,d_k)
<span class="linenos" data-linenos="45 "></span>        #k (sz_b,n_head,N=len_k,d_k)
<span class="linenos" data-linenos="46 "></span>        #v (sz_b,n_head,N=len_v,d_v)
<span class="linenos" data-linenos="47 "></span>
<span class="linenos" data-linenos="48 "></span>        # Transpose to move the head dimension back: b x lq x n x dv
<span class="linenos" data-linenos="49 "></span>        # Combine the last two dimensions to concatenate all the heads together: b x lq x (n*dv)
<span class="linenos" data-linenos="50 "></span>        q = q.transpose(1, 2).contiguous().view(sz_b, len_q, -1)
<span class="linenos" data-linenos="51 "></span>
<span class="linenos" data-linenos="52 "></span>        #q (sz_b,len_q,n_head,N * d_k)
<span class="linenos" data-linenos="53 "></span>        q = self.dropout(self.fc(q))
<span class="linenos" data-linenos="54 "></span>        q += residual
<span class="linenos" data-linenos="55 "></span>
<span class="linenos" data-linenos="56 "></span>        q = self.layer_norm(q)
<span class="linenos" data-linenos="57 "></span>
<span class="linenos" data-linenos="58 "></span>        return q, attn
</code></pre></div>
<p><strong>ÂâçÂêë‰º†Êí≠ Feed Forward NetworkÔºö</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class PositionwiseFeedForward(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &#39;&#39;&#39; A two-feed-forward-layer module &#39;&#39;&#39;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def __init__(self, d_in, d_hid, dropout=0.1):
<span class="linenos" data-linenos=" 5 "></span>        super().__init__()
<span class="linenos" data-linenos=" 6 "></span>        self.w_1 = nn.Linear(d_in, d_hid) # position-wise
<span class="linenos" data-linenos=" 7 "></span>        self.w_2 = nn.Linear(d_hid, d_in) # position-wise
<span class="linenos" data-linenos=" 8 "></span>        self.layer_norm = nn.LayerNorm(d_in, eps=1e-6)
<span class="linenos" data-linenos=" 9 "></span>        self.dropout = nn.Dropout(dropout)
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>    def forward(self, x):
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>        residual = x
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>        x = self.w_2(F.relu(self.w_1(x)))
<span class="linenos" data-linenos="16 "></span>        x = self.dropout(x)
<span class="linenos" data-linenos="17 "></span>        x += residual
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span>        x = self.layer_norm(x)
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span>        return x
</code></pre></div>
<p><strong>EncoderLayerÔºö</strong><br />
ÂÆûÁé∞Âõæ 26 ‰∏≠ÁöÑ‰∏Ä‰∏™ EncoderLayerÔºåÂÖ∑‰ΩìÁöÑÁªìÊûÑÂ¶ÇÂõæ 19 ÊâÄÁ§∫„ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class EncoderLayer(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &#39;&#39;&#39; Compose with two layers &#39;&#39;&#39;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def __init__(self, d_model, d_inner, n_head, d_k, d_v, dropout=0.1):
<span class="linenos" data-linenos=" 5 "></span>        super(EncoderLayer, self).__init__()
<span class="linenos" data-linenos=" 6 "></span>        self.slf_attn = MultiHeadAttention(n_head, d_model, d_k, d_v, dropout=dropout)
<span class="linenos" data-linenos=" 7 "></span>        self.pos_ffn = PositionwiseFeedForward(d_model, d_inner, dropout=dropout)
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    def forward(self, enc_input, slf_attn_mask=None):
<span class="linenos" data-linenos="10 "></span>        enc_output, enc_slf_attn = self.slf_attn(
<span class="linenos" data-linenos="11 "></span>            enc_input, enc_input, enc_input, mask=slf_attn_mask)
<span class="linenos" data-linenos="12 "></span>        enc_output = self.pos_ffn(enc_output)
<span class="linenos" data-linenos="13 "></span>        return enc_output, enc_slf_attn
</code></pre></div>
<p><strong>DecoderLayerÔºö</strong><br />
ÂÆûÁé∞Âõæ 28 ‰∏≠ÁöÑ‰∏Ä‰∏™ DecoderLayerÔºåÂÖ∑‰ΩìÁöÑÁªìÊûÑÂ¶ÇÂõæ 21 ÊâÄÁ§∫„ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class DecoderLayer(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &#39;&#39;&#39; Compose with three layers &#39;&#39;&#39;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def __init__(self, d_model, d_inner, n_head, d_k, d_v, dropout=0.1):
<span class="linenos" data-linenos=" 5 "></span>        super(DecoderLayer, self).__init__()
<span class="linenos" data-linenos=" 6 "></span>        self.slf_attn = MultiHeadAttention(n_head, d_model, d_k, d_v, dropout=dropout)
<span class="linenos" data-linenos=" 7 "></span>        self.enc_attn = MultiHeadAttention(n_head, d_model, d_k, d_v, dropout=dropout)
<span class="linenos" data-linenos=" 8 "></span>        self.pos_ffn = PositionwiseFeedForward(d_model, d_inner, dropout=dropout)
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    def forward(
<span class="linenos" data-linenos="11 "></span>            self, dec_input, enc_output,
<span class="linenos" data-linenos="12 "></span>            slf_attn_mask=None, dec_enc_attn_mask=None):
<span class="linenos" data-linenos="13 "></span>        dec_output, dec_slf_attn = self.slf_attn(
<span class="linenos" data-linenos="14 "></span>            dec_input, dec_input, dec_input, mask=slf_attn_mask)
<span class="linenos" data-linenos="15 "></span>        dec_output, dec_enc_attn = self.enc_attn(
<span class="linenos" data-linenos="16 "></span>            dec_output, enc_output, enc_output, mask=dec_enc_attn_mask)
<span class="linenos" data-linenos="17 "></span>        dec_output = self.pos_ffn(dec_output)
<span class="linenos" data-linenos="18 "></span>        return dec_output, dec_slf_attn, dec_enc_attn
</code></pre></div>
<p><strong>EncoderÔºö</strong><br />
ÂÆûÁé∞Âõæ 28,21 Â∑¶‰æßÁöÑ EncoderÔºö</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class Encoder(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &#39;&#39;&#39; A encoder model with self attention mechanism. &#39;&#39;&#39;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def __init__(
<span class="linenos" data-linenos=" 5 "></span>            self, n_src_vocab, d_word_vec, n_layers, n_head, d_k, d_v,
<span class="linenos" data-linenos=" 6 "></span>            d_model, d_inner, pad_idx, dropout=0.1, n_position=200):
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>        super().__init__()
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>        self.src_word_emb = nn.Embedding(n_src_vocab, d_word_vec, padding_idx=pad_idx)
<span class="linenos" data-linenos="11 "></span>        self.position_enc = PositionalEncoding(d_word_vec, n_position=n_position)
<span class="linenos" data-linenos="12 "></span>        self.dropout = nn.Dropout(p=dropout)
<span class="linenos" data-linenos="13 "></span>        self.layer_stack = nn.ModuleList([
<span class="linenos" data-linenos="14 "></span>            EncoderLayer(d_model, d_inner, n_head, d_k, d_v, dropout=dropout)
<span class="linenos" data-linenos="15 "></span>            for _ in range(n_layers)])
<span class="linenos" data-linenos="16 "></span>        self.layer_norm = nn.LayerNorm(d_model, eps=1e-6)
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    def forward(self, src_seq, src_mask, return_attns=False):
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>        enc_slf_attn_list = []
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>        # -- Forward
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span>        enc_output = self.dropout(self.position_enc(self.src_word_emb(src_seq)))
<span class="linenos" data-linenos="25 "></span>        enc_output = self.layer_norm(enc_output)
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span>        for enc_layer in self.layer_stack:
<span class="linenos" data-linenos="28 "></span>            enc_output, enc_slf_attn = enc_layer(enc_output, slf_attn_mask=src_mask)
<span class="linenos" data-linenos="29 "></span>            enc_slf_attn_list += [enc_slf_attn] if return_attns else []
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span>        if return_attns:
<span class="linenos" data-linenos="32 "></span>            return enc_output, enc_slf_attn_list
<span class="linenos" data-linenos="33 "></span>        return enc_output,
</code></pre></div>
<p><strong>DecoderÔºö</strong><br />
ÂÆûÁé∞Âõæ 28,21 Âè≥‰æßÁöÑ DecoderÔºö</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class Decoder(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &#39;&#39;&#39; A decoder model with self attention mechanism. &#39;&#39;&#39;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def forward(self, trg_seq, trg_mask, enc_output, src_mask, return_attns=False):
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>        dec_slf_attn_list, dec_enc_attn_list = [], []
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>        # -- Forward
<span class="linenos" data-linenos=" 9 "></span>        dec_output = self.dropout(self.position_enc(self.trg_word_emb(trg_seq)))
<span class="linenos" data-linenos="10 "></span>        dec_output = self.layer_norm(dec_output)
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>        for dec_layer in self.layer_stack:
<span class="linenos" data-linenos="13 "></span>            dec_output, dec_slf_attn, dec_enc_attn = dec_layer(
<span class="linenos" data-linenos="14 "></span>                dec_output, enc_output, slf_attn_mask=trg_mask, dec_enc_attn_mask=src_mask)
<span class="linenos" data-linenos="15 "></span>            dec_slf_attn_list += [dec_slf_attn] if return_attns else []
<span class="linenos" data-linenos="16 "></span>            dec_enc_attn_list += [dec_enc_attn] if return_attns else []
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>        if return_attns:
<span class="linenos" data-linenos="19 "></span>            return dec_output, dec_slf_attn_list, dec_enc_attn_list
<span class="linenos" data-linenos="20 "></span>        return dec_output,
</code></pre></div>
<p><strong>Êï¥‰ΩìÁªìÊûÑÔºö</strong><br />
ÂÆûÁé∞Âõæ 28,21 Êï¥‰ΩìÁöÑ TransformerÔºö</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class Transformer(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &#39;&#39;&#39; A sequence to sequence model with attention mechanism. &#39;&#39;&#39;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def __init__(
<span class="linenos" data-linenos=" 5 "></span>            self, n_src_vocab, n_trg_vocab, src_pad_idx, trg_pad_idx,
<span class="linenos" data-linenos=" 6 "></span>            d_word_vec=512, d_model=512, d_inner=2048,
<span class="linenos" data-linenos=" 7 "></span>            n_layers=6, n_head=8, d_k=64, d_v=64, dropout=0.1, n_position=200,
<span class="linenos" data-linenos=" 8 "></span>            trg_emb_prj_weight_sharing=True, emb_src_trg_weight_sharing=True):
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>        super().__init__()
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>        self.src_pad_idx, self.trg_pad_idx = src_pad_idx, trg_pad_idx
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>        self.encoder = Encoder(
<span class="linenos" data-linenos="15 "></span>            n_src_vocab=n_src_vocab, n_position=n_position,
<span class="linenos" data-linenos="16 "></span>            d_word_vec=d_word_vec, d_model=d_model, d_inner=d_inner,
<span class="linenos" data-linenos="17 "></span>            n_layers=n_layers, n_head=n_head, d_k=d_k, d_v=d_v,
<span class="linenos" data-linenos="18 "></span>            pad_idx=src_pad_idx, dropout=dropout)
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>        self.decoder = Decoder(
<span class="linenos" data-linenos="21 "></span>            n_trg_vocab=n_trg_vocab, n_position=n_position,
<span class="linenos" data-linenos="22 "></span>            d_word_vec=d_word_vec, d_model=d_model, d_inner=d_inner,
<span class="linenos" data-linenos="23 "></span>            n_layers=n_layers, n_head=n_head, d_k=d_k, d_v=d_v,
<span class="linenos" data-linenos="24 "></span>            pad_idx=trg_pad_idx, dropout=dropout)
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span>        self.trg_word_prj = nn.Linear(d_model, n_trg_vocab, bias=False)
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span>        for p in self.parameters():
<span class="linenos" data-linenos="29 "></span>            if p.dim() &gt; 1:
<span class="linenos" data-linenos="30 "></span>                nn.init.xavier_uniform_(p) 
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span>        assert d_model == d_word_vec, \
<span class="linenos" data-linenos="33 "></span>        &#39;To facilitate the residual connections, \
<span class="linenos" data-linenos="34 "></span>         the dimensions of all module outputs shall be the same.&#39;
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span>        self.x_logit_scale = 1.
<span class="linenos" data-linenos="37 "></span>        if trg_emb_prj_weight_sharing:
<span class="linenos" data-linenos="38 "></span>            # Share the weight between target word embedding &amp; last dense layer
<span class="linenos" data-linenos="39 "></span>            self.trg_word_prj.weight = self.decoder.trg_word_emb.weight
<span class="linenos" data-linenos="40 "></span>            self.x_logit_scale = (d_model ** -0.5)
<span class="linenos" data-linenos="41 "></span>
<span class="linenos" data-linenos="42 "></span>        if emb_src_trg_weight_sharing:
<span class="linenos" data-linenos="43 "></span>            self.encoder.src_word_emb.weight = self.decoder.trg_word_emb.weight
<span class="linenos" data-linenos="44 "></span>
<span class="linenos" data-linenos="45 "></span>
<span class="linenos" data-linenos="46 "></span>    def forward(self, src_seq, trg_seq):
<span class="linenos" data-linenos="47 "></span>
<span class="linenos" data-linenos="48 "></span>        src_mask = get_pad_mask(src_seq, self.src_pad_idx)
<span class="linenos" data-linenos="49 "></span>        trg_mask = get_pad_mask(trg_seq, self.trg_pad_idx) &amp; get_subsequent_mask(trg_seq)
<span class="linenos" data-linenos="50 "></span>
<span class="linenos" data-linenos="51 "></span>        enc_output, *_ = self.encoder(src_seq, src_mask)
<span class="linenos" data-linenos="52 "></span>        dec_output, *_ = self.decoder(trg_seq, trg_mask, enc_output, src_mask)
<span class="linenos" data-linenos="53 "></span>        seq_logit = self.trg_word_prj(dec_output) * self.x_logit_scale
<span class="linenos" data-linenos="54 "></span>
<span class="linenos" data-linenos="55 "></span>        return seq_logit.view(-1, seq_logit.size(2))
</code></pre></div>
<p><strong>‰∫ßÁîü MaskÔºö</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>def get_pad_mask(seq, pad_idx):
<span class="linenos" data-linenos="2 "></span>    return (seq != pad_idx).unsqueeze(-2)
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span>def get_subsequent_mask(seq):
<span class="linenos" data-linenos="5 "></span>    &#39;&#39;&#39; For masking out the subsequent info. &#39;&#39;&#39;
<span class="linenos" data-linenos="6 "></span>    sz_b, len_s = seq.size()
<span class="linenos" data-linenos="7 "></span>    subsequent_mask = (1 - torch.triu(
<span class="linenos" data-linenos="8 "></span>        torch.ones((1, len_s, len_s), device=seq.device), diagonal=1)).bool()
<span class="linenos" data-linenos="9 "></span>    return subsequent_mask
</code></pre></div>
<p>src_mask = get_pad_mask(src_seq, self.src_pad_idx)<br />
Áî®‰∫é‰∫ßÁîü Encoder ÁöÑ MaskÔºåÂÆÉÊòØ‰∏ÄÂàó Bool ÂÄºÔºåË¥üË¥£ÊääÊ†áÁÇπ mask Êéâ„ÄÇ<br />
trg_mask = get_pad_mask(trg_seq, self.trg_pad_idx) &amp; get_subsequent_mask(trg_seq)<br />
Áî®‰∫é‰∫ßÁîü Decoder ÁöÑ Mask„ÄÇÂÆÉÊòØ‰∏Ä‰∏™Áü©ÈòµÔºåÂ¶ÇÂõæ 24 ‰∏≠ÁöÑ Mask ÊâÄÁ§∫ÔºåÂäüËÉΩÂ∑≤Âú®‰∏äÊñá‰ªãÁªç„ÄÇ</p>
<h3 id="3-transformerdetection-detr">3 Transformer+DetectionÔºöÂºïÂÖ•ËßÜËßâÈ¢ÜÂüüÁöÑÈ¶ñÂàõ DETR<a class="headerlink" href="#3-transformerdetection-detr" title="Permanent link">&para;</a></h3>
<p><strong>ËÆ∫ÊñáÂêçÁß∞ÔºöEnd-to-End Object Detection with Transformers</strong></p>
<p><strong>ËÆ∫ÊñáÂú∞ÂùÄÔºö</strong></p>
<p><a href="https://arxiv.org/abs/2005.12872">https://arxiv.org/abs/2005.12872</a></p>
<ul>
<li><strong>3.1 DETR ÂéüÁêÜÂàÜÊûêÔºö</strong></li>
</ul>
<p><span class="arithmatex">\(\color{indianred}{\text{ÁΩëÁªúÊû∂ÊûÑÈÉ®ÂàÜËß£ËØª:}}\)</span></p>
<p>Êú¨ÊñáÁöÑ‰ªªÂä°ÊòØ Object detectionÔºåÁî®Âà∞ÁöÑÂ∑•ÂÖ∑ÊòØ TransformersÔºåÁâπÁÇπÊòØ End-to-end„ÄÇ</p>
<p>ÁõÆÊ†áÊ£ÄÊµãÁöÑ‰ªªÂä°ÊòØË¶ÅÂéªÈ¢ÑÊµã‰∏ÄÁ≥ªÂàóÁöÑ Bounding Box ÁöÑÂùêÊ†á‰ª•Âèä LabelÔºå Áé∞‰ª£Â§ßÂ§öÊï∞Ê£ÄÊµãÂô®ÈÄöËøáÂÆö‰πâ‰∏Ä‰∫õ proposalÔºåanchor ÊàñËÄÖ windowsÔºåÊääÈóÆÈ¢òÊûÑÂª∫Êàê‰∏∫‰∏Ä‰∏™ÂàÜÁ±ªÂíåÂõûÂΩíÈóÆÈ¢òÊù•Èó¥Êé•Âú∞ÂÆåÊàêËøô‰∏™‰ªªÂä°„ÄÇ<strong>ÊñáÁ´†ÊâÄÂÅöÁöÑÂ∑•‰ΩúÔºåÂ∞±ÊòØÂ∞Ü transformers ËøêÁî®Âà∞‰∫Ü object detection È¢ÜÂüüÔºåÂèñ‰ª£‰∫ÜÁé∞Âú®ÁöÑÊ®°ÂûãÈúÄË¶ÅÊâãÂ∑•ËÆæËÆ°ÁöÑÂ∑•‰ΩúÔºåÂπ∂‰∏îÂèñÂæó‰∫Ü‰∏çÈîôÁöÑÁªìÊûú„ÄÇ</strong>Âú® object detection ‰∏ä DETR ÂáÜÁ°ÆÁéáÂíåËøêË°åÊó∂Èó¥‰∏äÂíå Faster RCNN Áõ∏ÂΩìÔºõÂ∞ÜÊ®°Âûã generalize Âà∞ panoptic segmentation ‰ªªÂä°‰∏äÔºåDETR Ë°®Áé∞ÁîöËá≥ËøòË∂ÖËøá‰∫ÜÂÖ∂‰ªñÁöÑ baseline„ÄÇDETR Á¨¨‰∏Ä‰∏™‰ΩøÁî® End to End ÁöÑÊñπÂºèËß£ÂÜ≥Ê£ÄÊµãÈóÆÈ¢òÔºåËß£ÂÜ≥ÁöÑÊñπÊ≥ïÊòØÊääÊ£ÄÊµãÈóÆÈ¢òËßÜ‰ΩúÊòØ‰∏Ä‰∏™ set prediction problemÔºåÂ¶Ç‰∏ãÂõæ 29 ÊâÄÁ§∫„ÄÇ</p>
<p><img alt="" src="https://pic1.zhimg.com/v2-772984ccd82a0e0a279ea6a09c3c34c0_r.jpg" /></p>
<p>ÁΩëÁªúÁöÑ‰∏ªË¶ÅÁªÑÊàêÊòØ CNN Âíå TransformerÔºåTransformer ÂÄüÂä©Á¨¨ 1 ËäÇËÆ≤Âà∞ÁöÑ self-attention Êú∫Âà∂ÔºåÂèØ‰ª•ÊòæÂºèÂú∞ÂØπ‰∏Ä‰∏™Â∫èÂàó‰∏≠ÁöÑÊâÄÊúâ elements ‰∏§‰∏§‰πãÈó¥ÁöÑ interactions ËøõË°åÂª∫Ê®°Ôºå‰ΩøÂæóËøôÁ±ª transformer ÁöÑÁªìÊûÑÈùûÂ∏∏ÈÄÇÂêàÂ∏¶Á∫¶ÊùüÁöÑ set prediction ÁöÑÈóÆÈ¢ò„ÄÇDETR ÁöÑÁâπÁÇπÊòØÔºö‰∏ÄÊ¨°È¢ÑÊµãÔºåÁ´ØÂà∞Á´ØËÆ≠ÁªÉÔºåset loss function Âíå‰∫åÂàÜÂåπÈÖç„ÄÇ</p>
<p><strong>ÊñáÁ´†ÁöÑ‰∏ªË¶ÅÊúâ‰∏§‰∏™ÂÖ≥ÈîÆÁöÑÈÉ®ÂàÜ„ÄÇ</strong></p>
<p><strong>Á¨¨‰∏Ä‰∏™ÊòØÁî® transformer ÁöÑ encoder-decoder Êû∂ÊûÑ‰∏ÄÊ¨°ÊÄßÁîüÊàê</strong> <span class="arithmatex">\(N\)</span> <strong>‰∏™ box prediction„ÄÇÂÖ∂‰∏≠</strong> <span class="arithmatex">\(N\)</span> <strong>ÊòØ‰∏Ä‰∏™‰∫ãÂÖàËÆæÂÆöÁöÑ„ÄÅÊØîËøúËøúÂ§ß‰∫é image ‰∏≠ object ‰∏™Êï∞ÁöÑ‰∏Ä‰∏™Êï¥Êï∞„ÄÇ</strong></p>
<p><strong>Á¨¨‰∫å‰∏™ÊòØËÆæËÆ°‰∫Ü bipartite matching lossÔºåÂü∫‰∫éÈ¢ÑÊµãÁöÑ boxex Âíå ground truth boxes ÁöÑ‰∫åÂàÜÂõæÂåπÈÖçËÆ°ÁÆó loss ÁöÑÂ§ßÂ∞èÔºå‰ªéËÄå‰ΩøÂæóÈ¢ÑÊµãÁöÑ box ÁöÑ‰ΩçÁΩÆÂíåÁ±ªÂà´Êõ¥Êé•Ëøë‰∫é ground truth„ÄÇ</strong></p>
<p>DETR Êï¥‰ΩìÁªìÊûÑÂèØ‰ª•ÂàÜ‰∏∫Âõõ‰∏™ÈÉ®ÂàÜÔºöbackboneÔºåencoderÔºådecoder Âíå FFNÔºåÂ¶Ç‰∏ãÂõæ 30 ÊâÄÁ§∫Ôºå‰ª•‰∏ãÂàÜÂà´Ëß£ÈáäËøôÂõõ‰∏™ÈÉ®ÂàÜÔºö</p>
<p><img alt="" src="https://pic4.zhimg.com/v2-3d43474df51c545ad6bafc19b3c8ccc3_r.jpg" /></p>
<p><strong>1 È¶ñÂÖàÁúã backboneÔºö</strong>CNN backbone Â§ÑÁêÜ <span class="arithmatex">\(x_{\text{img}}\in B\times 3\times H_0 \times W_0\)</span> Áª¥ÁöÑÂõæÂÉèÔºåÊääÂÆÉËΩ¨Êç¢‰∏∫<span class="arithmatex">\(f\in R^{B\times C\times H\times W}\)</span> Áª¥ÁöÑ feature mapÔºà‰∏ÄËà¨Êù•ËØ¥ <span class="arithmatex">\(C = 2048Êàñ256, H = \frac{H_0}{32}, W = \frac{W_0}{32}\)</span>ÔºâÔºåbackbone Âè™ÂÅöËøô‰∏Ä‰ª∂‰∫ã„ÄÇ</p>
<p><strong>2 ÂÜçÁúã encoderÔºö</strong>encoder ÁöÑËæìÂÖ•ÊòØ<span class="arithmatex">\(f\in R^{B\times C\times H\times W}\)</span> Áª¥ÁöÑ feature mapÔºåÊé•‰∏ãÊù•‰æùÊ¨°ËøõË°å‰ª•‰∏ãËøáÁ®ãÔºö</p>
<ul>
<li><strong>ÈÄöÈÅìÊï∞ÂéãÁº©Ôºö</strong>ÂÖàÁî® <span class="arithmatex">\(1\times 1\)</span> convolution Â§ÑÁêÜÔºåÂ∞Ü channels Êï∞Èáè‰ªé <span class="arithmatex">\(C\)</span> ÂéãÁº©Âà∞ <span class="arithmatex">\(d\)</span>ÔºåÂç≥ÂæóÂà∞<span class="arithmatex">\(z_0\in R^{B\times d\times H\times W}\)</span> Áª¥ÁöÑÊñ∞ feature map„ÄÇ</li>
<li><strong>ËΩ¨Âåñ‰∏∫Â∫èÂàóÂåñÊï∞ÊçÆÔºö</strong>Â∞ÜÁ©∫Èó¥ÁöÑÁª¥Â∫¶ÔºàÈ´òÂíåÂÆΩÔºâÂéãÁº©‰∏∫‰∏Ä‰∏™Áª¥Â∫¶ÔºåÂç≥Êää‰∏ä‰∏ÄÊ≠•ÂæóÂà∞ÁöÑ<span class="arithmatex">\(z_0\in R^{B\times d\times H\times W}(d=256)\)</span> Áª¥ÁöÑ feature map ÈÄöËøá reshape Êàê<span class="arithmatex">\((HW,B,256)\)</span> Áª¥ÁöÑ feature map„ÄÇ</li>
<li><strong>‰ΩçÁΩÆÁºñÁ†ÅÔºö</strong>Âú®ÂæóÂà∞‰∫Ü<span class="arithmatex">\(z_0\in R^{B\times d\times H\times W}\)</span> Áª¥ÁöÑ feature map ‰πãÂêéÔºåÊ≠£ÂºèËæìÂÖ• encoder ‰πãÂâçÔºåÈúÄË¶ÅËøõË°å <strong>Positional Encoding</strong>„ÄÇËøô‰∏ÄÊ≠•Âú®Á¨¨ 2 ËäÇËÆ≤Ëß£ transformer ÁöÑÊó∂ÂÄôÂ∑≤ÁªèÊèêÂà∞ËøáÔºåÂõ†‰∏∫<strong>Âú® self-attention ‰∏≠ÈúÄË¶ÅÊúâË°®Á§∫‰ΩçÁΩÆÁöÑ‰ø°ÊÅØ</strong>ÔºåÂê¶Âàô‰Ω†ÁöÑ sequence = "A Êâì‰∫Ü B" ËøòÊòØ sequence = "B Êâì‰∫Ü A" ÁöÑÊïàÊûúÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ<strong>‰ΩÜÊòØ transformer encoder Ëøô‰∏™ÁªìÊûÑÊú¨Ë∫´Âç¥Êó†Ê≥ï‰ΩìÁé∞Âá∫‰ΩçÁΩÆ‰ø°ÊÅØ„ÄÇ</strong>‰πüÂ∞±ÊòØËØ¥ÔºåÊàë‰ª¨ÈúÄË¶ÅÂØπËøô‰∏™ <span class="arithmatex">\(z_0\in R^{B\times d\times H\times W}\)</span> Áª¥ÁöÑ feature map ÂÅö positional encoding„ÄÇ</li>
</ul>
<p>ËøõË°åÂÆå‰ΩçÁΩÆÁºñÁ†Å‰ª•ÂêéÊ†πÊçÆ paper ‰∏≠ÁöÑÂõæÁâá‰ºöÊúâ‰∏™Áõ∏Âä†ÁöÑËøáÁ®ãÔºåÂ¶Ç‰∏ãÂõæÈóÆÂè∑Â§ÑÊâÄÁ§∫„ÄÇÂæàÂ§öËØªËÄÖÊúâÁñëÈóÆÁöÑÂú∞ÊñπÊòØÔºöËÆ∫ÊñáÂõæ 31 Á§∫‰∏≠Áõ∏Âä†ÁöÑ 2 ‰∏™Âº†ÈáèÔºå‰∏Ä‰∏™ÊòØ input embeddingÔºåÂè¶‰∏Ä‰∏™ÊòØ‰ΩçÁΩÆÁºñÁ†ÅÁª¥Â∫¶Áúã‰∏äÂéª‰∏ç‰∏ÄËá¥ÔºåÊòØÊÄé‰πàÁõ∏Âä†ÁöÑÔºüÂêéÈù¢‰ºöËß£Á≠î„ÄÇ</p>
<p><img alt="" src="https://pic1.zhimg.com/v2-a7e4de7ab9cc0d3015ca04cc251ee460_r.jpg" /></p>
<p>ÂéüÁâà Transformer Âíå Vision Transformer (Á¨¨ 4 ËäÇËÆ≤Ëø∞) ÁöÑ Positional Encoding ÁöÑË°®ËææÂºè‰∏∫Ôºö</p>
<div class="arithmatex">\[\begin{align}PE_{(pos, 2i)} = sin(pos/10000^{2i/d}) \\ PE_{(pos, 2i+1)} = cos(pos/10000^{2i/d}) \end{align}\tag{10}\]</div>
<p>Âºè‰∏≠Ôºå <span class="arithmatex">\(d\)</span> Â∞±ÊòØËøô‰∏™ <span class="arithmatex">\(d\times HW\)</span> Áª¥ÁöÑ feature map ÁöÑÁ¨¨‰∏ÄÁª¥Ôºå <span class="arithmatex">\(pos\in [1,HW]\)</span> „ÄÇË°®Á§∫ token Âú® sequence ‰∏≠ÁöÑ‰ΩçÁΩÆÔºåsequence ÁöÑÈïøÂ∫¶ÊòØ <span class="arithmatex">\(HW\)</span> Ôºå‰æãÂ¶ÇÁ¨¨‰∏Ä‰∏™ token ÁöÑ <span class="arithmatex">\(pos=0\)</span> „ÄÇ</p>
<p><span class="arithmatex">\(i\)</span> ÔºåÊàñËÄÖÂáÜÁ°ÆÊÑè‰πâ‰∏äÊòØ <span class="arithmatex">\(2i\)</span> Âíå <span class="arithmatex">\(2i+1\)</span> Ë°®Á§∫‰∫Ü Positional Encoding ÁöÑÁª¥Â∫¶Ôºå<span class="arithmatex">\(i\)</span> ÁöÑÂèñÂÄºËåÉÂõ¥ÊòØÔºö <span class="arithmatex">\(\left[ 0,\ldots ,{{{d}}}/{2}\; \right)\)</span> „ÄÇÊâÄ‰ª•ÂΩì <span class="arithmatex">\(pos\)</span> ‰∏∫ 1 Êó∂ÔºåÂØπÂ∫îÁöÑ Positional Encoding ÂèØ‰ª•ÂÜôÊàêÔºö</p>
<p><span class="arithmatex">\(PE\left( 1 \right)=\left[ \sin \left( {1}/{{{10000}^{{0}/{256}\;}}}\; \right),\cos \left( {1}/{{{10000}^{{0}/{256}\;}}}\; \right),\sin \left( {1}/{{{10000}^{{2}/{256}\;}}}\; \right),\cos \left( {1}/{{{10000}^{{2}/{256}\;}}}\; \right),\ldots \right]\)</span></p>
<p>Âºè‰∏≠Ôºå <span class="arithmatex">\({{d}_{}}=256\)</span>„ÄÇ</p>
<p><strong>Á¨¨‰∏ÄÁÇπ‰∏çÂêåÁöÑÊòØ</strong>ÔºåÂéüÁâà Transformer Âè™ËÄÉËôë <span class="arithmatex">\(x\)</span> ÊñπÂêëÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºå‰ΩÜÊòØ DETR ËÄÉËôë‰∫Ü <span class="arithmatex">\(xy\)</span> ÊñπÂêëÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºåÂõ†‰∏∫ÂõæÂÉèÁâπÂæÅÊòØ 2-D ÁâπÂæÅ„ÄÇÈááÁî®ÁöÑ‰æùÁÑ∂ÊòØ <span class="arithmatex">\(\text{sin cos}\)</span> Ê®°ÂºèÔºå‰ΩÜÊòØÈúÄË¶ÅËÄÉËôë <span class="arithmatex">\(xy\)</span> ‰∏§‰∏™ÊñπÂêë„ÄÇ‰∏çÊòØÁ±ª‰ºº vision transoformer ÂÅöÊ≥ïÁÆÄÂçïÁöÑÂ∞ÜÂÖ∂Êãâ‰º∏‰∏∫ <span class="arithmatex">\(d\times HW\)</span> ÔºåÁÑ∂Âêé‰ªé <span class="arithmatex">\([1,HW]\)</span> ËøõË°åÈïøÂ∫¶‰∏∫ 256 ÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºåËÄåÊòØËÄÉËôë‰∫Ü <span class="arithmatex">\(xy\)</span> ÊñπÂêëÂêåÊó∂ÁºñÁ†ÅÔºåÊØè‰∏™ÊñπÂêëÂêÑÁºñÁ†Å 128 Áª¥ÂêëÈáèÔºåËøôÁßçÁºñÁ†ÅÊñπÂºèÊõ¥Á¨¶ÂêàÂõæÂÉèÁâπÁÇπ„ÄÇ</p>
<p>Positional Encoding ÁöÑËæìÂá∫Âº†ÈáèÊòØÔºö <span class="arithmatex">\((B,d,H,W),d=256\)</span> ÔºåÂÖ∂‰∏≠ <span class="arithmatex">\(d\)</span> ‰ª£Ë°®‰ΩçÁΩÆÁºñÁ†ÅÁöÑÈïøÂ∫¶Ôºå <span class="arithmatex">\(H,W\)</span> ‰ª£Ë°®Âº†ÈáèÁöÑ‰ΩçÁΩÆ„ÄÇÊÑèÊÄùÊòØËØ¥ÔºåËøô‰∏™ÁâπÂæÅÂõæ‰∏äÁöÑ‰ªªÊÑè‰∏Ä‰∏™ÁÇπ <span class="arithmatex">\((H_1,W_1)\)</span> Êúâ‰∏™‰ΩçÁΩÆÁºñÁ†ÅÔºåËøô‰∏™ÁºñÁ†ÅÁöÑÈïøÂ∫¶ÊòØ 256ÔºåÂÖ∂‰∏≠ÔºåÂâç 128 Áª¥‰ª£Ë°® <span class="arithmatex">\(H_1\)</span> ÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºåÂêé 128 Áª¥‰ª£Ë°® <span class="arithmatex">\(W_1\)</span> ÁöÑ‰ΩçÁΩÆÁºñÁ†Å„ÄÇ</p>
<div class="arithmatex">\[\begin{align}a)\quad PE_{(pos_x, 2i)} = sin(pos_x/10000^{2i/128}) \\ b)\quad PE_{(pos_x, 2i+1)} = cos(pos_x/10000^{2i/128}) \\c)\quad PE_{(pos_y, 2i)} = sin(pos_y/10000^{2i/128}) \\ d)\quad PE_{(pos_y, 2i+1)} = cos(pos_y/10000^{2i/128}) \end{align}\tag{11}\]</div>
<p>ÂÅáËÆæ‰Ω†ÊÉ≥ËÆ°ÁÆó‰ªªÊÑè‰∏Ä‰∏™‰ΩçÁΩÆ <span class="arithmatex">\((pos_x,pos_y),pos_x\in [1,HW],pos_y\in [1,HW]\)</span> ÁöÑ Positional EncodingÔºåÊää <span class="arithmatex">\(pos_x\)</span> ‰ª£ÂÖ• (11) ÂºèÁöÑ <span class="arithmatex">\(a\)</span> ÂºèÂíå <span class="arithmatex">\(b\)</span> ÂºèÂèØ‰ª•ËÆ°ÁÆóÂæóÂà∞ <strong>128 Áª¥ÁöÑÂêëÈáè</strong>ÔºåÂÆÉ‰ª£Ë°® <span class="arithmatex">\(pos_x\)</span> ÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºåÂÜçÊää <span class="arithmatex">\(pos_y\)</span> ‰ª£ÂÖ• (11) ÂºèÁöÑ <span class="arithmatex">\(c\)</span> ÂºèÂíå <span class="arithmatex">\(d\)</span> ÂºèÂèØ‰ª•ËÆ°ÁÆóÂæóÂà∞ <strong>128 Áª¥ÁöÑÂêëÈáè</strong>ÔºåÂÆÉ‰ª£Ë°® <span class="arithmatex">\(pos_y\)</span> ÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºåÊääËøô 2 ‰∏™ 128 Áª¥ÁöÑÂêëÈáèÊãºÊé•Ëµ∑Êù•ÔºåÂ∞±ÂæóÂà∞‰∫Ü‰∏Ä‰∏™ <strong>256 Áª¥ÁöÑÂêëÈáè</strong>ÔºåÂÆÉ‰ª£Ë°® <span class="arithmatex">\((pos_x,pos_y)\)</span> ÁöÑ‰ΩçÁΩÆÁºñÁ†Å„ÄÇ</p>
<p>ËÆ°ÁÆóÊâÄÊúâ‰ΩçÁΩÆÁöÑÁºñÁ†ÅÔºåÂ∞±ÂæóÂà∞‰∫Ü <span class="arithmatex">\((256,H,W)\)</span> ÁöÑÂº†ÈáèÔºå‰ª£Ë°®Ëøô‰∏™ batch ÁöÑ‰ΩçÁΩÆÁºñÁ†Å„ÄÇÁºñÁ†ÅÁü©ÈòµÁöÑÁª¥Â∫¶ÊòØ <span class="arithmatex">\((B,256,H,W)\)</span> Ôºå‰πüÊääÂÆÉ<strong>Â∫èÂàóÂåñÊàêÁª¥Â∫¶‰∏∫</strong> <span class="arithmatex">\((HW,B,256)\)</span> Áª¥ÁöÑÂº†Èáè„ÄÇ</p>
<p><strong>ÂáÜÂ§á‰∏é<span class="arithmatex">\((HW,B,256)\)</span> Áª¥ÁöÑ feature map Áõ∏Âä†‰ª•ÂêéËæìÂÖ• Encoder„ÄÇ</strong></p>
<p>ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåÁΩë‰∏äËÆ∏Â§öËß£ËØªÊñáÁ´†Ê≤°ÊúâÊêûÊ∏ÖÊ•ö "ËΩ¨Âåñ‰∏∫Â∫èÂàóÂåñÊï∞ÊçÆ" Ëøô‰∏ÄÊ≠•Âíå "‰ΩçÁΩÆÁºñÁ†Å" ÁöÑÈ°∫Â∫èÂÖ≥Á≥ªÔºå‰ª•ÂèäÂèòÈáèÁöÑ shape Âà∞Â∫ïÊòØÊÄéÊ†∑ÂèòÂåñÁöÑÔºåËøôÈáåÊàëÁî®‰∏Ä‰∏™Âõæ 32 Ë°®ËææÔºåÁªàÁªìËøô‰∏™ÈóÆÈ¢ò„ÄÇ</p>
<p><img alt="" src="https://pic1.zhimg.com/v2-89d23b461169c6ab25ea64389fe8d86c_r.jpg" /></p>
<p>ÊâÄ‰ª•Ôºå‰∫ÜËß£‰∫Ü DETR ÁöÑ‰ΩçÁΩÆÁºñÁ†Å‰πãÂêéÔºå‰Ω†Â∫îËØ•ÊòéÁôΩ‰∫ÜÂÖ∂ÂÆû input embedding Âíå‰ΩçÁΩÆÁºñÁ†ÅÁª¥Â∫¶ÂÖ∂ÂÆûÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂè™ÊòØËÆ∫ÊñáÂõæÁ§∫‰∏∫‰∫ÜÁ™ÅÂá∫‰∫å‰ΩçÁºñÁ†ÅÊâÄ‰ª•ÁîªÁöÑ‰∏ç‰∏ÄÊ†∑ÁΩ¢‰∫ÜÔºåÂ¶Ç‰∏ãÂõæ 33 ÊâÄÁ§∫Ôºö</p>
<p><img alt="" src="https://pic4.zhimg.com/v2-464b4196c273afbe67445d21b7bedc77_r.jpg" /></p>
<p><strong>Âè¶‰∏ÄÁÇπ‰∏çÂêåÁöÑÊòØÔºåÂéüÁâà Transformer</strong> Âè™Âú® Encoder ‰πãÂâç‰ΩøÁî®‰∫Ü Positional EncodingÔºåËÄå‰∏îÊòØ<strong>Âú®ËæìÂÖ•‰∏äËøõË°å Positional EncodingÔºåÂÜçÊääËæìÂÖ•ÁªèËøá transformation matrix Âèò‰∏∫ QueryÔºåKey Âíå Value ËøôÂá†‰∏™Âº†Èáè„ÄÇ‰ΩÜÊòØ DETR</strong> Âú® Encoder ÁöÑÊØè‰∏Ä‰∏™ Multi-head Self-attention ‰πãÂâçÈÉΩ‰ΩøÁî®‰∫Ü Positional EncodingÔºå‰∏î<strong>Âè™ÂØπ Query Âíå Key ‰ΩøÁî®‰∫Ü Positional EncodingÔºåÂç≥ÔºöÂè™ÊääÁª¥Â∫¶‰∏∫<span class="arithmatex">\((HW,B,256)\)</span> Áª¥ÁöÑ‰ΩçÁΩÆÁºñÁ†Å‰∏éÁª¥Â∫¶‰∏∫<span class="arithmatex">\((HW,B,256)\)</span> Áª¥ÁöÑ Query Âíå Key Áõ∏Âä†ÔºåËÄå‰∏ç‰∏é Value Áõ∏Âä†„ÄÇ</strong></p>
<p>Â¶ÇÂõæ 34 ÊâÄÁ§∫‰∏∫ DETR ÁöÑ Transformer ÁöÑËØ¶ÁªÜÁªìÊûÑÔºåËØªËÄÖÂèØ‰ª•ÂØπÊØî‰∏ãÂéüÁâà Transformer ÁöÑÁªìÊûÑÔºåÂ¶ÇÂõæ 21 ÊâÄÁ§∫Ôºå‰∏∫‰∫ÜÈòÖËØªÁöÑÊñπ‰æøÊàëÊääÂõæ 21 ÂèàË¥¥Âú®‰∏ãÈù¢‰∫Ü„ÄÇ</p>
<p>ÂèØ‰ª•ÂèëÁé∞ÔºåÈô§‰∫Ü Positional Encoding ËÆæÁΩÆÁöÑ‰∏ç‰∏ÄÊ†∑Â§ñÔºåEncoder ÂÖ∂‰ªñÁöÑÁªìÊûÑÊòØ‰∏ÄËá¥ÁöÑ„ÄÇÊØè‰∏™ Encoder Layer ÂåÖÂê´‰∏Ä‰∏™ multi-head self-attention ÁöÑ module Âíå‰∏Ä‰∏™ÂâçÈ¶àÁΩëÁªú Feed Forward Network„ÄÇ</p>
<p><strong>Encoder ÊúÄÁªàËæìÂá∫ÁöÑÊòØ <span class="arithmatex">\((H\cdot W,b,256)\)</span> Áª¥ÁöÑÁºñÁ†ÅÁü©Èòµ EmbeddingÔºåÊåâÁÖßÂéüÁâà Transformer ÁöÑÂÅöÊ≥ïÔºåÊääËøô‰∏™‰∏úË•øÁªô Decoder„ÄÇ</strong></p>
<p><strong>ÊÄªÁªì‰∏ãÂíåÂéüÂßã transformer ÁºñÁ†ÅÂô®‰∏çÂêåÁöÑÂú∞ÊñπÔºö</strong></p>
<ul>
<li>ËæìÂÖ•ÁºñÁ†ÅÂô®ÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÈúÄË¶ÅËÄÉËôë 2-D Á©∫Èó¥‰ΩçÁΩÆ„ÄÇ</li>
<li>‰ΩçÁΩÆÁºñÁ†ÅÂêëÈáèÈúÄË¶ÅÂä†ÂÖ•Âà∞ÊØè‰∏™ Encoder Layer ‰∏≠„ÄÇ</li>
<li>Âú®ÁºñÁ†ÅÂô®ÂÜÖÈÉ®‰ΩçÁΩÆÁºñÁ†Å Positional Encoding ‰ªÖ‰ªÖ‰ΩúÁî®‰∫é Query Âíå KeyÔºåÂç≥Âè™‰∏é Query Âíå Key Áõ∏Âä†ÔºåValue ‰∏çÂÅö‰ªª‰ΩïÂ§ÑÁêÜ„ÄÇ</li>
</ul>
<p><img alt="" src="https://pic3.zhimg.com/v2-c158521c7a602382dfa4d85243672df2_r.jpg" /></p>
<p><img alt="" src="https://pic4.zhimg.com/v2-1719966a223d98ad48f98c2e4d71add7_r.jpg" /></p>
<p><strong>3 ÂÜçÁúã decoderÔºö</strong></p>
<p>DETR ÁöÑ Decoder ÂíåÂéüÁâà Transformer ÁöÑ decoder ÊòØ‰∏çÂ§™‰∏ÄÊ†∑ÁöÑÔºåÂ¶Ç‰∏ãÂõæ 34 Âíå 21 ÊâÄÁ§∫„ÄÇ</p>
<p>ÂÖàÂõûÂøÜ‰∏ãÂéüÁâà TransformerÔºåÁúã‰∏ãÂõæ 21 ÁöÑ decoder ÁöÑÊúÄÂêé‰∏Ä‰∏™Ê°ÜÔºöoutput probabilityÔºå‰ª£Ë°®Êàë‰ª¨‰∏ÄÊ¨°Âè™‰∫ßÁîü‰∏Ä‰∏™ÂçïËØçÁöÑ softmaxÔºåÊ†πÊçÆËøô‰∏™ softmax ÂæóÂà∞Ëøô‰∏™ÂçïËØçÁöÑÈ¢ÑÊµãÁªìÊûú„ÄÇËøô‰∏™ËøáÁ®ãÊàë‰ª¨Ë°®Ëææ‰∏∫Ôºö<strong>predicts the output sequence one element at a time</strong>„ÄÇ</p>
<p>‰∏çÂêåÁöÑÊòØÔºåDETR ÁöÑ Transformer Decoder ÊòØ‰∏ÄÊ¨°ÊÄßÂ§ÑÁêÜÂÖ®ÈÉ®ÁöÑ object queriesÔºåÂç≥‰∏ÄÊ¨°ÊÄßËæìÂá∫ÂÖ®ÈÉ®ÁöÑ predictionsÔºõËÄå‰∏çÂÉèÂéüÂßãÁöÑ Transformer ÊòØ auto-regressive ÁöÑÔºå‰ªéÂ∑¶Âà∞Âè≥‰∏Ä‰∏™ËØç‰∏Ä‰∏™ËØçÂú∞ËæìÂá∫„ÄÇËøô‰∏™ËøáÁ®ãÊàë‰ª¨Ë°®Ëææ‰∏∫Ôºö<strong>decodes the N objects in parallel at each decoder layer„ÄÇ</strong></p>
<p>DETR ÁöÑ Decoder ‰∏ªË¶ÅÊúâ‰∏§‰∏™ËæìÂÖ•Ôºö</p>
<ol>
<li><strong>Transformer Encoder ËæìÂá∫ÁöÑ Embedding ‰∏é position encoding ‰πãÂíå„ÄÇ</strong></li>
<li><strong>Object queries„ÄÇ</strong></li>
</ol>
<p>ÂÖ∂‰∏≠ÔºåEmbedding Â∞±ÊòØ‰∏äÊñáÊèêÂà∞ÁöÑ <span class="arithmatex">\((H\cdot W,b,256)\)</span> ÁöÑÁºñÁ†ÅÁü©Èòµ„ÄÇËøôÈáåÁùÄÈáçËÆ≤‰∏Ä‰∏ã Object queries„ÄÇ</p>
<p>Object queries ÊòØ‰∏Ä‰∏™Áª¥Â∫¶‰∏∫ <span class="arithmatex">\((100,b,256)\)</span> Áª¥ÁöÑÂº†ÈáèÔºåÊï∞ÂÄºÁ±ªÂûãÊòØ nn.EmbeddingÔºåËØ¥ÊòéËøô‰∏™Âº†ÈáèÊòØÂèØ‰ª•Â≠¶‰π†ÁöÑÔºåÂç≥ÔºöÊàë‰ª¨ÁöÑ Object queries ÊòØÂèØÂ≠¶‰π†ÁöÑ„ÄÇObject queries Áü©ÈòµÂÜÖÈÉ®ÈÄöËøáÂ≠¶‰π†Âª∫Ê®°‰∫Ü 100 ‰∏™Áâ©‰Ωì‰πãÈó¥ÁöÑÂÖ®Â±ÄÂÖ≥Á≥ªÔºå‰æãÂ¶ÇÊàøÈó¥ÈáåÈù¢ÁöÑÊ°åÂ≠êÊóÅËæπ (A Á±ª) ‰∏ÄËà¨ÊòØÊîæÊ§ÖÂ≠ê(B Á±ª)ÔºåËÄå‰∏ç‰ºöÊòØÊîæ‰∏ÄÂ§¥Â§ßË±°(C Á±ª)ÔºåÈÇ£‰πàÂú®Êé®ÁêÜÊó∂ÂÄôÂ∞±ÂèØ‰ª•Âà©Áî®ËØ•ÂÖ®Â±ÄÊ≥®ÊÑèÂäõÊõ¥Â•ΩÁöÑËøõË°åËß£Á†ÅÈ¢ÑÊµãËæìÂá∫„ÄÇ</p>
<p>Decoder ÁöÑËæìÂÖ•‰∏ÄÂºÄÂßã‰πüÂàùÂßãÂåñÊàêÁª¥Â∫¶‰∏∫ <span class="arithmatex">\((100,b,256)\)</span> Áª¥ÁöÑÂÖ®ÈÉ®ÂÖÉÁ¥†ÈÉΩ‰∏∫ 0 ÁöÑÂº†ÈáèÔºåÂíå Object queries Âä†Âú®‰∏ÄËµ∑‰πãÂêé<strong>ÂÖÖÂΩìÁ¨¨ 1 ‰∏™ multi-head self-attention ÁöÑ Query Âíå Key„ÄÇÁ¨¨‰∏Ä‰∏™ multi-head self-attention ÁöÑ Value ‰∏∫ Decoder ÁöÑËæìÂÖ•</strong>Ôºå‰πüÂ∞±ÊòØÂÖ® 0 ÁöÑÂº†Èáè„ÄÇ</p>
<p>Âà∞‰∫ÜÊØè‰∏™ Decoder ÁöÑÁ¨¨ 2 ‰∏™ multi-head self-attentionÔºåÂÆÉÁöÑ Key Âíå Value Êù•Ëá™ Encoder ÁöÑËæìÂá∫Âº†ÈáèÔºåÁª¥Â∫¶‰∏∫ <span class="arithmatex">\((hw,b,256)\)</span> ÔºåÂÖ∂‰∏≠ Key ÂÄºËøòËøõË°å‰ΩçÁΩÆÁºñÁ†Å„ÄÇQuery ÂÄº‰∏ÄÈÉ®ÂàÜÊù•Ëá™Á¨¨ 1 ‰∏™ Add and Norm ÁöÑËæìÂá∫ÔºåÁª¥Â∫¶‰∏∫ <span class="arithmatex">\((100,b,256)\)</span> ÁöÑÂº†ÈáèÔºåÂè¶‰∏ÄÈÉ®ÂàÜÊù•Ëá™ Object queriesÔºåÂÖÖÂΩìÂèØÂ≠¶‰π†ÁöÑ‰ΩçÁΩÆÁºñÁ†Å„ÄÇÊâÄ‰ª•ÔºåÁ¨¨ 2 ‰∏™ multi-head self-attention ÁöÑ Key Âíå Value ÁöÑÁª¥Â∫¶‰∏∫ <span class="arithmatex">\((hw,b,256)\)</span> ÔºåËÄå Query ÁöÑÁª¥Â∫¶‰∏∫<span class="arithmatex">\((100,b,256)\)</span>„ÄÇ</p>
<p>ÊØè‰∏™ Decoder ÁöÑËæìÂá∫Áª¥Â∫¶‰∏∫ <span class="arithmatex">\((1,b,100,256)\)</span> ÔºåÈÄÅÂÖ•ÂêéÈù¢ÁöÑÂâçÈ¶àÁΩëÁªúÔºåÂÖ∑‰ΩìÁöÑÂèòÈáèÁª¥Â∫¶ÁöÑÂèòÂåñËßÅÂõæ 30„ÄÇ</p>
<p>Âà∞ËøôÈáå‰Ω†‰ºöÂèëÁé∞ÔºöObject queries ÂÖÖÂΩìÁöÑÂÖ∂ÂÆûÊòØ‰ΩçÁΩÆÁºñÁ†ÅÁöÑ‰ΩúÁî®ÔºåÂè™‰∏çËøáÂÆÉÊòØÂèØ‰ª•Â≠¶‰π†ÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºåÊâÄ‰ª•ÔºåÊàë‰ª¨ÂØπ Encoder Âíå Decoder ÁöÑÊØè‰∏™ self-attention ÁöÑ Query Âíå Key ÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÂÅö‰∏™ÂΩíÁ∫≥ÔºåÂ¶ÇÂõæ 35 ÊâÄÁ§∫ÔºåValue Ê≤°Êúâ‰ΩçÁΩÆÁºñÁ†ÅÔºö</p>
<p><img alt="" src="https://pic1.zhimg.com/v2-6b9de32f5e1174eb3ecfecc2f0335d48_r.jpg" /></p>
<p><span class="arithmatex">\(\color{indianred}{\text{ÊçüÂ§±ÂáΩÊï∞ÈÉ®ÂàÜËß£ËØª:}}\)</span></p>
<p>ÂæóÂà∞‰∫Ü Decoder ÁöÑËæìÂá∫‰ª•ÂêéÔºåÂ¶ÇÂâçÊñáÊâÄËø∞ÔºåÂ∫îËØ•ÊòØËæìÂá∫Áª¥Â∫¶‰∏∫ <span class="arithmatex">\((b,100,256)\)</span> ÁöÑÂº†Èáè„ÄÇÊé•‰∏ãÊù•Ë¶ÅÈÄÅÂÖ• 2 ‰∏™ÂâçÈ¶àÁΩëÁªú FFN ÂæóÂà∞ class Âíå Bounding Box„ÄÇÂÆÉ‰ª¨‰ºöÂæóÂà∞ <span class="arithmatex">\(N=100\)</span> ‰∏™È¢ÑÊµãÁõÆÊ†áÔºåÂåÖÂê´Á±ªÂà´Âíå Bounding BoxÔºåÂΩìÁÑ∂Ëøô‰∏™ 100 ËÇØÂÆöÊòØÂ§ß‰∫éÂõæ‰∏≠ÁöÑÁõÆÊ†áÊÄªÊï∞ÁöÑ„ÄÇÂ¶ÇÊûú‰∏çÂ§ü 100ÔºåÂàôÈááÁî®ËÉåÊôØÂ°´ÂÖÖÔºåËÆ°ÁÆó loss Êó∂ÂÄôÂõûÂΩíÂàÜÊîØÂàÜÊîØ‰ªÖ‰ªÖËÆ°ÁÆóÊúâÁâ©‰Ωì‰ΩçÁΩÆÔºåËÉåÊôØÈõÜÂêàÂøΩÁï•„ÄÇÊâÄ‰ª•ÔºåDETR ËæìÂá∫Âº†ÈáèÁöÑÁª¥Â∫¶‰∏∫ËæìÂá∫ÁöÑÂº†ÈáèÁöÑÁª¥Â∫¶ÊòØ <span class="arithmatex">\((b,100,\color{crimson}{\text{class}+1})\)</span> Âíå <span class="arithmatex">\((b,100,\color{purple}{4})\)</span>„ÄÇÂØπÂ∫î COCO Êï∞ÊçÆÈõÜÊù•ËØ¥Ôºå <span class="arithmatex">\(\color{crimson}{\text{class}+1=92}\)</span> Ôºå <span class="arithmatex">\(\color{purple}{4}\)</span> ÊåáÁöÑÊòØÊØè‰∏™È¢ÑÊµãÁõÆÊ†áÂΩí‰∏ÄÂåñÁöÑ <span class="arithmatex">\((c_x,c_y,w,h)\)</span> „ÄÇÂΩí‰∏ÄÂåñÂ∞±ÊòØÈô§‰ª•ÂõæÁâáÂÆΩÈ´òËøõË°åÂΩí‰∏ÄÂåñ„ÄÇ</p>
<p>Âà∞ËøôÈáåÊàë‰ª¨‰∫ÜËß£‰∫Ü DETR ÁöÑÁΩëÁªúÊû∂ÊûÑÔºåÊàë‰ª¨ÂèëÁé∞ÔºåÂÆÉËæìÂá∫ÁöÑÂº†ÈáèÁöÑÁª¥Â∫¶ÊòØ <strong>ÂàÜÁ±ªÂàÜÊîØÔºö</strong><span class="arithmatex">\((b,100,\color{crimson}{\text{class}+1})\)</span> Âíå<strong>ÂõûÂΩíÂàÜÊîØÔºö</strong> <span class="arithmatex">\((b,100,\color{purple}{4})\)</span> ÔºåÂÖ∂‰∏≠ÔºåÂâçËÄÖÊòØÊåá 100 ‰∏™È¢ÑÊµãÊ°ÜÁöÑÁ±ªÂûãÔºåÂêéËÄÖÊòØÊåá 100 ‰∏™È¢ÑÊµãÊ°ÜÁöÑ Bounding BoxÔºå‰ΩÜÊòØËØªËÄÖÂèØËÉΩ‰ºöÊúâÁñëÈóÆÔºöÈ¢ÑÊµãÊ°ÜÂíåÁúüÂÄºÊòØÊÄé‰πà‰∏Ä‰∏ÄÂØπÂ∫îÁöÑÔºüÊç¢Âè•ËØùËØ¥Ôºö‰Ω†ÊÄé‰πàÁü•ÈÅìÁ¨¨ 47 ‰∏™È¢ÑÊµãÊ°ÜÂØπÂ∫îÂõæÁâáÈáåÁöÑÁãóÔºåÁ¨¨ 88 ‰∏™È¢ÑÊµãÊ°ÜÂØπÂ∫îÂõæÁâáÈáåÁöÑËΩ¶ÔºüÁ≠âÁ≠â„ÄÇ</p>
<p>Êàë‰ª¨‰∏ãÈù¢Â∞±Êù•ËÅäËÅäËøô‰∏™ÈóÆÈ¢ò„ÄÇ</p>
<p>Áõ∏ÊØî Faster R-CNN Á≠âÂÅöÊ≥ïÔºåDETR ÊúÄÂ§ßÁâπÁÇπÊòØÂ∞ÜÁõÆÊ†áÊ£ÄÊµãÈóÆÈ¢òËΩ¨Âåñ‰∏∫Êó†Â∫èÈõÜÂêàÈ¢ÑÊµãÈóÆÈ¢ò (set prediction)„ÄÇËÆ∫Êñá‰∏≠ÁâπÊÑèÊåáÂá∫ Faster R-CNN ËøôÁßçËÆæÁΩÆ‰∏ÄÂ§ßÂ†Ü anchorÔºåÁÑ∂ÂêéÂü∫‰∫é anchor ËøõË°åÂàÜÁ±ªÂíåÂõûÂΩíÂÖ∂ÂÆûÂ±û‰∫é‰ª£ÁêÜÂÅöÊ≥ïÂç≥‰∏çÊòØÊúÄÁõ¥Êé•ÂÅöÊ≥ïÔºå<strong>ÁõÆÊ†áÊ£ÄÊµã‰ªªÂä°Â∞±ÊòØËæìÂá∫Êó†Â∫èÈõÜÂêà</strong>ÔºåËÄå Faster R-CNN Á≠âÁÆóÊ≥ïÈÄöËøáÂêÑÁßçÊìç‰ΩúÔºåÂπ∂ÁªìÂêàÂ§çÊùÇÂêéÂ§ÑÁêÜÊúÄÁªàÊâçÂæóÂà∞Êó†Â∫èÈõÜÂêàÂ±û‰∫éÁªïË∑Ø‰∫ÜÔºåËÄå DETR Â∞±ÊØîËæÉÁ∫ØÁ≤π‰∫Ü„ÄÇÁé∞Âú®Ê†∏ÂøÉÈóÆÈ¢òÊù•‰∫ÜÔºöËæìÂá∫ÁöÑ <span class="arithmatex">\((b,100)\)</span> ‰∏™Ê£ÄÊµãÁªìÊûúÊòØÊó†Â∫èÁöÑÔºåÂ¶Ç‰ΩïÂíå <span class="arithmatex">\(GT \; \text{Bounding Box}\)</span> ËÆ°ÁÆó lossÔºüËøôÂ∞±ÈúÄË¶ÅÁî®Âà∞ÁªèÂÖ∏ÁöÑÂèåËæπÂåπÈÖçÁÆóÊ≥ï‰∫ÜÔºå‰πüÂ∞±ÊòØÂ∏∏ËØ¥ÁöÑÂåàÁâôÂà©ÁÆóÊ≥ïÔºåËØ•ÁÆóÊ≥ïÂπøÊ≥õÂ∫îÁî®‰∫éÊúÄ‰ºòÂàÜÈÖçÈóÆÈ¢ò„ÄÇ</p>
<p>‰∏ÄÂπÖÂõæÁâáÔºåÊàë‰ª¨ÊääÁ¨¨ <span class="arithmatex">\(i\)</span> ‰∏™Áâ©‰ΩìÁöÑÁúüÂÄºË°®Ëææ‰∏∫ <span class="arithmatex">\(y_i=(c_i,b_i)\)</span> ÔºåÂÖ∂‰∏≠Ôºå <span class="arithmatex">\(c_i\)</span> Ë°®Á§∫ÂÆÉÁöÑ <span class="arithmatex">\(\color{crimson}{\text{class}}\)</span> Ôºå <span class="arithmatex">\(b_i\)</span> Ë°®Á§∫ÂÆÉÁöÑ <span class="arithmatex">\(\color{purple}{\text{Bounding Box}}\)</span> „ÄÇÊàë‰ª¨ÂÆö‰πâ <span class="arithmatex">\(\hat y = \{\hat y_i\}_{i=1}^{N}\)</span> ‰∏∫ÁΩëÁªúËæìÂá∫ÁöÑ <span class="arithmatex">\(N\)</span> ‰∏™È¢ÑÊµãÂÄº„ÄÇ</p>
<p>ÂÅáËÆæÊàë‰ª¨Â∑≤Áªè‰∫ÜËß£‰∫Ü‰ªÄ‰πàÊòØÂåàÁâôÂà©ÁÆóÊ≥ï (ÂÖàÂÅáË£Ö‰∫ÜËß£‰∫Ü)ÔºåÂØπ‰∫éÁ¨¨ <span class="arithmatex">\(i\)</span> ‰∏™ <span class="arithmatex">\(GT\)</span> Ôºå <span class="arithmatex">\(\sigma(i)\)</span> ‰∏∫ÂåàÁâôÂà©ÁÆóÊ≥ïÂæóÂà∞ÁöÑ‰∏é <span class="arithmatex">\(GT_i\)</span> ÂØπÂ∫îÁöÑ prediction ÁöÑÁ¥¢Âºï„ÄÇÊàë‰∏æ‰∏™Ê†óÂ≠êÔºåÊØîÂ¶Ç <span class="arithmatex">\(i=3,\sigma(i)=18\)</span> ÔºåÊÑèÊÄùÂ∞±ÊòØÔºö‰∏éÁ¨¨ 3 ‰∏™ÁúüÂÄºÂØπÂ∫îÁöÑÈ¢ÑÊµãÂÄºÊòØÁ¨¨ 18 ‰∏™„ÄÇ</p>
<p>ÈÇ£ÊàëËÉΩÊ†πÊçÆ <span class="arithmatex">\(\color{green}{\text{ÂåàÁâôÂà©ÁÆóÊ≥ï}}\)</span> ÔºåÊâæÂà∞ <span class="arithmatex">\(\color{green}{\text{‰∏éÊØè‰∏™ÁúüÂÄºÂØπÂ∫îÁöÑÈ¢ÑÊµãÂÄºÊòØÂì™‰∏™}}\)</span> Ôºå<strong>ÈÇ£Á©∂Á´üÊòØÂ¶Ç‰ΩïÊâæÂà∞Âë¢Ôºü</strong></p>
<div class="arithmatex">\[\begin{equation} \label{eq:matching} \hat{\sigma} = \arg\min_{\sigma\in\Sigma_N} \sum_{i}^{N} L_{match}(y_i, \hat y_{\sigma(i)}), \end{equation} \tag{12}\]</div>
<p>Êàë‰ª¨ÁúãÁúãËøô‰∏™Ë°®ËææÂºèÊòØÁîö‰πàÊÑèÊÄùÔºåÂØπ‰∫éÊüê‰∏Ä‰∏™ÁúüÂÄº <span class="arithmatex">\(y_i\)</span> ÔºåÂÅáËÆæÊàë‰ª¨Â∑≤ÁªèÊâæÂà∞Ëøô‰∏™ÁúüÂÄºÂØπÂ∫îÁöÑÈ¢ÑÊµãÂÄº <span class="arithmatex">\(\hat y_{\sigma(i)}\)</span> ÔºåËøôÈáåÁöÑ <span class="arithmatex">\(\Sigma_N\)</span> ÊòØÊâÄÊúâÂèØËÉΩÁöÑÊéíÂàóÔºå‰ª£Ë°®<strong>‰ªéÁúüÂÄºÁ¥¢ÂºïÂà∞È¢ÑÊµãÂÄºÁ¥¢ÂºïÁöÑÊâÄÊúâÁöÑÊò†Â∞Ñ</strong>ÔºåÁÑ∂ÂêéÁî® <span class="arithmatex">\(L_{match}\)</span> ÊúÄÂ∞èÂåñ <span class="arithmatex">\(y_i\)</span> Âíå <span class="arithmatex">\(\hat y_{\sigma(i)}\)</span> ÁöÑË∑ùÁ¶ª„ÄÇËøô‰∏™ <span class="arithmatex">\(L_{match}\)</span> ÂÖ∑‰ΩìÊòØÔºö</p>
<div class="arithmatex">\[-\mathbb{1}_{\left\{ c_i\neq\varnothing \right\}}\hat p_{\sigma(i)}(c_i) + \mathbb{1}_{\left\{ c_i\neq\varnothing \right\}} L_{box}({b_{i}, \hat b_{\sigma(i)}}) \tag{13}\]</div>
<p>ÊÑèÊÄùÊòØÔºöÂÅáËÆæÂΩìÂâç‰ªéÁúüÂÄºÁ¥¢ÂºïÂà∞È¢ÑÊµãÂÄºÁ¥¢ÂºïÁöÑÊâÄÊúâÁöÑÊò†Â∞Ñ‰∏∫ <span class="arithmatex">\(\sigma\)</span> ÔºåÂØπ‰∫éÂõæÁâá‰∏≠ÁöÑÊØè‰∏™ÁúüÂÄº <span class="arithmatex">\(i\)</span> ÔºåÂÖàÊâæÂà∞ÂØπÂ∫îÁöÑÈ¢ÑÊµãÂÄº <span class="arithmatex">\(\sigma(i)\)</span> ÔºåÂÜçÁúãÁúãÂàÜÁ±ªÁΩëÁªúÁöÑÁªìÊûú <span class="arithmatex">\(\hat p_{\sigma(i)}(c_i)\)</span> ÔºåÂèñÂèç‰Ωú‰∏∫ <span class="arithmatex">\(L_{match}\)</span> ÁöÑÁ¨¨ 1 ÈÉ®ÂàÜ„ÄÇÂÜçËÆ°ÁÆóÂõûÂΩíÁΩëÁªúÁöÑÁªìÊûú <span class="arithmatex">\(\hat b_{\sigma(i)}\)</span> ‰∏éÁúüÂÄºÁöÑ <span class="arithmatex">\(\color{purple}{\text{Bounding Box}}\)</span> ÁöÑÂ∑ÆÂºÇÔºåÂç≥ <span class="arithmatex">\(L_{box}({b_{i}, \hat b_{\sigma(i)}})\)</span> Ôºå‰Ωú‰∏∫ <span class="arithmatex">\(L_{match}\)</span> ÁöÑÁ¨¨ 2 ÈÉ®ÂàÜ„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåÂèØ‰ª•‰ΩøÂæó <span class="arithmatex">\(L_{match}\)</span> ÊúÄÂ∞èÁöÑÊéíÂàó <span class="arithmatex">\(\hat\sigma\)</span> Â∞±ÊòØÊàë‰ª¨Ë¶ÅÊâæÁöÑÊéíÂàóÔºå<strong>Âç≥ÔºöÂØπ‰∫éÂõæÁâá‰∏≠ÁöÑÊØè‰∏™ÁúüÂÄº <span class="arithmatex">\(i\)</span> Êù•ËÆ≤Ôºå <span class="arithmatex">\(\hat\sigma(i)\)</span> Â∞±ÊòØËøô‰∏™ÁúüÂÄºÊâÄÂØπÂ∫îÁöÑÈ¢ÑÊµãÂÄºÁöÑÁ¥¢Âºï„ÄÇ</strong></p>
<p>ËØ∑ËØªËÄÖÁªÜÂìÅËøô‰∏™ ÂØªÊâæÂåπÈÖçÁöÑËøáÁ®ã ÔºåËøôÂ∞±ÊòØÂåàÁâôÂà©ÁÆóÊ≥ïÁöÑËøáÁ®ã„ÄÇÊòØ‰∏çÊòØ‰∏é Anchor Êàñ Proposal ÊúâÂºÇÊõ≤ÂêåÂ∑•ÁöÑÂú∞ÊñπÔºåÂè™ÊòØÊ≠§Êó∂Êàë‰ª¨ÊâæÁöÑÊòØ‰∏ÄÂØπ‰∏ÄÂåπÈÖç„ÄÇ</p>
<p>Êé•‰∏ãÊù•Â∞±ÊòØ‰ΩøÁî®‰∏ä‰∏ÄÊ≠•ÂæóÂà∞ÁöÑÊéíÂàó <span class="arithmatex">\(\hat\sigma\)</span> ÔºåËÆ°ÁÆóÂåàÁâôÂà©ÊçüÂ§±Ôºö</p>
<div class="arithmatex">\[L_{\text{Hungarian}}({y, \hat y}) = \sum_{i=1}^N \left[-\log \hat p_{\hat{\sigma}(i)}(c_{i}) + \mathbb{1}_{\left\{ c_i\neq\varnothing \right\}} \ L_{box}{(b_{i}, \hat b_{\hat{\sigma}(i)}})\right] \tag{14}\]</div>
<p>Âºè‰∏≠ÁöÑ <span class="arithmatex">\(L_{box}\)</span> ÂÖ∑‰Ωì‰∏∫Ôºö</p>
<div class="arithmatex">\[L_{box}{(b_{i}, \hat b_{\hat{\sigma}(i)}}) = \lambda_{\rm iou}L_{iou}({b_{i}, \hat b_{\sigma(i)}})+ \lambda_{\rm L1}||b_{i}- \hat b_{\sigma(i)}||_1 ,\; where \;\lambda_{\rm iou}, \lambda_{\rm L1}\in R \tag{15}\]</div>
<p>ÊúÄÂ∏∏Áî®ÁöÑ <span class="arithmatex">\(L_1 \;loss\)</span> ÂØπ‰∫éÂ§ßÂ∞è <span class="arithmatex">\(\color{purple}{\text{Bounding Box}}\)</span> ‰ºöÊúâ‰∏çÂêåÁöÑÊ†áÂ∫¶ÔºåÂç≥‰ΩøÂÆÉ‰ª¨ÁöÑÁõ∏ÂØπËØØÂ∑ÆÊòØÁõ∏‰ººÁöÑ„ÄÇ‰∏∫‰∫ÜÁºìËß£Ëøô‰∏™ÈóÆÈ¢òÔºå‰ΩúËÄÖ‰ΩøÁî®‰∫Ü <span class="arithmatex">\(L_1 \;loss\)</span> ÂíåÂπø‰πâ IoU ÊçüËÄó <span class="arithmatex">\(L_{iou}\)</span> ÁöÑÁ∫øÊÄßÁªÑÂêàÔºåÂÆÉÊòØÊØî‰æã‰∏çÂèòÁöÑ„ÄÇ</p>
<p>Hungarian ÊÑèÊÄùÂ∞±ÊòØÂåàÁâôÂà©Ôºå‰πüÂ∞±ÊòØÂâçÈù¢ÁöÑ <span class="arithmatex">\(L_{match}\)</span> Ôºå‰∏äËø∞ÊÑèÊÄùÊòØÈúÄË¶ÅËÆ°ÁÆó <span class="arithmatex">\(M\)</span> ‰∏™ <span class="arithmatex">\(\text{GT}\;\color{purple}{\text{Bounding Box}}\)</span> Âíå <span class="arithmatex">\(N\)</span> ‰∏™ËæìÈ¢ÑÊµãÂá∫ÈõÜÂêà‰∏§‰∏§‰πãÈó¥ÁöÑÂπø‰πâË∑ùÁ¶ªÔºå<strong>Ë∑ùÁ¶ªË∂äËøëË°®Á§∫Ë∂äÂèØËÉΩÊòØÊúÄ‰ºòÂåπÈÖçÂÖ≥Á≥ª</strong>Ôºå‰πüÂ∞±ÊòØ‰∏§ËÄÖÊúÄÂØÜÂàá„ÄÇÂπø‰πâË∑ùÁ¶ªÁöÑËÆ°ÁÆóËÄÉËôë‰∫ÜÂàÜÁ±ªÂàÜÊîØÂíåÂõûÂΩíÂàÜÊîØ„ÄÇ</p>
<p><strong>ÊúÄÂêéÔºåÂÜçÊ¶ÇÊã¨‰∏Ä‰∏ã DETR ÁöÑ End-to-End ÁöÑÂéüÁêÜÔºåÂâçÈù¢ÈÇ£‰πàÂ§öÊÆµËØùÂ∞±ÊòØ‰∏∫‰∫ÜËÆ≤ÊòéÁôΩËøô‰∏™‰∫ãÊÉÖÔºåÂ¶ÇÊûú‰Ω†ÂØπÂâçÈù¢ÁöÑËÆ∫Ëø∞ËøòÂ≠òÂú®ÁñëÈóÆÁöÑËØùÔºåÊää‰∏ãÈù¢‰∏ÄÁõ¥Âà∞ Experiments ‰πãÂâçÁöÑËøôÊÆµËØùÁúãÊáÇÂ∞±ËÉΩËß£ÂÜ≥‰Ω†ÁöÑÂõ∞ÊÉë„ÄÇ</strong></p>
<p><strong>DETR ÊòØÊÄé‰πàËÆ≠ÁªÉÁöÑÔºü</strong></p>
<p>ËÆ≠ÁªÉÈõÜÈáåÈù¢ÁöÑ‰ªª‰Ωï‰∏ÄÂº†ÂõæÁâáÔºåÂÅáËÆæÁ¨¨ 1 Âº†ÂõæÁâáÔºåÊàë‰ª¨ÈÄöËøáÊ®°Âûã‰∫ßÁîü 100 ‰∏™È¢ÑÊµãÊ°Ü <span class="arithmatex">\(\text{Predict}\;\color{purple}{\text{Bounding Box}}\)</span> ÔºåÂÅáËÆæËøôÂº†ÂõæÁâáÊúâÂè™ 3 ‰∏™ <span class="arithmatex">\(\text{GT}\;\color{purple}{\text{Bounding Box}}\)</span> ÔºåÂÆÉ‰ª¨ÂàÜÂà´ÊòØ <span class="arithmatex">\(\color{orange}{\text{Car}},\color{green}{\text{Dog}},\color{darkturquoise}{\text{Horse}}\)</span> „ÄÇ</p>
<div class="arithmatex">\[(\text{label}_{\color{orange}{\text{Car}}}=3,\text{label}_{\color{green}{\text{Dog}}}=24,\text{label}_{\color{orange}{\color{darkturquoise}{\text{Horse}}}}=75)\\\]</div>
<p>ÈóÆÈ¢òÊòØÔºöÊàëÊÄé‰πàÁü•ÈÅìËøô 100 ‰∏™È¢ÑÊµãÊ°ÜÂì™‰∏™ÊòØÂØπÂ∫î <span class="arithmatex">\(\color{orange}{\text{Car}}\)</span> ÔºåÂì™‰∏™ÊòØÂØπÂ∫î <span class="arithmatex">\(\color{green}{\text{Dog}}\)</span> ÔºåÂì™‰∏™ÊòØÂØπÂ∫î <span class="arithmatex">\(\color{darkturquoise}{\text{Horse}}\)</span> Ôºü</p>
<p>Êàë‰ª¨Âª∫Á´ã‰∏Ä‰∏™ <span class="arithmatex">\((100,3)\)</span> ÁöÑÁü©ÈòµÔºåÁü©ÈòµÈáåÈù¢ÁöÑÂÖÉÁ¥†Â∞±ÊòØ <span class="arithmatex">\((13)\)</span> ÂºèÁöÑËÆ°ÁÆóÁªìÊûúÔºå‰∏æ‰∏™‰æãÂ≠êÔºöÊØîÂ¶ÇÂ∑¶‰∏äËßíÁöÑ <span class="arithmatex">\((1,1)\)</span> Âè∑ÂÖÉÁ¥†ÁöÑÂê´‰πâÊòØÔºöÁ¨¨ 1 ‰∏™È¢ÑÊµãÊ°ÜÂØπÂ∫î <span class="arithmatex">\(\color{orange}{\text{Car}}(\text{label}=3)\)</span> ÁöÑÊÉÖÂÜµ‰∏ãÁöÑ <span class="arithmatex">\(L_{match}\)</span> ÂÄº„ÄÇÊàë‰ª¨Áî® <strong>scipy.optimize</strong> Ëøô‰∏™Â∫ì‰∏≠ÁöÑ <strong>linear_sum_assignment</strong> ÂáΩÊï∞ÊâæÂà∞ÊúÄ‰ºòÁöÑÂåπÈÖçÔºåËøô‰∏™ËøáÁ®ãÊàë‰ª¨Áß∞‰πã‰∏∫Ôºö<strong>"ÂåàÁâôÂà©ÁÆóÊ≥ï (Hungarian Algorithm)"</strong>„ÄÇ</p>
<p>ÂÅáËÆæ <strong>linear_sum_assignment</strong> ÂÅöÂÆå‰ª•ÂêéÁöÑÁªìÊûúÊòØÔºöÁ¨¨ <span class="arithmatex">\(23\)</span> ‰∏™È¢ÑÊµãÊ°ÜÂØπÂ∫î <span class="arithmatex">\(\color{orange}{\text{Car}}\)</span> ÔºåÁ¨¨ <span class="arithmatex">\(44\)</span> ‰∏™È¢ÑÊµãÊ°ÜÂØπÂ∫î <span class="arithmatex">\(\color{green}{\text{Dog}}\)</span> ÔºåÁ¨¨ <span class="arithmatex">\(95\)</span> ‰∏™È¢ÑÊµãÊ°ÜÂØπÂ∫î <span class="arithmatex">\(\color{darkturquoise}{\text{Horse}}\)</span> „ÄÇ</p>
<p>Áé∞Âú®ÊääÁ¨¨ <span class="arithmatex">\(23,44,95\)</span> ‰∏™È¢ÑÊµãÊ°ÜÊåëÂá∫Êù•ÔºåÊåâÁÖß <span class="arithmatex">\((14)\)</span> ÂºèËÆ°ÁÆó LossÔºåÂæóÂà∞Ëøô‰∏™ÂõæÁâáÁöÑ Loss„ÄÇ</p>
<p>ÊääÊâÄÊúâÁöÑÂõæÁâáÊåâÁÖßËøô‰∏™Ê®°ÂºèÂéªËÆ≠ÁªÉÊ®°Âûã„ÄÇ</p>
<p><strong>ËÆ≠ÁªÉÂÆå‰ª•ÂêéÊÄé‰πàÁî®Ôºü</strong></p>
<p>ËÆ≠ÁªÉÂÆå‰ª•ÂêéÔºå‰Ω†ÁöÑÊ®°ÂûãÂ≠¶‰π†Âà∞‰∫Ü‰∏ÄÁßçËÉΩÂäõÔºåÂç≥ÔºöÊ®°Âûã‰∫ßÁîüÁöÑ 100 ‰∏™È¢ÑÊµãÊ°ÜÔºåÂÆÉÁü•ÈÅìÊüê‰∏™È¢ÑÊµãÊ°ÜËØ•ÂØπÂ∫î‰ªÄ‰πà <span class="arithmatex">\(\text{Object}\)</span> ÔºåÊØîÂ¶ÇÔºåÊ®°ÂûãÂ≠¶‰π†Âà∞ÔºöÁ¨¨ 1 ‰∏™ <span class="arithmatex">\(\text{Predict}\;\color{purple}{\text{Bounding Box}}\)</span> ÂØπÂ∫î <span class="arithmatex">\(\color{orange}{\text{Car}}(\text{label}=3)\)</span> ÔºåÁ¨¨ 2 ‰∏™ <span class="arithmatex">\(\text{Predict}\;\color{purple}{\text{Bounding Box}}\)</span> ÂØπÂ∫î <span class="arithmatex">\(\color{chocolate}{\text{Bus}}(\text{label}=16)\)</span> ÔºåÁ¨¨ 3 ‰∏™ <span class="arithmatex">\(\text{Predict}\;\color{purple}{\text{Bounding Box}}\)</span> ÂØπÂ∫î <span class="arithmatex">\(\color{lightskyblue}{\text{Sky}}(\text{label}=21)\)</span> ÔºåÁ¨¨ 4 ‰∏™ <span class="arithmatex">\(\text{Predict}\;\color{purple}{\text{Bounding Box}}\)</span> ÂØπÂ∫î <span class="arithmatex">\(\color{green}{\text{Dog}}(\text{label}=24)\)</span> ÔºåÁ¨¨ 5 ‰∏™ <span class="arithmatex">\(\text{Predict}\;\color{purple}{\text{Bounding Box}}\)</span> ÂØπÂ∫î <span class="arithmatex">\(\color{darkturquoise}{\text{Horse}}(\text{label}=75)\)</span> ÔºåÁ¨¨ 6-100 ‰∏™ <span class="arithmatex">\(\text{Predict}\;\color{purple}{\text{Bounding Box}}\)</span> ÂØπÂ∫î <span class="arithmatex">\(\color{dimgray}{\varnothing }(\text{label}=92)\)</span> ÔºåÁ≠âÁ≠â„ÄÇ</p>
<p>‰ª•‰∏äÂè™ÊòØÊàë‰∏æÁöÑ‰∏Ä‰∏™‰æãÂ≠êÔºåÊÑèÊÄùÊòØËØ¥ÔºöÊ®°ÂûãÁü•ÈÅì‰∫ÜËá™Â∑±ÁöÑ 100 ‰∏™È¢ÑÊµãÊ°ÜÊØè‰∏™ËØ•ÂÅö‰ªÄ‰πà‰∫ãÊÉÖÔºåÂç≥ÔºöÊØè‰∏™Ê°ÜËØ•È¢ÑÊµã‰ªÄ‰πàÊ†∑ÁöÑ <span class="arithmatex">\(\text{Object}\)</span> „ÄÇ</p>
<p><strong>‰∏∫‰ªÄ‰πàËÆ≠ÁªÉÂÆå‰ª•ÂêéÔºåÊ®°ÂûãÂ≠¶‰π†Âà∞‰∫Ü‰∏ÄÁßçËÉΩÂäõÔºåÂç≥ÔºöÊ®°Âûã‰∫ßÁîüÁöÑ 100 ‰∏™È¢ÑÊµãÊ°ÜÔºåÂÆÉÁü•ÈÅìÊüê‰∏™È¢ÑÊµãÊ°ÜËØ•ÂØπÂ∫î‰ªÄ‰πà <span class="arithmatex">\(\text{Object}\)</span> Ôºü</strong></p>
<p>ËøòËÆ∞ÂæóÂâçÈù¢ËØ¥ÁöÑ Object queries ÂêóÔºüÂÆÉÊòØ‰∏Ä‰∏™Áª¥Â∫¶‰∏∫ <span class="arithmatex">\((100,b,256)\)</span> Áª¥ÁöÑÂº†ÈáèÔºåÂàùÂßãÊó∂ÂÖÉÁ¥†ÂÖ®‰∏∫ <span class="arithmatex">\(0\)</span> „ÄÇÂÆûÁé∞ÊñπÂºèÊòØ <strong>nn.Embedding(num_queries, hidden_dim)</strong>ÔºåËøôÈáå num_queries=100Ôºåhidden_dim=256ÔºåÂÆÉÊòØÂèØËÆ≠ÁªÉÁöÑ„ÄÇËøôÈáåÁöÑ <span class="arithmatex">\(b\)</span> ÊåáÁöÑÊòØ batch sizeÔºåÊàë‰ª¨ËÄÉËôëÂçïÂº†ÂõæÁâáÔºåÊâÄ‰ª•ÂÅáËÆæ Object queries ÊòØ‰∏Ä‰∏™Áª¥Â∫¶‰∏∫ <span class="arithmatex">\((100,256)\)</span> Áª¥ÁöÑÂº†Èáè„ÄÇÊàë‰ª¨ËÆ≠ÁªÉÂÆåÊ®°Âûã‰ª•ÂêéÔºåËøô‰∏™Âº†ÈáèÂ∑≤ÁªèËÆ≠ÁªÉÂÆå‰∫ÜÔºåÈÇ£<strong>Ê≠§Êó∂ÁöÑ Object queries Á©∂Á´ü‰ª£Ë°®‰ªÄ‰πàÔºü</strong></p>
<p>Êàë‰ª¨ÊääÊ≠§Êó∂ÁöÑ Object queries <strong>ÁúãÊàê 100 ‰∏™Ê†ºÂ≠êÔºåÊØè‰∏™Ê†ºÂ≠êÊòØ‰∏™ 256 Áª¥ÁöÑÂêëÈáè„ÄÇ</strong>ËÆ≠ÁªÉÂÆå‰ª•ÂêéÔºåËøô 100 ‰∏™Ê†ºÂ≠êÈáåÈù¢<strong>Ê≥®ÂÖ•‰∫Ü‰∏çÂêå <span class="arithmatex">\(\text{Object}\)</span> ÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØÂíåÁ±ªÂà´‰ø°ÊÅØ</strong>„ÄÇ<strong>ÊØîÂ¶ÇÁ¨¨ 1 ‰∏™Ê†ºÂ≠êÈáåÈù¢ÁöÑËøô‰∏™ 256 Áª¥ÁöÑÂêëÈáè‰ª£Ë°®ÁùÄ <span class="arithmatex">\(\color{orange}{\text{Car}}\)</span> ËøôÁßç <span class="arithmatex">\(\text{Object}\)</span> ÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØÔºå</strong>ËøôÁßç‰ø°ÊÅØÊòØÈÄöËøáËÆ≠ÁªÉÔºåËÄÉËôë‰∫ÜÊâÄÊúâÂõæÁâáÁöÑÊüê‰∏™‰ΩçÁΩÆÈôÑËøëÁöÑ <span class="arithmatex">\(\color{orange}{\text{Car}}\)</span> ÁºñÁ†ÅÁâπÂæÅÔºåÂ±û‰∫éÂíå‰ΩçÁΩÆÊúâÂÖ≥ÁöÑÂÖ®Â±Ä <span class="arithmatex">\(\color{orange}{\text{Car}}\)</span> ÁªüËÆ°‰ø°ÊÅØ„ÄÇ</p>
<p>ÊµãËØïÊó∂ÔºåÂÅáËÆæÂõæÁâá‰∏≠Êúâ <span class="arithmatex">\(\color{orange}{\text{Car}},\color{green}{\text{Dog}},\color{darkturquoise}{\text{Horse}}\)</span> ‰∏âÁßçÁâ©‰ΩìÔºåËØ•ÂõæÁâá‰ºöËæìÂÖ•Âà∞ÁºñÁ†ÅÂô®‰∏≠ËøõË°åÁâπÂæÅÁºñÁ†ÅÔºåÂÅáËÆæÁâπÂæÅÊ≤°Êúâ‰∏¢Â§±ÔºåDecoder ÁöÑ <strong>Key</strong> Âíå <strong>Value</strong> Â∞±ÊòØÁºñÁ†ÅÂô®ËæìÂá∫ÁöÑÁºñÁ†ÅÂêëÈáè (Â¶ÇÂõæ 30 ÊâÄÁ§∫)ÔºåËÄå Query Â∞±ÊòØ Object queriesÔºåÂ∞±ÊòØÊàë‰ª¨ÁöÑ 100 ‰∏™Ê†ºÂ≠ê„ÄÇ</p>
<p><strong>Query ÂèØ‰ª•ËßÜ‰Ωú‰ª£Ë°®‰∏çÂêå <span class="arithmatex">\(\text{Object}\)</span> ÁöÑ‰ø°ÊÅØÔºåËÄå Key Âíå Value ÂèØ‰ª•ËßÜ‰Ωú‰ª£Ë°®ÂõæÂÉèÁöÑÂÖ®Â±Ä‰ø°ÊÅØ„ÄÇ</strong></p>
<p>Áé∞Âú®ÈÄöËøáÊ≥®ÊÑèÂäõÊ®°ÂùóÂ∞Ü <strong>Query</strong> Âíå <strong>Key</strong> ËÆ°ÁÆóÔºåÁÑ∂ÂêéÂä†ÊùÉ <strong>Value</strong> ÂæóÂà∞Ëß£Á†ÅÂô®ËæìÂá∫„ÄÇÂØπ‰∫éÁ¨¨ 1 ‰∏™Ê†ºÂ≠êÁöÑ <strong>Query</strong> ‰ºöÂíå <strong>Key</strong> ‰∏≠ÁöÑÊâÄÊúâÂêëÈáèËøõË°åËÆ°ÁÆóÔºåÁõÆÁöÑÊòØÊü•ÊâæÊüê‰∏™‰ΩçÁΩÆÈôÑËøëÊúâÊ≤°Êúâ <span class="arithmatex">\(\color{orange}{\text{Car}}\)</span> ÔºåÂ¶ÇÊûúÊúâÈÇ£‰πàËØ•ÁâπÂæÅÂ∞±‰ºöÂä†ÊùÉËæìÂá∫ÔºåÂØπ‰∫éÁ¨¨ 3 ‰∏™Ê†ºÂ≠êÁöÑ <strong>Query</strong> ‰ºöÂíå <strong>Key</strong> ‰∏≠ÁöÑÊâÄÊúâÂêëÈáèËøõË°åËÆ°ÁÆóÔºåÁõÆÁöÑÊòØÊü•ÊâæÊüê‰∏™‰ΩçÁΩÆÈôÑËøëÊúâÊ≤°Êúâ <span class="arithmatex">\(\color{lightskyblue}{\text{Sky}}\)</span> ÔºåÂæàÈÅóÊÜæÔºåËøô‰∏™Ê≤°ÊúâÔºåÊâÄ‰ª•ËæìÂá∫ÁöÑ‰ø°ÊÅØÈáåÈù¢Ê≤°Êúâ <span class="arithmatex">\(\color{lightskyblue}{\text{Sky}}\)</span> „ÄÇ</p>
<p>Êï¥‰∏™ËøáÁ®ãËÆ°ÁÆóÂÆåÊàêÂêéÂ∞±ÂèØ‰ª•ÊääÁºñÁ†ÅÂêëÈáè‰∏≠ÁöÑ <span class="arithmatex">\(\color{orange}{\text{Car}},\color{green}{\text{Dog}},\color{darkturquoise}{\text{Horse}}\)</span> ÁöÑÁºñÁ†ÅÂµåÂÖ•‰ø°ÊÅØÊèêÂèñÂá∫Êù•ÔºåÁÑ∂ÂêéÂêéÈù¢Êé• <span class="arithmatex">\(FFN\)</span> ËøõË°åÂàÜÁ±ªÂíåÂõûÂΩíÂ∞±ÊØîËæÉÂÆπÊòìÔºåÂõ†‰∏∫ÁâπÂæÅÂ∑≤ÁªèÂØπÈΩê‰∫Ü„ÄÇ</p>
<p>ÂèëÁé∞‰∫ÜÂêóÔºüObject queries Âú®ËÆ≠ÁªÉËøáÁ®ã‰∏≠ÂØπ‰∫é <span class="arithmatex">\(N\)</span> ‰∏™Ê†ºÂ≠ê‰ºöÂéãÁº©ÂÖ•ÂØπÂ∫îÁöÑÂíå‰ΩçÁΩÆÂíåÁ±ªÂà´Áõ∏ÂÖ≥ÁöÑÁªüËÆ°‰ø°ÊÅØÔºåÂú®ÊµãËØïÈò∂ÊÆµÂ∞±ÂèØ‰ª•Âà©Áî®ËØ• <strong>Query</strong> ÂéªÂíå<strong>Êüê‰∏™ÂõæÂÉèÁöÑÁºñÁ†ÅÁâπÂæÅ KeyÔºåValue</strong> ËÆ°ÁÆóÔºå<strong>Ëã•ÂõæÁâá‰∏≠ÂàöÂ•ΩÊúâ Query ÊÉ≥ÊâæÁöÑÁâπÂæÅÔºåÊØîÂ¶Ç</strong> <span class="arithmatex">\(\color{orange}{\text{Car}}\)</span> <strong>ÔºåÂàôËøô‰∏™ÁâπÂæÅÂ∞±ËÉΩÊèêÂèñÂá∫Êù•ÔºåÊúÄÂêéÈÄöËøá 2 ‰∏™</strong> <span class="arithmatex">\(FFN\)</span> <strong>ËøõË°åÂàÜÁ±ªÂíåÂõûÂΩí„ÄÇ</strong>ÊâÄ‰ª•ÂâçÈù¢Êâç‰ºöËØ¥ Object queries ‰ΩúÁî®ÈùûÂ∏∏Á±ª‰ºº Faster R-CNN ‰∏≠ÁöÑ anchorÔºåËøô‰∏™ anchor ÊòØÂèØÂ≠¶‰π†ÁöÑÔºåÁî±‰∫éÁª¥Â∫¶ÊØîËæÉÈ´òÔºåÊïÖÂèØ‰ª•Ë°®ÂæÅÁöÑ‰∏úË•ø‰∏∞ÂØåÔºåÂΩìÁÑ∂Áª¥Â∫¶Ë∂äÈ´òÔºåËÆ≠ÁªÉÊó∂ÈïøÂ∞±‰ºöË∂äÈïø„ÄÇ</p>
<p><strong>ËøôÂ∞±ÊòØ DETR ÁöÑ End-to-End ÁöÑÂéüÁêÜÔºåÂèØ‰ª•ÁÆÄÂçïÂΩíÁªì‰∏∫‰∏äÈù¢ÁöÑÂá†ÊÆµËØùÔºå‰Ω†ËØªÊáÇ‰∫Ü‰∏äÈù¢ÁöÑËØùÔºå‰πüÂ∞±ÊòéÁôΩ‰∫Ü DETR ‰ª•Âèä End-to-End ÁöÑ Detection Ê®°ÂûãÂéüÁêÜ„ÄÇ</strong></p>
<p><strong>ExperimentsÔºö</strong></p>
<p><strong>1. ÊÄßËÉΩÂØπÊØîÔºö</strong></p>
<p><img alt="" src="https://pic4.zhimg.com/v2-a82446719e7ebd58ac2b3680bd096b6b_r.jpg" /></p>
<p><strong>2. ÁºñÁ†ÅÂô®Â±ÇÊï∞ÂØπÊØîÂÆûÈ™åÔºö</strong></p>
<p><img alt="" src="https://pic2.zhimg.com/v2-35d68162e148aa1457e7f91d135cfdf1_r.jpg" /></p>
<p>ÂèØ‰ª•ÂèëÁé∞ÔºåÁºñÁ†ÅÂô®Â±ÇÊï∞Ë∂äÂ§öË∂äÂ•ΩÔºåÊúÄÂêéÂ∞±ÈÄâÊã© 6„ÄÇ</p>
<p>‰∏ãÂõæ 38 ‰∏∫ÊúÄÂêé‰∏Ä‰∏™ Encoder Layer ÁöÑ attention ÂèØËßÜÂåñÔºåEncoder Â∑≤ÁªèÂàÜÁ¶ª‰∫Ü instancesÔºåÁÆÄÂåñ‰∫Ü Decoder ÁöÑÂØπË±°ÊèêÂèñÂíåÂÆö‰Ωç„ÄÇ</p>
<p><img alt="" src="https://pic3.zhimg.com/v2-dffe148c6e78f7b67cf6aa5c8bbbc316_r.jpg" /></p>
<p><strong>3. Ëß£Á†ÅÂô®Â±ÇÊï∞ÂØπÊØîÂÆûÈ™åÔºö</strong></p>
<p><img alt="" src="https://pic4.zhimg.com/v2-87f7c11d6b088af0d0351e3e4808e4b7_b.jpg" /></p>
<p>ÂèØ‰ª•ÂèëÁé∞ÔºåÊÄßËÉΩÈöèÁùÄËß£Á†ÅÂô®Â±ÇÊï∞ÁöÑÂ¢ûÂä†ËÄåÊèêÂçáÔºåDETR Êú¨‰∏çÈúÄË¶Å NMSÔºå‰ΩÜÊòØ‰ΩúËÄÖ‰πüËøõË°å‰∫ÜÔºå‰∏äÂõæ‰∏≠ÁöÑ NMS Êìç‰ΩúÊòØÊåá DETR ÁöÑÊØè‰∏™Ëß£Á†ÅÂ±ÇÈÉΩÂèØ‰ª•ËæìÂÖ•Êó†Â∫èÈõÜÂêàÔºåÈÇ£‰πàÂ∞ÜÊâÄÊúâËß£Á†ÅÂô®Êó†Â∫èÈõÜÂêàÂÖ®ÈÉ®‰øùÁïôÔºåÁÑ∂ÂêéËøõË°å NMS ÂæóÂà∞ÊúÄÁªàËæìÂá∫ÔºåÂèØ‰ª•ÂèëÁé∞ÊÄßËÉΩÁ®çÂæÆÊúâÊèêÂçáÔºåÁâπÂà´ÊòØ AP50„ÄÇËøôÂèØ‰ª•ÈÄöËøá‰ª•‰∏ã‰∫ãÂÆûÊù•Ëß£ÈáäÔºöTransformer ÁöÑÂçï‰∏™ Decoder Layer ‰∏çËÉΩËÆ°ÁÆóËæìÂá∫ÂÖÉÁ¥†‰πãÈó¥ÁöÑ‰ªª‰Ωï‰∫íÁõ∏ÂÖ≥ÔºåÂõ†Ê≠§ÂÆÉÊòì‰∫éÂØπÂêå‰∏ÄÂØπË±°ËøõË°åÂ§öÊ¨°È¢ÑÊµã„ÄÇÂú®Á¨¨ 2 ‰∏™ÂíåÈöèÂêéÁöÑ Decoder Layer ‰∏≠Ôºåself-attention ÂÖÅËÆ∏Ê®°ÂûãÊäëÂà∂ÈáçÂ§çÈ¢ÑÊµã„ÄÇÊâÄ‰ª• NMS Â∏¶Êù•ÁöÑÊîπÂñÑÈöèÁùÄ Decoder Layer ÁöÑÂ¢ûÂä†ËÄåÂáèÂ∞ë„ÄÇÂú®ÊúÄÂêéÂá†Â±ÇÔºå‰ΩúËÄÖËßÇÂØüÂà∞ AP ÁöÑ‰∏Ä‰∏™Â∞èÊçüÂ§±ÔºåÂõ†‰∏∫ NMS ÈîôËØØÂú∞Âà†Èô§‰∫ÜÁúüÂÆûÁöÑ positive prediction„ÄÇ  </p>
<p><img alt="" src="https://pic1.zhimg.com/v2-6b80634bf88e496f035945ec25c40764_r.jpg" /></p>
<p>Á±ª‰ºº‰∫éÂèØËßÜÂåñÁºñÁ†ÅÂô®Ê≥®ÊÑèÂäõÔºå‰ΩúËÄÖÂú®Âõæ 40 ‰∏≠ÂèØËßÜÂåñËß£Á†ÅÂô®Ê≥®ÊÑèÂäõÔºåÁî®‰∏çÂêåÁöÑÈ¢úËâ≤ÁªôÊØè‰∏™È¢ÑÊµãÂØπË±°ÁöÑÊ≥®ÊÑèÂäõÂõæÁùÄËâ≤„ÄÇËßÇÂØüÂà∞ÔºåËß£Á†ÅÂô®ÁöÑ attention Áõ∏ÂΩìÂ±ÄÈÉ®ÔºåËøôÊÑèÂë≥ÁùÄÂÆÉ‰∏ªË¶ÅÂÖ≥Ê≥®ÂØπË±°ÁöÑÂõõËÇ¢ÔºåÂ¶ÇÂ§¥ÈÉ®ÊàñËÖøÈÉ®„ÄÇÊàë‰ª¨ÂÅáËÆæÔºåÂú®ÁºñÁ†ÅÂô®ÈÄöËøáÂÖ®Â±ÄÂÖ≥Ê≥®ÂàÜÁ¶ªÂÆû‰æã‰πãÂêéÔºå<strong>Ëß£Á†ÅÂô®Âè™ÈúÄË¶ÅÂÖ≥Ê≥®ÊûÅÁ´ØÊù•ÊèêÂèñÁ±ªÂíåÂØπË±°ËæπÁïå„ÄÇ</strong></p>
<ul>
<li><strong>3.2 DETR ‰ª£Á†ÅËß£ËØªÔºö</strong></li>
</ul>
<p><a href="https://github.com/facebookresearch/detr">https://github.com/facebookresearch/detr</a></p>
<p>ÂàÜÊûêÈÉΩÊ≥®ÈáäÂú®‰∫Ü‰ª£Á†Å‰∏≠„ÄÇ</p>
<p><strong>‰∫åÁª¥‰ΩçÁΩÆÁºñÁ†ÅÔºö</strong><br />
DETR ÁöÑ‰∫åÁª¥‰ΩçÁΩÆÁºñÁ†ÅÔºö<br />
È¶ñÂÖàÊûÑÈÄ†‰ΩçÁΩÆÁü©Èòµ x_embed Âíå y_embedÔºåËøôÈáåÁî®Âà∞‰∫Ü python ÂáΩÊï∞ cumsumÔºå‰ΩúÁî®ÊòØÂØπ‰∏Ä‰∏™Áü©ÈòµÁöÑÂÖÉÁ¥†ËøõË°åÁ¥ØÂä†ÔºåÈÇ£‰πàÁ¥ØÂä†‰ª•ÂêéÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Â∞±ÊòØÊâÄÊúâÁ¥ØÂä†ÂÖÉÁ¥†ÁöÑÂíåÔºåÁúÅÂéª‰∫ÜÊ±ÇÂíåÁöÑÊ≠•È™§ÔºåÁõ¥Êé•Áî®Ëøô‰∏™ÂíåÂÅöÂΩí‰∏ÄÂåñÔºåÂØπÂ∫î x_embed[:, :, -1:] Âíå y_embed[:, -1:, :]„ÄÇ<br />
<strong>ËøôÈáåÊàëÊÉ≥ÁùÄÈáçÂº∫Ë∞É‰∏ã‰ª£Á†Å‰∏≠‰∏Ä‰∫õÂèòÈáèÁöÑ shapeÔºåÊñπ‰æøËØªËÄÖÊéåÊè°‰ΩúËÄÖÁºñÁ®ãÁöÑÊÄùË∑ØÔºö</strong><br />
ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåtensor_list ÁöÑÁ±ªÂûãÊòØ NestedTensorÔºåÂÜÖÈÉ®Ëá™Âä®ÈôÑÂä†‰∫Ü maskÔºåÁî®‰∫éË°®Á§∫Âä®ÊÄÅ shapeÔºåÊòØ pytorch ‰∏≠ tensor Êñ∞ÁâπÊÄß <a href="https://github.com/pytorch/nestedtensor">https://github.com/pytorch/nestedtensor</a>„ÄÇÂÖ®ÊòØ false„ÄÇ<br />
xÔºö(b,c,H,W)<br />
maskÔºö(b,H,W)ÔºåÂÖ®ÊòØ False„ÄÇ<br />
not_maskÔºö(b,H,W)ÔºåÂÖ®ÊòØ True„ÄÇ<br />
È¶ñÂÖàÂá∫Áé∞ÁöÑ y_embedÔºö(b,H,W)ÔºåÂÖ∑‰ΩìÊòØ 1,1,1,1,......,2,2,2,2,......3,3,3,3,......<br />
È¶ñÂÖàÂá∫Áé∞ÁöÑ x_embedÔºö(b,H,W)ÔºåÂÖ∑‰ΩìÊòØ 1,2,3,4,......,1,2,3,4,......1,2,3,4,......<br />
self.num_pos_feats = 128<br />
È¶ñÂÖàÂá∫Áé∞ÁöÑ dim_t = [0,1,2,3,.....,127]<br />
pos_xÔºö(b,H,W,128)<br />
pos_yÔºö(b,H,W,128)<br />
flatten ÂêéÈù¢ÁöÑÊï∞Â≠óÊåáÁöÑÊòØÔºöflatten() ÊñπÊ≥ïÂ∫î‰ªéÂì™‰∏™ËΩ¥ÂºÄÂßãÂ±ïÂºÄÊìç‰Ωú„ÄÇ<br />
torch.stack((pos_x[:, :, :, 0::2].sin(), pos_x[:, :, :, 1::2].cos()), dim=4).flatten(3)<br />
pos_y = torch.stack((pos_y[:, :, :, 0::2].sin(), pos_y[:, :, :, 1::2].cos()), dim=4)<br />
Ëøô‰∏ÄÊ≠•ÊâßË°åÂÆå‰ª•ÂêéÂèòÊàê (b,H,W,2,64) ÈÄöËøá flatten()ÊñπÊ≥ï‰ªéÁ¨¨ 3 ‰∏™ËΩ¥ÂºÄÂßãÂ±ïÂπ≥ÔºåÂèò‰∏∫Ôºö(b,H,W,128)<br />
torch.cat((pos_y, pos_x), dim=3) ‰πãÂêéÂèò‰∏∫ (b,H,W,256)ÔºåÂÜçÊúÄÂêé permute ‰∏∫ (b,256ÔºåH,W)„ÄÇ<br />
PositionEmbeddingSine Á±ªÁªßÊâø nn.Module Á±ª„ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class PositionEmbeddingSine(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>    def forward(self, tensor_list: NestedTensor):
<span class="linenos" data-linenos=" 4 "></span>#ËæìÂÖ•ÊòØb,c,h,w
<span class="linenos" data-linenos=" 5 "></span>#tensor_listÁöÑÁ±ªÂûãÊòØNestedTensorÔºåÂÜÖÈÉ®Ëá™Âä®ÈôÑÂä†‰∫ÜmaskÔºå
<span class="linenos" data-linenos=" 6 "></span>#Áî®‰∫éË°®Á§∫Âä®ÊÄÅshapeÔºåÊòØpytorch‰∏≠tensorÊñ∞ÁâπÊÄßhttps://github.com/pytorch/nestedtensor
<span class="linenos" data-linenos=" 7 "></span>        x = tensor_list.tensors
<span class="linenos" data-linenos=" 8 "></span># ÈôÑÂä†ÁöÑmaskÔºåshapeÊòØb,h,w ÂÖ®ÊòØfalse
<span class="linenos" data-linenos=" 9 "></span>        mask = tensor_list.mask
<span class="linenos" data-linenos="10 "></span>        assert mask is not None
<span class="linenos" data-linenos="11 "></span>        not_mask = ~mask
<span class="linenos" data-linenos="12 "></span># Âõ†‰∏∫ÂõæÂÉèÊòØ2dÁöÑÔºåÊâÄ‰ª•‰ΩçÁΩÆÁºñÁ†Å‰πüÂàÜ‰∏∫x,yÊñπÂêë
<span class="linenos" data-linenos="13 "></span># 1 1 1 1 ..  2 2 2 2... 3 3 3...
<span class="linenos" data-linenos="14 "></span>        y_embed = not_mask.cumsum(1, dtype=torch.float32)
<span class="linenos" data-linenos="15 "></span># 1 2 3 4 ... 1 2 3 4...
<span class="linenos" data-linenos="16 "></span>        x_embed = not_mask.cumsum(2, dtype=torch.float32)
<span class="linenos" data-linenos="17 "></span>        if self.normalize:
<span class="linenos" data-linenos="18 "></span>            eps = 1e-6
<span class="linenos" data-linenos="19 "></span>            y_embed = y_embed / (y_embed[:, -1:, :] + eps) * self.scale
<span class="linenos" data-linenos="20 "></span>            x_embed = x_embed / (x_embed[:, :, -1:] + eps) * self.scale
<span class="linenos" data-linenos="21 "></span> # num_pos_feats = 128
<span class="linenos" data-linenos="22 "></span># 0~127 self.num_pos_feats=128,Âõ†‰∏∫ÂâçÈù¢ËæìÂÖ•ÂêëÈáèÊòØ256ÔºåÁºñÁ†ÅÊòØ‰∏ÄÂçäsinÔºå‰∏ÄÂçäcos
<span class="linenos" data-linenos="23 "></span>        dim_t = torch.arange(self.num_pos_feats, dtype=torch.float32, device=x.device)
<span class="linenos" data-linenos="24 "></span>        dim_t = self.temperature ** (2 * (dim_t // 2) / self.num_pos_feats)
<span class="linenos" data-linenos="25 "></span> # ËæìÂá∫shape=b,h,w,128
<span class="linenos" data-linenos="26 "></span>        pos_x = x_embed[:, :, :, None] / dim_t
<span class="linenos" data-linenos="27 "></span>        pos_y = y_embed[:, :, :, None] / dim_t
<span class="linenos" data-linenos="28 "></span>        pos_x = torch.stack((pos_x[:, :, :, 0::2].sin(), pos_x[:, :, :, 1::2].cos()), dim=4).flatten(3)
<span class="linenos" data-linenos="29 "></span>        pos_y = torch.stack((pos_y[:, :, :, 0::2].sin(), pos_y[:, :, :, 1::2].cos()), dim=4).flatten(3)
<span class="linenos" data-linenos="30 "></span>        pos = torch.cat((pos_y, pos_x), dim=3).permute(0, 3, 1, 2)
<span class="linenos" data-linenos="31 "></span># ÊØè‰∏™ÁâπÂæÅÂõæÁöÑxy‰ΩçÁΩÆÈÉΩÁºñÁ†ÅÊàê256ÁöÑÂêëÈáèÔºåÂÖ∂‰∏≠Ââç128ÊòØyÊñπÂêëÁºñÁ†ÅÔºåËÄå128ÊòØxÊñπÂêëÁºñÁ†Å
<span class="linenos" data-linenos="32 "></span>        return pos
<span class="linenos" data-linenos="33 "></span># b,n=256,h,w
</code></pre></div>
<p>‰ΩúËÄÖÂÆö‰πâ‰∫Ü‰∏ÄÁßçÊï∞ÊçÆÁªìÊûÑÔºöNestedTensorÔºåÈáåÈù¢ÊâìÂåÖÂ≠ò‰∫Ü‰∏§‰∏™ÂèòÈáèÔºöx Âíå mask„ÄÇ</p>
<p><strong>NestedTensorÔºö</strong><br />
ÈáåÈù¢ÊâìÂåÖÂ≠ò‰∫Ü‰∏§‰∏™ÂèòÈáèÔºöx Âíå mask„ÄÇ<br />
to() ÂáΩÊï∞ÔºöÊääÂèòÈáèÁßªÂà∞ GPU ‰∏≠„ÄÇ<strong>BackboneÔºö</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class BackboneBase(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>    def __init__(self, backbone: nn.Module, train_backbone: bool, num_channels: int, return_interm_layers: bool):
<span class="linenos" data-linenos=" 4 "></span>        super().__init__()
<span class="linenos" data-linenos=" 5 "></span>        for name, parameter in backbone.named_parameters():
<span class="linenos" data-linenos=" 6 "></span>            if not train_backbone or &#39;layer2&#39; not in name and &#39;layer3&#39; not in name and &#39;layer4&#39; not in name:
<span class="linenos" data-linenos=" 7 "></span>                parameter.requires_grad_(False)
<span class="linenos" data-linenos=" 8 "></span>        if return_interm_layers:
<span class="linenos" data-linenos=" 9 "></span>            return_layers = {&quot;layer1&quot;: &quot;0&quot;, &quot;layer2&quot;: &quot;1&quot;, &quot;layer3&quot;: &quot;2&quot;, &quot;layer4&quot;: &quot;3&quot;}
<span class="linenos" data-linenos="10 "></span>        else:
<span class="linenos" data-linenos="11 "></span>            return_layers = {&#39;layer4&#39;: &quot;0&quot;}
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>#‰ΩúÁî®ÁöÑÊ®°ÂûãÔºöÂÆö‰πâBackboneBaseÊó∂‰º†ÂÖ•ÁöÑnn.ModuleclassÁöÑbackboneÔºåËøîÂõûÁöÑlayerÔºöÊù•Ëá™boolÂèòÈáèreturn_interm_layers
<span class="linenos" data-linenos="14 "></span>        self.body = IntermediateLayerGetter(backbone, return_layers=return_layers)
<span class="linenos" data-linenos="15 "></span>        self.num_channels = num_channels
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span>    def forward(self, tensor_list: NestedTensor):
<span class="linenos" data-linenos="18 "></span>#BackboneBaseÁöÑËæìÂÖ•ÊòØ‰∏Ä‰∏™NestedTensor
<span class="linenos" data-linenos="19 "></span>#xs‰∏≠Èó¥Â±ÇÁöÑËæìÂá∫Ôºå
<span class="linenos" data-linenos="20 "></span>        xs = self.body(tensor_list.tensors)
<span class="linenos" data-linenos="21 "></span>        out: Dict[str, NestedTensor] = {}
<span class="linenos" data-linenos="22 "></span>        for name, x in xs.items():
<span class="linenos" data-linenos="23 "></span>            m = tensor_list.mask
<span class="linenos" data-linenos="24 "></span>            assert m is not None
<span class="linenos" data-linenos="25 "></span>#F.interpolate‰∏ä‰∏ãÈááÊ†∑ÔºåË∞ÉÊï¥maskÁöÑsize
<span class="linenos" data-linenos="26 "></span>#to(torch.bool)  ÊäämaskËΩ¨Âåñ‰∏∫BoolÂûãÂèòÈáè
<span class="linenos" data-linenos="27 "></span>            mask = F.interpolate(m[None].float(), size=x.shape[-2:]).to(torch.bool)[0]
<span class="linenos" data-linenos="28 "></span>            out[name] = NestedTensor(x, mask)
<span class="linenos" data-linenos="29 "></span>        return out
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span>class Backbone(BackboneBase):
<span class="linenos" data-linenos="32 "></span>    &quot;&quot;&quot;ResNet backbone with frozen BatchNorm.&quot;&quot;&quot;
<span class="linenos" data-linenos="33 "></span>    def __init__(self, name: str,
<span class="linenos" data-linenos="34 "></span>                 train_backbone: bool,
<span class="linenos" data-linenos="35 "></span>                 return_interm_layers: bool,
<span class="linenos" data-linenos="36 "></span>                 dilation: bool):
<span class="linenos" data-linenos="37 "></span>#Ê†πÊçÆnameÈÄâÊã©backbone, num_channels, return_interm_layersÁ≠âÔºå‰º†ÂÖ•BackboneBaseÂàùÂßãÂåñ
<span class="linenos" data-linenos="38 "></span>        backbone = getattr(torchvision.models, name)(
<span class="linenos" data-linenos="39 "></span>            replace_stride_with_dilation=[False, False, dilation],
<span class="linenos" data-linenos="40 "></span>            pretrained=is_main_process(), norm_layer=FrozenBatchNorm2d)
<span class="linenos" data-linenos="41 "></span>        num_channels = 512 if name in (&#39;resnet18&#39;, &#39;resnet34&#39;) else 2048
<span class="linenos" data-linenos="42 "></span>        super().__init__(backbone, train_backbone, num_channels, return_interm_layers)
</code></pre></div>
<p><strong>Êää Backbone Âíå‰πãÂâçÁöÑ PositionEmbeddingSine ËøûÂú®‰∏ÄËµ∑Ôºö</strong><br />
Backbone ÂÆå‰ª•ÂêéËæìÂá∫ (b,c,h,w)ÔºåÂÜçÁªèËøá PositionEmbeddingSine ËæìÂá∫ (b,H,W,256)„ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class Joiner(nn.Sequential):
<span class="linenos" data-linenos=" 2 "></span>    def __init__(self, backbone, position_embedding):
<span class="linenos" data-linenos=" 3 "></span>        super().__init__(backbone, position_embedding)
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    def forward(self, tensor_list: NestedTensor):
<span class="linenos" data-linenos=" 6 "></span>        xs = self[0](tensor_list)
<span class="linenos" data-linenos=" 7 "></span>        out: List[NestedTensor] = []
<span class="linenos" data-linenos=" 8 "></span>        pos = []
<span class="linenos" data-linenos=" 9 "></span>        for name, x in xs.items():
<span class="linenos" data-linenos="10 "></span>            out.append(x)
<span class="linenos" data-linenos="11 "></span>            # position encoding
<span class="linenos" data-linenos="12 "></span>            pos.append(self[1](x).to(x.tensors.dtype))
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>        return out, pos
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span>def build_backbone(args):
<span class="linenos" data-linenos="17 "></span>#position_embeddingÊòØ‰∏™nn.module
<span class="linenos" data-linenos="18 "></span>    position_embedding = build_position_encoding(args)
<span class="linenos" data-linenos="19 "></span>    train_backbone = args.lr_backbone &gt; 0
<span class="linenos" data-linenos="20 "></span>    return_interm_layers = args.masks
<span class="linenos" data-linenos="21 "></span>#backboneÊòØ‰∏™nn.module
<span class="linenos" data-linenos="22 "></span>    backbone = Backbone(args.backbone, train_backbone, return_interm_layers, args.dilation)
<span class="linenos" data-linenos="23 "></span>#nn.SequentialÂú®‰∏ÄËµ∑
<span class="linenos" data-linenos="24 "></span>    model = Joiner(backbone, position_embedding)
<span class="linenos" data-linenos="25 "></span>    model.num_channels = backbone.num_channels
<span class="linenos" data-linenos="26 "></span>    return model
</code></pre></div>
<p><strong>Transformer ÁöÑ‰∏Ä‰∏™ Encoder LayerÔºö</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class TransformerEncoderLayer(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>    def __init__(self, d_model, nhead, dim_feedforward=2048, dropout=0.1,
<span class="linenos" data-linenos=" 4 "></span>                 activation=&quot;relu&quot;, normalize_before=False):
<span class="linenos" data-linenos=" 5 "></span>        super().__init__()
<span class="linenos" data-linenos=" 6 "></span>        self.self_attn = nn.MultiheadAttention(d_model, nhead, dropout=dropout)
<span class="linenos" data-linenos=" 7 "></span>        # Implementation of Feedforward model
<span class="linenos" data-linenos=" 8 "></span>        self.linear1 = nn.Linear(d_model, dim_feedforward)
<span class="linenos" data-linenos=" 9 "></span>        self.dropout = nn.Dropout(dropout)
<span class="linenos" data-linenos="10 "></span>        self.linear2 = nn.Linear(dim_feedforward, d_model)
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>        self.norm1 = nn.LayerNorm(d_model)
<span class="linenos" data-linenos="13 "></span>        self.norm2 = nn.LayerNorm(d_model)
<span class="linenos" data-linenos="14 "></span>        self.dropout1 = nn.Dropout(dropout)
<span class="linenos" data-linenos="15 "></span>        self.dropout2 = nn.Dropout(dropout)
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span>        self.activation = _get_activation_fn(activation)
<span class="linenos" data-linenos="18 "></span>        self.normalize_before = normalize_before
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>    def with_pos_embed(self, tensor, pos: Optional[Tensor]):
<span class="linenos" data-linenos="21 "></span>        return tensor if pos is None else tensor + pos
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span>    def forward_post(self,
<span class="linenos" data-linenos="24 "></span>                     src,
<span class="linenos" data-linenos="25 "></span>                     src_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="26 "></span>                     src_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="27 "></span>                     pos: Optional[Tensor] = None):
<span class="linenos" data-linenos="28 "></span>    # ÂíåÊ†áÂáÜÂÅöÊ≥ïÊúâÁÇπ‰∏ç‰∏ÄÊ†∑ÔºåsrcÂä†‰∏ä‰ΩçÁΩÆÁºñÁ†ÅÂæóÂà∞qÂíåkÔºå‰ΩÜÊòØv‰æùÁÑ∂ËøòÊòØsrcÔºå
<span class="linenos" data-linenos="29 "></span>    # ‰πüÂ∞±ÊòØvÂíåqk‰∏ç‰∏ÄÊ†∑
<span class="linenos" data-linenos="30 "></span>        q = k = self.with_pos_embed(src, pos)
<span class="linenos" data-linenos="31 "></span>        src2 = self.self_attn(q, k, value=src, attn_mask=src_mask,
<span class="linenos" data-linenos="32 "></span>                              key_padding_mask=src_key_padding_mask)[0]
<span class="linenos" data-linenos="33 "></span>#Add and Norm
<span class="linenos" data-linenos="34 "></span>        src = src + self.dropout1(src2)
<span class="linenos" data-linenos="35 "></span>        src = self.norm1(src)
<span class="linenos" data-linenos="36 "></span>#FFN
<span class="linenos" data-linenos="37 "></span>        src2 = self.linear2(self.dropout(self.activation(self.linear1(src))))
<span class="linenos" data-linenos="38 "></span>#Add and Norm
<span class="linenos" data-linenos="39 "></span>        src = src + self.dropout2(src2)
<span class="linenos" data-linenos="40 "></span>        src = self.norm2(src)
<span class="linenos" data-linenos="41 "></span>        return src
<span class="linenos" data-linenos="42 "></span>
<span class="linenos" data-linenos="43 "></span>    def forward_pre(self, src,
<span class="linenos" data-linenos="44 "></span>                    src_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="45 "></span>                    src_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="46 "></span>                    pos: Optional[Tensor] = None):
<span class="linenos" data-linenos="47 "></span>        src2 = self.norm1(src)
<span class="linenos" data-linenos="48 "></span>        q = k = self.with_pos_embed(src2, pos)
<span class="linenos" data-linenos="49 "></span>        src2 = self.self_attn(q, k, value=src2, attn_mask=src_mask,
<span class="linenos" data-linenos="50 "></span>                              key_padding_mask=src_key_padding_mask)[0]
<span class="linenos" data-linenos="51 "></span>        src = src + self.dropout1(src2)
<span class="linenos" data-linenos="52 "></span>        src2 = self.norm2(src)
<span class="linenos" data-linenos="53 "></span>        src2 = self.linear2(self.dropout(self.activation(self.linear1(src2))))
<span class="linenos" data-linenos="54 "></span>        src = src + self.dropout2(src2)
<span class="linenos" data-linenos="55 "></span>        return src
<span class="linenos" data-linenos="56 "></span>
<span class="linenos" data-linenos="57 "></span>    def forward(self, src,
<span class="linenos" data-linenos="58 "></span>                src_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="59 "></span>                src_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="60 "></span>                pos: Optional[Tensor] = None):
<span class="linenos" data-linenos="61 "></span>        if self.normalize_before:
<span class="linenos" data-linenos="62 "></span>            return self.forward_pre(src, src_mask, src_key_padding_mask, pos)
<span class="linenos" data-linenos="63 "></span>        return self.forward_post(src, src_mask, src_key_padding_mask, pos)
</code></pre></div>
<p><strong>Êúâ‰∫Ü‰∏Ä‰∏™ Encoder Layer ÁöÑÂÆö‰πâÔºåÂÜçÁúã Transformer ÁöÑÊï¥‰∏™ EncoderÔºö</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class TransformerEncoder(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    def __init__(self, encoder_layer, num_layers, norm=None):
<span class="linenos" data-linenos=" 3 "></span>        super().__init__()
<span class="linenos" data-linenos=" 4 "></span>        # ÁºñÁ†ÅÂô®copy6‰ªΩ
<span class="linenos" data-linenos=" 5 "></span>        self.layers = _get_clones(encoder_layer, num_layers)
<span class="linenos" data-linenos=" 6 "></span>        self.num_layers = num_layers
<span class="linenos" data-linenos=" 7 "></span>        self.norm = norm
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    def forward(self, src,
<span class="linenos" data-linenos="10 "></span>                mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="11 "></span>                src_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="12 "></span>                pos: Optional[Tensor] = None):
<span class="linenos" data-linenos="13 "></span>        # ÂÜÖÈÉ®ÂåÖÊã¨6‰∏™ÁºñÁ†ÅÂô®ÔºåÈ°∫Â∫èËøêË°å
<span class="linenos" data-linenos="14 "></span>        # srcÊòØÂõæÂÉèÁâπÂæÅËæìÂÖ•Ôºåshape=hxw,b,256
<span class="linenos" data-linenos="15 "></span>        output = src
<span class="linenos" data-linenos="16 "></span>        for layer in self.layers:
<span class="linenos" data-linenos="17 "></span>            # Á¨¨‰∏Ä‰∏™ÁºñÁ†ÅÂô®ËæìÂÖ•Êù•Ëá™ÂõæÂÉèÁâπÂæÅÔºåÂêéÈù¢ÁöÑÁºñÁ†ÅÂô®ËæìÂÖ•Êù•Ëá™Ââç‰∏Ä‰∏™ÁºñÁ†ÅÂô®ËæìÂá∫
<span class="linenos" data-linenos="18 "></span>            output = layer(output, src_mask=mask,
<span class="linenos" data-linenos="19 "></span>                           src_key_padding_mask=src_key_padding_mask, pos=pos)
<span class="linenos" data-linenos="20 "></span>        return output
</code></pre></div>
<p><strong>Object QueriesÔºöÂèØÂ≠¶‰π†ÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºö</strong><br />
Ê≥®Èáä‰∏≠Â∑≤ÁªèÊ≥®Êòé‰∫ÜÂèòÈáèÁöÑ shape ÁöÑÂèòÂåñËøáÁ®ãÔºåÊúÄÁªàËæìÂá∫ÁöÑÊòØ‰∏é Positional Encoding Áª¥Â∫¶Áõ∏ÂêåÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÔºåÁª¥Â∫¶ÊòØ (b,H,W,256)ÔºåÂè™ÊòØÁé∞Âú®Ëøô‰∏™‰ΩçÁΩÆÁºñÁ†ÅÊòØÂèØÂ≠¶‰π†ÁöÑ‰∫Ü„ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class PositionEmbeddingLearned(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &quot;&quot;&quot;
<span class="linenos" data-linenos=" 3 "></span>    Absolute pos embedding, learned.
<span class="linenos" data-linenos=" 4 "></span>    &quot;&quot;&quot;
<span class="linenos" data-linenos=" 5 "></span>    def __init__(self, num_pos_feats=256):
<span class="linenos" data-linenos=" 6 "></span>        super().__init__()]
<span class="linenos" data-linenos=" 7 "></span>#ËøôÈáå‰ΩøÁî®‰∫Ünn.EmbeddingÔºåËøôÊòØ‰∏Ä‰∏™Áü©ÈòµÁ±ªÔºåÈáåÈù¢ÂàùÂßãÂåñ‰∫Ü‰∏Ä‰∏™ÈöèÊú∫Áü©ÈòµÔºåÁü©ÈòµÁöÑÈïøÊòØÂ≠óÂÖ∏ÁöÑÂ§ßÂ∞èÔºåÂÆΩÊòØÁî®Êù•Ë°®Á§∫Â≠óÂÖ∏‰∏≠ÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂ±ûÊÄßÂêëÈáèÔºå
<span class="linenos" data-linenos=" 8 "></span># ÂêëÈáèÁöÑÁª¥Â∫¶Ê†πÊçÆ‰Ω†ÊÉ≥Ë¶ÅË°®Á§∫ÁöÑÂÖÉÁ¥†ÁöÑÂ§çÊùÇÂ∫¶ËÄåÂÆö„ÄÇÁ±ªÂÆû‰æãÂåñ‰πãÂêéÂèØ‰ª•Ê†πÊçÆÂ≠óÂÖ∏‰∏≠ÂÖÉÁ¥†ÁöÑ‰∏ãÊ†áÊù•Êü•ÊâæÂÖÉÁ¥†ÂØπÂ∫îÁöÑÂêëÈáè„ÄÇËæìÂÖ•‰∏ãÊ†á0ÔºåËæìÂá∫Â∞±ÊòØembedsÁü©Èòµ‰∏≠Á¨¨0Ë°å„ÄÇ
<span class="linenos" data-linenos=" 9 "></span>        self.row_embed = nn.Embedding(50, num_pos_feats)
<span class="linenos" data-linenos="10 "></span>        self.col_embed = nn.Embedding(50, num_pos_feats)
<span class="linenos" data-linenos="11 "></span>        self.reset_parameters()
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>    def reset_parameters(self):
<span class="linenos" data-linenos="14 "></span>        nn.init.uniform_(self.row_embed.weight)
<span class="linenos" data-linenos="15 "></span>        nn.init.uniform_(self.col_embed.weight)
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span>#ËæìÂÖ•‰æùÊóßÊòØNestedTensor
<span class="linenos" data-linenos="18 "></span>    def forward(self, tensor_list: NestedTensor):
<span class="linenos" data-linenos="19 "></span>        x = tensor_list.tensors
<span class="linenos" data-linenos="20 "></span>        h, w = x.shape[-2:]
<span class="linenos" data-linenos="21 "></span>        i = torch.arange(w, device=x.device)
<span class="linenos" data-linenos="22 "></span>        j = torch.arange(h, device=x.device)
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span>#x_embÔºö(w, 128)
<span class="linenos" data-linenos="25 "></span>#y_embÔºö(h, 128)
<span class="linenos" data-linenos="26 "></span>        x_emb = self.col_embed(i)
<span class="linenos" data-linenos="27 "></span>        y_emb = self.row_embed(j)
<span class="linenos" data-linenos="28 "></span>        pos = torch.cat([
<span class="linenos" data-linenos="29 "></span>            x_emb.unsqueeze(0).repeat(h, 1, 1),#(1,w,128) ‚Üí (h,w,128)
<span class="linenos" data-linenos="30 "></span>            y_emb.unsqueeze(1).repeat(1, w, 1),#(h,1,128) ‚Üí (h,w,128)
<span class="linenos" data-linenos="31 "></span>        ], dim=-1).permute(2, 0, 1).unsqueeze(0).repeat(x.shape[0], 1, 1, 1)
<span class="linenos" data-linenos="32 "></span>#(h,w,256) ‚Üí (256,h,w) ‚Üí (1,256,h,w) ‚Üí (b,256,h,w)
<span class="linenos" data-linenos="33 "></span>        return pos
<span class="linenos" data-linenos="34 "></span>
<span class="linenos" data-linenos="35 "></span>def build_position_encoding(args):
<span class="linenos" data-linenos="36 "></span>    N_steps = args.hidden_dim // 2
<span class="linenos" data-linenos="37 "></span>    if args.position_embedding in (&#39;v2&#39;, &#39;sine&#39;):
<span class="linenos" data-linenos="38 "></span>        # TODO find a better way of exposing other arguments
<span class="linenos" data-linenos="39 "></span>        position_embedding = PositionEmbeddingSine(N_steps, normalize=True)
<span class="linenos" data-linenos="40 "></span>    elif args.position_embedding in (&#39;v3&#39;, &#39;learned&#39;):
<span class="linenos" data-linenos="41 "></span>        position_embedding = PositionEmbeddingLearned(N_steps)
<span class="linenos" data-linenos="42 "></span>    else:
<span class="linenos" data-linenos="43 "></span>        raise ValueError(f&quot;not supported {args.position_embedding}&quot;)
<span class="linenos" data-linenos="44 "></span>
<span class="linenos" data-linenos="45 "></span>    return position_embedding
</code></pre></div>
<p><strong>Transformer ÁöÑ‰∏Ä‰∏™ Decoder LayerÔºö</strong><br />
Ê≥®ÊÑèÂèòÈáèÁöÑÂëΩÂêçÔºö<br />
object queries(query_pos)<br />
Encoder ÁöÑ‰ΩçÁΩÆÁºñÁ†Å (pos)<br />
Encoder ÁöÑËæìÂá∫ (memory)</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>def forward_post(self, tgt, memory,
<span class="linenos" data-linenos=" 2 "></span>                     tgt_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 3 "></span>                     memory_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 4 "></span>                     tgt_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 5 "></span>                     memory_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 6 "></span>                     pos: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 7 "></span>                     query_pos: Optional[Tensor] = None):
<span class="linenos" data-linenos=" 8 "></span> #query,keyÁöÑËæìÂÖ•ÊòØobject queries(query_pos) + DecoderÁöÑËæìÂÖ•(tgt),shapeÈÉΩÊòØ(100,b,256)
<span class="linenos" data-linenos=" 9 "></span>#valueÁöÑËæìÂÖ•ÊòØDecoderÁöÑËæìÂÖ•(tgt),shape = (100,b,256)
<span class="linenos" data-linenos="10 "></span>        q = k = self.with_pos_embed(tgt, query_pos)
<span class="linenos" data-linenos="11 "></span> #Multi-head self-attention
<span class="linenos" data-linenos="12 "></span>        tgt2 = self.self_attn(q, k, value=tgt, attn_mask=tgt_mask,
<span class="linenos" data-linenos="13 "></span>                              key_padding_mask=tgt_key_padding_mask)[0]
<span class="linenos" data-linenos="14 "></span>#Add and Norm
<span class="linenos" data-linenos="15 "></span>        tgt = tgt + self.dropout1(tgt2)
<span class="linenos" data-linenos="16 "></span>        tgt = self.norm1(tgt)
<span class="linenos" data-linenos="17 "></span> #queryÁöÑËæìÂÖ•ÊòØ‰∏ä‰∏Ä‰∏™attentionÁöÑËæìÂá∫(tgt) + object queries(query_pos)
<span class="linenos" data-linenos="18 "></span>#keyÁöÑËæìÂÖ•ÊòØEncoderÁöÑ‰ΩçÁΩÆÁºñÁ†Å(pos) + EncoderÁöÑËæìÂá∫(memory)
<span class="linenos" data-linenos="19 "></span>#valueÁöÑËæìÂÖ•ÊòØEncoderÁöÑËæìÂá∫(memory)
<span class="linenos" data-linenos="20 "></span>        tgt2 = self.multihead_attn(query=self.with_pos_embed(tgt, query_pos),
<span class="linenos" data-linenos="21 "></span>                                   key=self.with_pos_embed(memory, pos),
<span class="linenos" data-linenos="22 "></span>                                   value=memory, attn_mask=memory_mask,
<span class="linenos" data-linenos="23 "></span>                                   key_padding_mask=memory_key_padding_mask)[0]
<span class="linenos" data-linenos="24 "></span> #Add and Norm
<span class="linenos" data-linenos="25 "></span>        tgt = tgt + self.dropout2(tgt2)
<span class="linenos" data-linenos="26 "></span>        tgt = self.norm2(tgt)
<span class="linenos" data-linenos="27 "></span> #FFN
<span class="linenos" data-linenos="28 "></span>        tgt2 = self.linear2(self.dropout(self.activation(self.linear1(tgt))))
<span class="linenos" data-linenos="29 "></span>        tgt = tgt + self.dropout3(tgt2)
<span class="linenos" data-linenos="30 "></span>        tgt = self.norm3(tgt)
<span class="linenos" data-linenos="31 "></span>        return tgt
<span class="linenos" data-linenos="32 "></span>
<span class="linenos" data-linenos="33 "></span>    def forward_pre(self, tgt, memory,
<span class="linenos" data-linenos="34 "></span>                    tgt_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="35 "></span>                    memory_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="36 "></span>                    tgt_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="37 "></span>                    memory_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="38 "></span>                    pos: Optional[Tensor] = None,
<span class="linenos" data-linenos="39 "></span>                    query_pos: Optional[Tensor] = None):
<span class="linenos" data-linenos="40 "></span>        tgt2 = self.norm1(tgt)
<span class="linenos" data-linenos="41 "></span>        q = k = self.with_pos_embed(tgt2, query_pos)
<span class="linenos" data-linenos="42 "></span>        tgt2 = self.self_attn(q, k, value=tgt2, attn_mask=tgt_mask,
<span class="linenos" data-linenos="43 "></span>                              key_padding_mask=tgt_key_padding_mask)[0]
<span class="linenos" data-linenos="44 "></span>        tgt = tgt + self.dropout1(tgt2)
<span class="linenos" data-linenos="45 "></span>        tgt2 = self.norm2(tgt)
<span class="linenos" data-linenos="46 "></span>        tgt2 = self.multihead_attn(query=self.with_pos_embed(tgt2, query_pos),
<span class="linenos" data-linenos="47 "></span>                                   key=self.with_pos_embed(memory, pos),
<span class="linenos" data-linenos="48 "></span>                                   value=memory, attn_mask=memory_mask,
<span class="linenos" data-linenos="49 "></span>                                   key_padding_mask=memory_key_padding_mask)[0]
<span class="linenos" data-linenos="50 "></span>        tgt = tgt + self.dropout2(tgt2)
<span class="linenos" data-linenos="51 "></span>        tgt2 = self.norm3(tgt)
<span class="linenos" data-linenos="52 "></span>        tgt2 = self.linear2(self.dropout(self.activation(self.linear1(tgt2))))
<span class="linenos" data-linenos="53 "></span>        tgt = tgt + self.dropout3(tgt2)
<span class="linenos" data-linenos="54 "></span>        return tgt
<span class="linenos" data-linenos="55 "></span>
<span class="linenos" data-linenos="56 "></span>    def forward(self, tgt, memory,
<span class="linenos" data-linenos="57 "></span>                tgt_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="58 "></span>                memory_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="59 "></span>                tgt_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="60 "></span>                memory_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos="61 "></span>                pos: Optional[Tensor] = None,
<span class="linenos" data-linenos="62 "></span>                query_pos: Optional[Tensor] = None):
<span class="linenos" data-linenos="63 "></span>        if self.normalize_before:
<span class="linenos" data-linenos="64 "></span>            return self.forward_pre(tgt, memory, tgt_mask, memory_mask,
<span class="linenos" data-linenos="65 "></span>                                    tgt_key_padding_mask, memory_key_padding_mask, pos, query_pos)
<span class="linenos" data-linenos="66 "></span>        return self.forward_post(tgt, memory, tgt_mask, memory_mask,
<span class="linenos" data-linenos="67 "></span>                                 tgt_key_padding_mask, memory_key_padding_mask, pos, query_pos)
</code></pre></div>
<p><strong>Êúâ‰∫Ü‰∏Ä‰∏™ Decoder Layer ÁöÑÂÆö‰πâÔºåÂÜçÁúã Transformer ÁöÑÊï¥‰∏™ DecoderÔºö</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class TransformerDecoder(nn.Module):
<span class="linenos" data-linenos=" 2 "></span> #ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºöÂú®‰ΩøÁî®TransformerDecoderÊó∂ÈúÄË¶Å‰º†ÂÖ•ÁöÑÂèÇÊï∞ÊúâÔºö
<span class="linenos" data-linenos=" 3 "></span># tgtÔºöDecoderÁöÑËæìÂÖ•ÔºåmemoryÔºöEncoderÁöÑËæìÂá∫ÔºåposÔºöEncoderÁöÑ‰ΩçÁΩÆÁºñÁ†ÅÁöÑËæìÂá∫Ôºåquery_posÔºöObject QueriesÔºå‰∏ÄÂ†Ümask
<span class="linenos" data-linenos=" 4 "></span>    def forward(self, tgt, memory,
<span class="linenos" data-linenos=" 5 "></span>                tgt_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 6 "></span>                memory_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 7 "></span>                tgt_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 8 "></span>                memory_key_padding_mask: Optional[Tensor] = None,
<span class="linenos" data-linenos=" 9 "></span>                pos: Optional[Tensor] = None,
<span class="linenos" data-linenos="10 "></span>                query_pos: Optional[Tensor] = None):
<span class="linenos" data-linenos="11 "></span>        output = tgt
<span class="linenos" data-linenos="12 "></span> # DecoderËæìÂÖ•ÁöÑtgt:(100, b, 256)
<span class="linenos" data-linenos="13 "></span>        intermediate = []
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>        for layer in self.layers:
<span class="linenos" data-linenos="16 "></span>            output = layer(output, memory, tgt_mask=tgt_mask,
<span class="linenos" data-linenos="17 "></span>                           memory_mask=memory_mask,
<span class="linenos" data-linenos="18 "></span>                           tgt_key_padding_mask=tgt_key_padding_mask,
<span class="linenos" data-linenos="19 "></span>                           memory_key_padding_mask=memory_key_padding_mask,
<span class="linenos" data-linenos="20 "></span>                           pos=pos, query_pos=query_pos)
<span class="linenos" data-linenos="21 "></span>            if self.return_intermediate:
<span class="linenos" data-linenos="22 "></span>                intermediate.append(self.norm(output))
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span>        if self.norm is not None:
<span class="linenos" data-linenos="25 "></span>            output = self.norm(output)
<span class="linenos" data-linenos="26 "></span>            if self.return_intermediate:
<span class="linenos" data-linenos="27 "></span>                intermediate.pop()
<span class="linenos" data-linenos="28 "></span>                intermediate.append(output)
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span>        if self.return_intermediate:
<span class="linenos" data-linenos="31 "></span>            return torch.stack(intermediate)
<span class="linenos" data-linenos="32 "></span>
<span class="linenos" data-linenos="33 "></span>        return output.unsqueeze(0)
</code></pre></div>
<p><strong>ÁÑ∂ÂêéÊòØÊää Encoder Âíå Decoder ÊãºÂú®‰∏ÄËµ∑ÔºåÂç≥ÊÄªÁöÑ Transformer ÁªìÊûÑÁöÑÂÆûÁé∞Ôºö</strong><br />
Ê≠§Â§ÑËÄÉËôëÂà∞Â≠óÊï∞ÈôêÂà∂ÔºåÁúÅÁï•‰∫Ü‰ª£Á†Å„ÄÇ<strong>ÂÆûÁé∞‰∫Ü TransformerÔºåËøòÂâ©ÂêéÈù¢ÁöÑ FFNÔºö</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>class MLP(nn.Module):
<span class="linenos" data-linenos=" 2 "></span>    &quot;&quot;&quot; Very simple multi-layer perceptron (also called FFN)&quot;&quot;&quot;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    def __init__(self, input_dim, hidden_dim, output_dim, num_layers):
<span class="linenos" data-linenos=" 5 "></span>        super().__init__()
<span class="linenos" data-linenos=" 6 "></span>        self.num_layers = num_layers
<span class="linenos" data-linenos=" 7 "></span>        h = [hidden_dim] * (num_layers - 1)
<span class="linenos" data-linenos=" 8 "></span>        self.layers = nn.ModuleList(nn.Linear(n, k) for n, k in zip([input_dim] + h, h + [output_dim]))
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    def forward(self, x):
<span class="linenos" data-linenos="11 "></span>        for i, layer in enumerate(self.layers):
<span class="linenos" data-linenos="12 "></span>            x = F.relu(layer(x)) if i &lt; self.num_layers - 1 else layer(x)
<span class="linenos" data-linenos="13 "></span>        return x
</code></pre></div>
<p><strong>ÂåàÁâôÂà©ÂåπÈÖç HungarianMatcher Á±ªÔºö</strong><br />
<strong>Ëøô‰∏™Á±ªÁöÑÁõÆÁöÑÊòØËÆ°ÁÆó‰ªé targets Âà∞ predictions ÁöÑ‰∏ÄÁßçÊúÄ‰ºòÊéíÂàó„ÄÇ</strong><br />
predictions ÊØî targets ÁöÑÊï∞ÈáèÂ§öÔºå‰ΩÜÊàë‰ª¨Ë¶ÅËøõË°å 1-to-1 matchingÔºåÊâÄ‰ª•Â§öÁöÑ predictions Â∞Ü‰∏é <span class="arithmatex">\(\varnothing\)</span> ÂåπÈÖç„ÄÇ<br />
Ëøô‰∏™ÂáΩÊï∞Êï¥‰ΩìÂú®ÊûÑÂª∫ (13) ÂºèÔºåcost_classÔºåcost_bboxÔºåcost_giouÔºåÂØπÂ∫îÁöÑÂ∞±ÊòØ (13) Âºè‰∏≠ÁöÑÂá†‰∏™ÊçüÂ§±ÂáΩÊï∞ÔºåÂÆÉ‰ª¨ÁöÑÁª¥Â∫¶ÈÉΩÊòØ(b,100,m)„ÄÇ<br />
m ÂåÖÂê´‰∫ÜËøô‰∏™ batch ÂÜÖÈÉ®ÊâÄÊúâÁöÑ <span class="arithmatex">\(\text{GT}\;\color{purple}{\text{Bounding Box}}\)</span> „ÄÇ</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span># pred_logits:[b,100,92]
<span class="linenos" data-linenos=" 2 "></span># pred_boxes:[b,100,4]
<span class="linenos" data-linenos=" 3 "></span># targetsÊòØ‰∏™ÈïøÂ∫¶‰∏∫bÁöÑlistÔºåÂÖ∂‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÊòØ‰∏™Â≠óÂÖ∏ÔºåÂÖ±ÂåÖÂê´Ôºölabels-ÈïøÂ∫¶‰∏∫(m,)ÁöÑTensorÔºåÂÖÉÁ¥†ÊòØÊ†áÁ≠æÔºõboxes-ÈïøÂ∫¶‰∏∫(m,4)ÁöÑTensorÔºåÂÖÉÁ¥†ÊòØBounding Box„ÄÇ
<span class="linenos" data-linenos=" 4 "></span># detrÂàÜÁ±ªËæìÂá∫Ôºånum_queries=100ÔºåshapeÊòØ(b,100,92)
<span class="linenos" data-linenos=" 5 "></span>        bs, num_queries = outputs[&quot;pred_logits&quot;].shape[:2]
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>        # We flatten to compute the cost matrices in a batch
<span class="linenos" data-linenos=" 9 "></span>        out_prob = outputs[&quot;pred_logits&quot;].flatten(0, 1).softmax(-1)  # [batch_size * num_queries, num_classes] = [100b, 92]
<span class="linenos" data-linenos="10 "></span>        out_bbox = outputs[&quot;pred_boxes&quot;].flatten(0, 1)  # [batch_size * num_queries, 4] = [100b, 4]
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span># ÂáÜÂ§áÂàÜÁ±ªtarget shape=(m,)ÈáåÈù¢Â≠òÂÇ®ÁöÑÊòØÁ±ªÂà´Á¥¢ÂºïÔºåmÂåÖÊã¨‰∫ÜÊï¥‰∏™batchÂÜÖÈÉ®ÁöÑÊâÄÊúâgt bbox
<span class="linenos" data-linenos="13 "></span>        # Also concat the target labels and boxes
<span class="linenos" data-linenos="14 "></span>        tgt_ids = torch.cat([v[&quot;labels&quot;] for v in targets])# (m,)[3,6,7,9,5,9,3]
<span class="linenos" data-linenos="15 "></span># ÂáÜÂ§ábbox target shape=(m,4)ÔºåÂ∑≤ÁªèÂΩí‰∏ÄÂåñ‰∫Ü
<span class="linenos" data-linenos="16 "></span>        tgt_bbox = torch.cat([v[&quot;boxes&quot;] for v in targets])# (m,4)
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>#(100b,92)-&gt;(100b, m)ÔºåÂØπ‰∫éÊØè‰∏™È¢ÑÊµãÁªìÊûúÔºåÊääÁõÆÂâçgtÈáåÈù¢ÊúâÁöÑÊâÄÊúâÁ±ªÂà´ÂÄºÊèêÂèñÂá∫Êù•ÔºåÂÖ∂‰ΩôÂÄº‰∏çÈúÄË¶ÅÂèÇ‰∏éÂåπÈÖç
<span class="linenos" data-linenos="19 "></span>#ÂØπÂ∫î‰∏äËø∞ÂÖ¨ÂºèÔºåÁ±ª‰ºº‰∫énll lossÔºå‰ΩÜÊòØÊõ¥Âä†ÁÆÄÂçï
<span class="linenos" data-linenos="20 "></span>        # Compute the classification cost. Contrary to the loss, we don&#39;t use the NLL,
<span class="linenos" data-linenos="21 "></span>        # but approximate it in 1 - proba[target class].
<span class="linenos" data-linenos="22 "></span>        # The 1 is a constant that doesn&#39;t change the matching, it can be ommitted.
<span class="linenos" data-linenos="23 "></span>#Ë°åÔºöÂèñÊØè‰∏ÄË°åÔºõÂàóÔºöÂè™Âèñtgt_idsÂØπÂ∫îÁöÑmÂàó
<span class="linenos" data-linenos="24 "></span>        cost_class = -out_prob[:, tgt_ids]# (100b, m)
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span>        # Compute the L1 cost between boxes, ËÆ°ÁÆóout_bboxÂíåtgt_bbox‰∏§‰∏§‰πãÈó¥ÁöÑl1Ë∑ùÁ¶ª (100b, m)
<span class="linenos" data-linenos="27 "></span>        cost_bbox = torch.cdist(out_bbox, tgt_bbox, p=1)# (100b, m)
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span>        # Compute the giou cost betwen boxes, È¢ùÂ§ñÂ§öËÆ°ÁÆó‰∏Ä‰∏™giou loss (100b, m)
<span class="linenos" data-linenos="30 "></span>        cost_giou = -generalized_box_iou(box_cxcywh_to_xyxy(out_bbox), box_cxcywh_to_xyxy(tgt_bbox))
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span>#ÂæóÂà∞ÊúÄÁªàÁöÑÂπø‰πâË∑ùÁ¶ª(100b, m)ÔºåË∑ùÁ¶ªË∂äÂ∞èË∂äÂèØËÉΩÊòØÊúÄ‰ºòÂåπÈÖç
<span class="linenos" data-linenos="33 "></span>        # Final cost matrix
<span class="linenos" data-linenos="34 "></span>        C = self.cost_bbox * cost_bbox + self.cost_class * cost_class + self.cost_giou * cost_giou
<span class="linenos" data-linenos="35 "></span>#(100b, m)--&gt; (b, 100, m)
<span class="linenos" data-linenos="36 "></span>        C = C.view(bs, num_queries, -1).cpu()
<span class="linenos" data-linenos="37 "></span>
<span class="linenos" data-linenos="38 "></span>#ËÆ°ÁÆóÊØè‰∏™batchÂÜÖÈÉ®ÊúâÂ§öÂ∞ëÁâ©‰ΩìÔºåÂêéÁª≠ËÆ°ÁÆóÊó∂ÂÄôÊåâÁÖßÂçïÂº†ÂõæÁâáËøõË°åÂåπÈÖçÔºåÊ≤°ÂøÖË¶ÅbatchÁ∫ßÂà´ÂåπÈÖç,ÂæíÂ¢ûËÆ°ÁÆó
<span class="linenos" data-linenos="39 "></span>        sizes = [len(v[&quot;boxes&quot;]) for v in targets]
<span class="linenos" data-linenos="40 "></span>#ÂåàÁâôÂà©ÊúÄ‰ºòÂåπÈÖçÔºåËøîÂõûÂåπÈÖçÁ¥¢Âºï
<span class="linenos" data-linenos="41 "></span>#enumerate(C.split(sizes, -1))]Ôºö(b,100,image1,image2,image3,...)
<span class="linenos" data-linenos="42 "></span>        indices = [linear_sum_assignment(c[i]) for i, c in enumerate(C.split(sizes, -1))]   
<span class="linenos" data-linenos="43 "></span>        return [(torch.as_tensor(i, dtype=torch.int64), torch.as_tensor(j, dtype=torch.int64)) for i, j in indices]
</code></pre></div>
<p>Âú®ÂæóÂà∞ÂåπÈÖçÂÖ≥Á≥ªÂêéÁÆó loss Â∞±Ê∞¥Âà∞Ê∏†Êàê‰∫Ü„ÄÇloss_labels ËÆ°ÁÆóÂàÜÁ±ªÊçüÂ§±Ôºåloss_boxes ËÆ°ÁÆóÂõûÂΩíÊçüÂ§±ÔºåÂåÖÂê´ <span class="arithmatex">\(\text{L_1 loss, iou loss}\)</span> „ÄÇ</p>
<p><strong>‰ª£Á†Å‰∏≠ÁöÑÂÖ∂‰ªñÁªìÊûÑÔºö</strong></p>
<p><strong>SmoothedValueÔºö</strong></p>
<p>‰∏ÄÁßçËá™ÂÆö‰πâÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂ±û‰∫é object Á±ª„ÄÇÂÆÉÊòØ deque Á±ªÂûãÁöÑÂèåÂêëÈòüÂàóÔºåÈÄöËøá update(value) ËøõË°åÊõ¥Êñ∞„ÄÇ</p>
<p><strong>MetricLoggerÔºö</strong></p>
<p>‰∏ÄÁßçËá™ÂÆö‰πâÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂ±û‰∫é object Á±ª„ÄÇÂÆÉÊòØÂ≠óÂÖ∏ÔºåÈÄöËøá update(dict) ËøõË°åÊõ¥Êñ∞„ÄÇÈÄöËøá add_meter(name, meter) ÂáΩÊï∞Ê∑ªÂä†ÈîÆÂÄº„ÄÇ</p>
<p>log_every(data_loader, print_freq, header) ÊâìÂç∞‰∏Ä‰∫õ‰∏≠Èó¥ÁªìÊûú„ÄÇ</p>
<h2 id="_2">ÊÄªÁªìÔºö<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>Êú¨Êñá‰ªãÁªçÁöÑÊòØ Transformer ÁöÑÂü∫Á°ÄÔºåÂåÖÂê´‰ªÄ‰πàÊòØ AttentionÔºå‰ªÄ‰πàÊòØ TransformerÔºå‰ª•ÂèäÂú®Ê£ÄÊµã‰∏äÁöÑÂ∫îÁî®„ÄÇÂÖ∂ÂÆûÂú® DETR ‰πãÂâçÂ∑≤ÁªèÊúâ‰∫∫Â∞ùËØïËøáÊää self-attention Êú∫Âà∂ÊàñËÄÖ Transformer Â∫îÁî®Âú®ËßÜËßâ‰ªªÂä°‰∏äÈù¢Ôºå‰ΩÜÊòØÂÖ≥Ê≥®‰∏çÂ§ö„ÄÇDETR ÁöÑÂá∫Áé∞‰ΩøÂæóËøô‰∏™Ê®°ÂûãÂºÄÂßãÂπøÊ≥õÂ∫îÁî®Âú®ÂêÑÁßçËßÜËßâ‰ªªÂä°‰∏äÈù¢ÔºåÊàë‰πü‰ºöÂú®Ëøô‰∏™‰∏ìÊ†èÁöÑÂêéÁª≠Â§öÂ§öËß£ËØªËøô‰∫õÁªèÂÖ∏Â∑•‰Ωú„ÄÇ</p>
<h2 id="_3"><strong>ÂèÇËÄÉÊñáÁåÆÔºö</strong><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>codeÔºö</strong></li>
</ul>
<p><a href="https://github.com/jadore801120/attention-is-all-you-need-pytorch">https://github.com/jadore801120/attention-is-all-you-need-pytorchjadore801120/attention-is-all-you-need-pytorchhttps://github.com/jadore801120/attention-is-all-you-need-pytorch</a><a href="https://github.com/lucidrains/vit-pytorch">https://github.com/lucidrains/vit-pytorch</a><a href="https://github.com/facebookresearch/detr">https://github.com/facebookresearch/detr</a><a href="https://github.com/datawhalechina/leedeeprl-notes">https://github.com/datawhalechina/leedeeprl-notes</a></p>
<ul>
<li><strong>videoÔºö</strong></li>
</ul>
<p>Á¨¨ 1 Â∞èËäÇÁöÑÈÉ®ÂàÜÊèíÂõæÂíåÊñáÂ≠óÁ®øÊù•Ëá™ÊùéÂÆèÊØÖËÄÅÂ∏à PPT (Â¶Ç‰∏ãÈìæÊé•) [‰æµÂà†]„ÄÇ</p>
<p><a href="https://www.bilibili.com/video/av71295187/?spm_id_from=333.788.videocard.8">https://www.bilibili.com/video/av71295187/?spm_id_from=333.788.videocard.8</a></p>
<ul>
<li><strong>blogÔºö</strong></li>
</ul>
<p><a href="https://baijiahao.baidu.com/s?id=1651219987457222196&amp;wfr=spider&amp;for=pc">Transformer Ê®°ÂûãËØ¶Ëß£</a><a href="https://zhuanlan.zhihu.com/p/308301901">Ê∑±Â∫¶Áú∏Ôºö3W Â≠óÈïøÊñáÂ∏¶‰Ω†ËΩªÊùæÂÖ•Èó®ËßÜËßâ transformer</a><a href="https://blog.csdn.net/your_answer/article/details/79160045">Âà©Áî® python Ëß£ÂÜ≥ÊåáÊ¥æÈóÆÈ¢òÔºàÂåàÁâôÂà©ÁÆóÊ≥ïÔºâ_your_answer ÁöÑÂçöÂÆ¢ - CSDN ÂçöÂÆ¢</a></p>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../Self-Supervised%20Learning%20MoCoV2%2C3/" class="md-footer__link md-footer__link--prev" aria-label="Previous: MoCo V2">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                MoCo V2
              </div>
            </div>
          </a>
        
        
          
          <a href="../Vision%20Transformer%20%20%28%E4%BA%8C%29/" class="md-footer__link md-footer__link--next" aria-label="Next: Vision Transformer (‰∫å)">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Vision Transformer (‰∫å)
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "header.autohide"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="../mathjax-config.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../extra.js"></script>
      
        <script src="../js/toggle_sidebar.js"></script>
      
    
  </body>
</html>