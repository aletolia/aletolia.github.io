
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://localhost:8000/Recurrent%20memory%20with%20optimal%20polynomial%20projections./">
      
      
        <link rel="prev" href="../A%20visual-language%20foundation%20model%20for%20computational%20pathology/">
      
      
        <link rel="next" href="../Modeling%20Dense%20Multimodal%20Interactions%20Between%20Biological%20Pathways%20and%20Histology%20for%20Survival%20Prediction/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Recurrent memory with optimal polynomial projections. - One Last Kiss</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-M0R7V8QGQ7"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-M0R7V8QGQ7",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-M0R7V8QGQ7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="One Last Kiss" class="md-header__button md-logo" aria-label="One Last Kiss" data-md-component="logo">
      
  <img src="../img/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            One Last Kiss
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Recurrent memory with optimal polynomial projections.
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aletolia/aletolia.github.io.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aletolia/aletolia.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
    
  
  🏠 Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Mygo/" class="md-tabs__link">
          
  
    
  
  ⛏️ CV and Multimodels

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Session%201/" class="md-tabs__link">
          
  
    
  
  🚀 Re:0 Road to CPath & Visualization

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../1.1%20Single-cell%20RNA%20sequencing/" class="md-tabs__link">
          
  
    
  
  💤 Re:0 Road to scRNA-seq Analysis

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Large-scale%20foundation%20model%20on%20single-cell%20transcriptomics/" class="md-tabs__link">
          
  
    
  
  🧬 scRNA Analysis

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../%E7%AC%AC%201%20%E7%AB%A0%20python%20%E5%85%A5%E9%97%A8/" class="md-tabs__link">
          
  
    
  
  📐 Data Structures

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Best%20practices%20for%20single-cell%20analysis%20across%20modalities/" class="md-tabs__link">
          
  
    
  
  💡 Reviews

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="One Last Kiss" class="md-nav__button md-logo" aria-label="One Last Kiss" data-md-component="logo">
      
  <img src="../img/icon.png" alt="logo">

    </a>
    One Last Kiss
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aletolia/aletolia.github.io.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aletolia/aletolia.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    🏠 Home
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            🏠 Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ⛏️ CV and Multimodels
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            ⛏️ CV and Multimodels
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mygo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MyGO: Discrete Modality Information as Fine-Grained Tokens for Multi-modal Knowledge Graph Completion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GMM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GMM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DINO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DINO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mamba/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mamba
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ViT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ViT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Self-Supervised%20Learning%20MoCo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MoCo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Self-Supervised%20Learning%20MoCoV2%2C3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MoCo V2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E4%B8%80%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer  (一)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%20%28%E4%BA%8C%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (二)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E4%B8%89%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer  (三)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E5%9B%9B%29%20%28TNT%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (四)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E7%9F%A5%E8%AF%86%E8%92%B8%E9%A6%8F%20%E9%A2%84%E8%AE%AD%E7%BB%83%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (知识蒸馏 预训练）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28PyramidTNT%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer(Pyramid TNT)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0%E5%92%8C%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E4%B8%93%E9%A2%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    傅里叶级数和傅里叶变换专题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Python%20%E5%AD%98%E5%82%A8%E4%B8%8E%E8%AF%BB%E5%8F%96%20HDF5%20%E6%96%87%E4%BB%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python 存储与读取 HDF5 文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Segment%20Anything%20in%20Medical%20Images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Segment Anything in Medical Images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Mamba%20Efficient%20Visual%20Representation%20Learning%20with%20Bidirectional%20State%20Space%20Model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Mamba Efficient Visual Representation Learning with Bidirectional State Space Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_18" checked>
        
          
          <label class="md-nav__link" for="__nav_2_18" id="__nav_2_18_label" tabindex="">
            
  
  <span class="md-ellipsis">
    🚑 医学影像相关
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_18_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_18">
            <span class="md-nav__icon md-icon"></span>
            🚑 医学影像相关
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Why%20is%20the%20winner%20the%20best/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why is the winner the best
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PORPOISE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PORPOISE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HIPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling Vision Transformers to Gigapixel Images via Hierarchical Self-Supervised Learning(HIPT)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Data-efficient%20and%20weakly%20supervised%20computational%20pathology%20on%20whole-slide%20images%28CLAM%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data efficient and weakly supervised computational pathology on whole slide images(CLAM)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Towards%20a%20general-purpose%20foundation%20model%20for%20computational%20pathology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Towards a general purpose foundation model for computational pathology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20whole-slide%20foundation%20model%20for%20digital%20pathology%20from%20real-world%20data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A whole slide foundation model for digital pathology from real world data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20visual-language%20foundation%20model%20for%20computational%20pathology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A visual language foundation model for computational pathology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Recurrent memory with optimal polynomial projections.
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Recurrent memory with optimal polynomial projections.
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      摘要:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      引言:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      2 HiPPO 框架: 高阶多项式投影算子
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 HiPPO 框架: 高阶多项式投影算子">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 HiPPO 问题设置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 一般 HiPPO 框架
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-hippo-odes" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 高阶投影: 测度族和 HiPPO ODEs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-hippo-ode" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 HiPPO 递推关系: 从连续时间到离散时间通过 ODE 离散化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-rnn" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 低阶投影: 门控 RNN 的记忆机制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-hippo-legs" class="md-nav__link">
    <span class="md-ellipsis">
      3 HiPPO-LegS: 经过缩放的测度以获得时间尺度稳健性
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      相关工作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="相关工作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a1" class="md-nav__link">
    <span class="md-ellipsis">
      A.1 信号处理和正交多项式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.1 信号处理和正交多项式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a11" class="md-nav__link">
    <span class="md-ellipsis">
      A.1.1 滑动变换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a12-ml" class="md-nav__link">
    <span class="md-ellipsis">
      A.1.2 ML 中的正交多项式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a2" class="md-nav__link">
    <span class="md-ellipsis">
      A.2 机器学习中的记忆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a3" class="md-nav__link">
    <span class="md-ellipsis">
      A.3 直接相关的方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.3 直接相关的方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      傅立叶循环单元
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#odes" class="md-nav__link">
    <span class="md-ellipsis">
      神经 ODEs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b" class="md-nav__link">
    <span class="md-ellipsis">
      B 技术准备工作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="B 技术准备工作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#b1" class="md-nav__link">
    <span class="md-ellipsis">
      B.1 正交多项式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="B.1 正交多项式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#b11-legendre" class="md-nav__link">
    <span class="md-ellipsis">
      B.1.1 Legendre 多项式的性质
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b12-laguerre" class="md-nav__link">
    <span class="md-ellipsis">
      B.1.2 Laguerre 多项式的性质
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b13-chebyshev" class="md-nav__link">
    <span class="md-ellipsis">
      B.1.3 Chebyshev 多项式的性质
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b2" class="md-nav__link">
    <span class="md-ellipsis">
      B.2 莱布尼茨积分法则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b3-ode" class="md-nav__link">
    <span class="md-ellipsis">
      B.3 ODE 离散化
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      C 通用 HiPPO 框架
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C 通用 HiPPO 框架">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c1-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      C.1 通用 HiPPO 框架
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c2" class="md-nav__link">
    <span class="md-ellipsis">
      C.2 投影和系数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c3-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      C.3 系数动态：Hippo 算子
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C.3 系数动态：Hippo 算子">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      归一化动态
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c4" class="md-nav__link">
    <span class="md-ellipsis">
      C.4 离散化
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      D HiPPO 投影算子的推导
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D HiPPO 投影算子的推导">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#d1-hippo-legt" class="md-nav__link">
    <span class="md-ellipsis">
      D.1 平移的勒让德测度的推导（HiPPO-LegT）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D.1 平移的勒让德测度的推导（HiPPO-LegT）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      测度和基函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      导数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      滑动近似
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      系数动态
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d2-hippo-lagt" class="md-nav__link">
    <span class="md-ellipsis">
      D.2 翻译的拉盖尔（HiPPO-LagT）的推导
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D.2 翻译的拉盖尔（HiPPO-LagT）的推导">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      测度和基函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      倾斜的测度
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      导数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      系数动态
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      重构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      标准化动态
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d3-hippo-legs" class="md-nav__link">
    <span class="md-ellipsis">
      D.3 缩放勒让德（HiPPO-LegS）的推导
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d4" class="md-nav__link">
    <span class="md-ellipsis">
      D.4 傅里叶基的推导
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D.4 傅里叶基的推导">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#d41" class="md-nav__link">
    <span class="md-ellipsis">
      D.4.1 平移傅里叶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d42" class="md-nav__link">
    <span class="md-ellipsis">
      D.4.2 傅里叶循环单元
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d5" class="md-nav__link">
    <span class="md-ellipsis">
      D.5 平移切比雪夫的推导
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Modeling%20Dense%20Multimodal%20Interactions%20Between%20Biological%20Pathways%20and%20Histology%20for%20Survival%20Prediction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Dense Multimodal Interactions Between Biological Pathways and Histology for Survival Prediction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Inferring%20super-resolution%20tissue%20architecture%20by%20integrating%20spatial%20transcriptomics%20with%20histology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inferring super resolution tissue architecture by integrating spatial transcriptomics with histology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Prediction%20of%20recurrence%20risk%20in%20endometrial%20cancer%20with%20multimodal%20deep%20learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prediction of recurrence risk in endometrial cancer with multimodal deep learning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🚀 Re:0 Road to CPath & Visualization
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            🚀 Re:0 Road to CPath & Visualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    理解全幅切片图像
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%202/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在计算病理学中用于癌症诊断的弱监督深度学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基于注意力的多示例学习可解释性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../How%20to%20visualize%20Attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to visualize Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AttentionViz%20A%20Global%20View%20of%20Transformer%20Attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AttentionViz A Global View of Transformer Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformer%20Interpretability%20Beyond%20Attention%20Visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer Interpretability Beyond Attention Visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Visualization%20Work%20Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualization Work Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Attention%20Generation%20Work%20Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attention Generation Work Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🪛 PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            🪛 PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Autograd%20mechanics%20%E2%80%94%20PyTorch%202_3%20documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autograd mechanics — PyTorch 2 3 documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PyTorch%20Autograd%20Explained%20-%20In-depth%20Tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Autograd Explained   In depth Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    💤 Re:0 Road to scRNA-seq Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            💤 Re:0 Road to scRNA-seq Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Using Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Using Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ⏳ CHAPTER 1 简介
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            ⏳ CHAPTER 1 简介
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.1%20Single-cell%20RNA%20sequencing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1.The building block of life
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.2%20Raw%20Data%20Processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 Raw data processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.3%20Analysis%20frameworks%20and%20tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Analysis frameworks and tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🌏 CHAPTER 2 数据准备与可视化
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            🌏 CHAPTER 2 数据准备与可视化
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1%20quality_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 Quality Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2%20normalization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 Normalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.3_feature_selection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 Feature selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.4_dimensionality_reduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4 Dimensionality Reduction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_3" id="__nav_4_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🍀 CHAPTER 3 识别细胞结构
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_3">
            <span class="md-nav__icon md-icon"></span>
            🍀 CHAPTER 3 识别细胞结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.1clustering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 Clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.2annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 Annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 Data integration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4" id="__nav_4_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ⏱️ CHAPTER 4 推断细胞轨迹
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4">
            <span class="md-nav__icon md-icon"></span>
            ⏱️ CHAPTER 4 推断细胞轨迹
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pseudotemporal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 Pseudotemporal ordering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rna_velocity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 RNA velocity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lineage_tracing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 Lineage tracing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_5" >
        
          
          <label class="md-nav__link" for="__nav_4_1_5" id="__nav_4_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🎁 CHAPTER 5 应对特殊情况
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_5">
            <span class="md-nav__icon md-icon"></span>
            🎁 CHAPTER 5 应对特殊情况
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../differential_gene_expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 Differential gene expression analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compositional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 Compositional analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gsea_pathway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 Gene set enrichment and pathway analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perturbation_modeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4 Perturbation modeling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_6" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6" id="__nav_4_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ⚙️ CHAPTER 6 机制建模
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6">
            <span class="md-nav__icon md-icon"></span>
            ⚙️ CHAPTER 6 机制建模
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gene_regulatory_networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 Gene regulatory networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cell_cell_communication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 Cell-cell communication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_7" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7" id="__nav_4_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🔓 CHAPTER 7 反卷积
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7">
            <span class="md-nav__icon md-icon"></span>
            🔓 CHAPTER 7 反卷积
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bulk_deconvolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1 Bulk deconvolution
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    简明易懂的单细胞分析流程（使用 R 语言）
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            简明易懂的单细胞分析流程（使用 R 语言）
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%89%8D%E8%A8%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    前言
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    环境配置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.1%20%E6%9E%84%E5%BB%BA%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E5%88%86%E6%9E%90%E7%8E%AF%E5%A2%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1 构建单细胞 RNA seq 分析环境
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.2%20R%20%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 R 环境安装
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.3%20Docker%20%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Docker 安装
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.4%20%E5%9C%A8%20Docker%20%E4%B8%AD%E5%90%AF%E5%8A%A8%20Rstudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4 在 Docker 中启动 Rstudio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.5%20%E6%9C%89%E5%85%B3%20Bioconductor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5 有关 Bioconductor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1%20R%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 R 的基本用法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2%20%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%20DataFrame%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 如何处理 DataFrame？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.3%20%E4%BD%BF%E7%94%A8%20ggplot2%20%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 使用 ggplot2 可视化数据
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.1%20PCA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 PCA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.2%20%E4%BD%BF%E7%94%A8%20clusterPlofiler%20%E8%BF%9B%E8%A1%8C%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 使用 clusterPlofiler 进行富集分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3%20%E5%9F%BA%E5%9B%A0%E6%9C%AC%E4%BD%93%EF%BC%88GO%EF%BC%89%E4%B8%AD%E5%90%84%20BP%E3%80%81MF%20%E5%92%8C%20CC%20%E7%9A%84%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 基因本体（GO）中各 BP、MF 和 CC 的富集分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3%20%E4%BD%BF%E7%94%A8%20DEseq2%20%E6%8F%90%E5%8F%96%20RNA-seq%20%E5%88%86%E6%9E%90%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%20DEG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 使用 DEseq2 提取 RNA seq 分析数据中的 DEG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.4%20%E4%BD%BF%E7%94%A8%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88KEGG%E3%80%81Reactome%20%E7%AD%89%EF%BC%89%E8%BF%9B%E8%A1%8C%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4 使用其他数据库（KEGG、Reactome 等）进行富集分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.1%20scRNA-seq%20%E6%A6%82%E8%A6%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 scRNA seq 概要
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.2%20%E5%87%86%E5%A4%87%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 准备使用 Seurat 进行分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.3%20%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 使用 Seurat 进行数据预处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.4%20%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%9A%84%E4%B8%80%E8%88%AC%E9%A1%BA%E5%BA%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4 使用 Seurat 进行数据分析的一般顺序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.1%20%E5%A6%82%E4%BD%95%E6%9F%A5%E6%89%BE%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 如何查找单细胞 RNA seq 数据
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.2%20%E4%B8%BA%E6%AF%8F%E4%B8%AA%E7%B0%87%E8%87%AA%E5%8A%A8%E6%B7%BB%E5%8A%A0%E7%BB%86%E8%83%9E%E6%B3%A8%E9%87%8A%E6%A0%87%E7%AD%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 为每个簇自动添加细胞注释标签
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.3%20%E4%BD%BF%E7%94%A8%20FeaturePlot%20%E6%A3%80%E6%9F%A5%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 使用 FeaturePlot 检查基因表达
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.4%20%E5%B0%86%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9B%B8%E4%BA%92%E7%BB%93%E5%90%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4 将单细胞 RNA seq 数据集相互结合
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.5%20%E7%BA%A0%E6%AD%A3%E6%89%B9%E6%AC%A1%E6%95%88%E5%BA%94%EF%BC%8C%E6%AF%94%E8%BE%83%E5%AF%B9%E7%85%A7%E7%BB%84%E5%92%8C%E5%88%BA%E6%BF%80%E7%BB%84/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.5 纠正批次效应，比较对照组和刺激组
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.6%20%E7%A1%AE%E5%AE%9A%E6%AF%8F%E4%B8%AA%E7%BE%A4%E7%BB%84%E7%9A%84%E6%A0%87%E8%AE%B0%E5%9F%BA%E5%9B%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.6 确定每个群组的标记基因
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.1%20%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%20Cell%20Ranger%20%E7%BB%9F%E8%AE%A1%20scRNA-seq%20%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%B0%B4%E5%B9%B3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 如何使用 Cell Ranger 统计 scRNA seq 数据中的基因表达水平
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.2%20%E4%BD%BF%E7%94%A8%20Cell%20Ranger%20%E5%A4%84%E7%90%86%20NCBI%20Sequence%20Read%20Archive%20%28SRA%29%20%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 使用 Cell Ranger 处理 NCBI Sequence Read Archive (SRA) 数据
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.1%20%E5%85%B3%E4%BA%8E%20scRNA-seq%20%E6%95%B0%E6%8D%AE%E7%9A%84%E8%B4%A8%E9%87%8F%E6%8E%A7%E5%88%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1 关于 scRNA seq 数据的质量控制
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.2%20%E4%BD%BF%E7%94%A8%20DoubleFinder%20%E6%A3%80%E6%B5%8B%E5%8F%8C%E9%87%8D%E7%BB%86%E8%83%9E/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.2 使用 DoubleFinder 检测双重细胞
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.3%20%E7%94%A8%20CellBender%20%E5%8E%BB%E9%99%A4%E8%83%8C%E6%99%AF%20RNA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.3 用 CellBender 去除背景 RNA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🧬 scRNA Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            🧬 scRNA Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🐍 Using Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            🐍 Using Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Large-scale%20foundation%20model%20on%20single-cell%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Large scale foundation model on single cell transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scGPT%20toward%20building%20a%20foundation%20model%20for%20single-cell%20multi-omics%20using%20generative%20AI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scGPT toward building a foundation model for single cell multi omics using generative AI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scBERT%20as%20a%20large-scale%20pretrained%20deep%20language%20model%20for%20cell%20type%20annotation%20of%20single-cell%20RNA-seq%20data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scBERT as a large scale pretrained deep language model for cell type annotation of single cell RNA seq data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RNA%20velocity%20of%20single%20cells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RNA velocity of single cells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TFvelo_gene%20regulation%20inspired%20RNA%20velocity%20estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TFvelo gene regulation inspired RNA velocity estimation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Disentanglement%20of%20single-cell%20data%20with%20biolord/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disentanglement of single cell data with biolord
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E2%AD%90%E2%AD%90%E2%AD%90C5aR1%20inhibition%20reprograms%20tumor%20associated%20macrophages%20and%20reverses%20PARP%20inhibitor%20resistance%20in%20breast%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ⭐⭐⭐C5aR1 inhibition reprograms tumor associated macrophages and reverses PARP inhibitor resistance in breast cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Spatial%20transition%20tensor%20of%20single%20cells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial transition tensor of single cells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Statistical%20method%20scDEED%20for%20detecting%20dubious%202D%20single-cell%20embeddings%20and%20optimizing%20t-SNE%20and%20UMAP%20hyperparameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistical method scDEED for detecting dubious 2D single cell embeddings and optimizing t SNE and UMAP hyperparameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scRank%20infers%20drug-responsive%20cell%20types%20from%20untreated%20scRNA-seq%20data%20using%20a%20target-perturbed%20gene%20regulatory%20network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scRank infers drug responsive cell types from untreated scRNA seq data using a target perturbed gene regulatory network
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    📔 文献
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            📔 文献
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ZNF689%20deficiency%20promotes%20intratumor%20heterogeneity%20and%20immunotherapy%20resistance%20in%20triple-negative%20breast%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZNF689 deficiency promotes intratumor heterogeneity and immunotherapy resistance in triple negative breast cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tumour%20vasculature%20at%20single-cell%20resolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tumour vasculature at single-cell resolution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scRNA-seq%20of%20gastric%20tumor%20shows%20complex%20intercellular%20interaction%20with%20an%20alternative%20T%20cell%20exhaustion%20trajectory%EF%BC%88%E5%8F%82%E8%80%83%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scRNA seq of gastric tumor shows complex intercellular interaction with an alternative T cell exhaustion trajectory（参考）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20analysis%20reveals%20new%20evolutionary%20complexity%20in%20uveal%20melanoma%EF%BC%88%E5%8F%82%E8%80%83%202%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis reveals new evolutionary complexity in uveal melanoma（参考 2）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20characterization%20of%20macrophages%20in%20uveal%20melanoma%20uncovers%20transcriptionally%20heterogeneous%20subsets%20conferring%20poor%20prognosis%20and%20aggressive%20behavior%EF%BC%88%E8%8C%83%E4%BE%8B%201%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell characterization of macrophages in uveal melanoma uncovers transcriptionally heterogeneous subsets conferring poor prognosis and aggressive behavior（范例 1）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ScRNA-seq%20of%20gastric%20cancer%20tissues%20reveals%20differences%20in%20the%20immune%20microenvironment%20of%20primary%20tumors%20and%20metastases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScRNA seq of gastric cancer tissues reveals differences in the immune microenvironment of primary tumors and metastases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Blimp-1%20and%20c-Maf%20regulate%20immune%20gene%20networks%20to%20protect%20against%20distinct%20pathways%20of%20pathobiont-induced%20colitis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blimp 1 and c Maf regulate immune gene networks to protect against distinct pathways of pathobiont induced colitis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single%20cell%20analysis%20unveils%20B%20cell-dominated%20immune%20subtypes%20in%20HNSCC%20for%20enhanced%20prognostic%20and%20therapeutic%20stratification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis unveils B cell dominated immune subtypes in HNSCC for enhanced prognostic and therapeutic stratification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20spatial%20multi-omics%20and%20deep%20learning%20dissect%20enhancer-driven%20gene%20regulatory%20networks%20in%20liver%20zonation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell spatial multi omics and deep learning dissect enhancer driven gene regulatory networks in liver zonation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Neutrophil%20profiling%20illuminates%20anti-tumor%20antigen%20presenting%20potency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neutrophil profiling illuminates anti tumor antigen presenting potency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20blueprint%20for%20tumor-infiltrating%20B%20cells%20across%20human%20cancers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A blueprint for tumor infiltrating B cells across human cancers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20transcriptomic%20analyses%20reveal%20distinct%20immune%20cell%20contributions%20to%20epithelial%20barrier%20dysfunction%20in%20checkpoint%20inhibitor%20colitis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell transcriptomic analyses reveal distinct immune cell contributions to epithelial barrier dysfunction in checkpoint inhibitor colitis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Systematic%20dissection%20of%20tumor-normal%20single-cell%20ecosystems%20across%20a%20thousand%20tumors%20of%2030%20cancer%20types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Systematic dissection of tumor normal single cell ecosystems across a thousand tumors of 30 cancer types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../The%20aged%20tumor%20microenvironment%20limits%20T%20cell%20control%20of%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The aged tumor microenvironment limits T cell control of cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TIM-3%2B%20CD8%20T%20cells%20with%20a%20terminally%20exhausted%20phenotype%20retain%20functional%20capacity%20in%20hematological%20malignancies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TIM 3+ CD8 T cells with a terminally exhausted phenotype retain functional capacity in hematological malignancies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20lactate-SREBP2%20signaling%20axis%20drives%20tolerogenic%20dendritic%20cell%20maturation%20and%20promotes%20cancer%20progression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A lactate SREBP2 signaling axis drives tolerogenic dendritic cell maturation and promotes cancer progression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20human%20omentum-specific%20mesothelial-like%20stromal%20population%20inhibits%20adipogenesis%20through%20IGFBP2%20secretion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A human omentum specific mesothelial like stromal population inhibits adipogenesis through IGFBP2 secretion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Interferon-stimulated%20neutrophils%20as%20a%20predictor%20of%20immunotherapy%20response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interferon stimulated neutrophils as a predictor of immunotherapy response
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Repression%20of%20latent%20NF-%CE%BAB%20enhancers%20by%20PDX1%20regulates%20%CE%B2%20cell%20functional%20heterogeneity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repression of latent NF κB enhancers by PDX1 regulates β cell functional heterogeneity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20systematic%20pan-cancer%20study%20on%20deep%20learning-based%20prediction%20of%20multi-omic%20biomarkers%20from%20routine%20pathology%20images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A systematic pan cancer study on deep learning based prediction of multi omic biomarkers from routine pathology images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20and%20spatial%20transcriptomics%20analysis%20of%20non-small%20cell%20lung%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell and spatial transcriptomics analysis of non small cell lung cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Seeing%20data%20as%20t-SNE%20and%20UMAP%20do/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seeing data as t SNE and UMAP do
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mapping%20the%20cellular%20biogeography%20of%20human%20bone%20marrow%20niches%20using%20single-cell%20transcriptomics%20and%20proteomic%20imaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mapping the cellular biogeography of human bone marrow niches using single cell transcriptomics and proteomic imaging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Onco-fetal%20Reprogramming%20of%20Endothelial%20Cells%20Drives%20Immunosuppressive%20Macrophages%20in%20Hepatocellular%20Carcinoma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Onco fetal Reprogramming of Endothelial Cells Drives Immunosuppressive Macrophages in Hepatocellular Carcinoma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20analysis%20of%20anti-BCMA%20CAR%20T%20cell%20therapy%20in%20patients%20with%20central%20nervous%20system%20autoimmunity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis of anti BCMA CAR T cell therapy in patients with central nervous system autoimmunity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20sequencing%20depicts%20tumor%20architecture%20and%20empowers%20clinical%20decision%20in%20metastatic%20conjunctival%20melanoma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell sequencing depicts tumor architecture and empowers clinical decision in metastatic conjunctival melanoma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PR-SET7%20epigenetically%20restrains%20uterine%20interferon%20response%20and%20cell%20death%20governing%20proper%20postnatal%20stromal%20development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PR SET7 epigenetically restrains uterine interferon response and cell death governing proper postnatal stromal development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Clonal%20associations%20between%20lymphocyte%20subsets%20and%20functional%20states%20in%20rheumatoid%20arthritis%20synovium/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clonal associations between lymphocyte subsets and functional states in rheumatoid arthritis synovium
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    📐 Data Structures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            📐 Data Structures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%201%20%E7%AB%A0%20python%20%E5%85%A5%E9%97%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 1 章 python 入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%202%20%E7%AB%A0%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 2 章 面向对象编程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%203%20%E7%AB%A0%20%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 3 章 算法分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%204%20%E7%AB%A0%20%E9%80%92%E5%BD%92/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 4 章 递归
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%205%20%E7%AB%A0%20%E5%9F%BA%E4%BA%8E%E6%95%B0%E7%BB%84%E7%9A%84%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 5 章 基于数组的序列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%206%20%E7%AB%A0%20%E6%A0%88%E3%80%81%E9%98%9F%E5%88%97%E5%92%8C%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 6 章 栈、队列和双端队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%207%20%E7%AB%A0%20%E9%93%BE%E8%A1%A8%28Linked%20Lists%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 7 章 链表(Linked Lists)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%208%20%E7%AB%A0%20%E6%A0%91%20%E2%98%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 8 章 树 ★
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%209%20%E7%AB%A0%20%E4%BC%98%E5%85%88%E7%BA%A7%E9%98%9F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 9 章 优先级队列
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    💡 Reviews
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            💡 Reviews
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🧭 scRNA analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            🧭 scRNA analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Best%20practices%20for%20single-cell%20analysis%20across%20modalities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Best practices for single cell analysis across modalities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Multi-omics%20integration%20in%20biomedical%20research%20%E2%80%93%20A%20metabolomics-centric%20review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi omics integration in biomedical research – A metabolomics centric review
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Museum%20of%20spatial%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Museum of spatial transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20guide%20to%20artificial%20intelligence%20for%20cancer%20researchers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A guide to artificial intelligence for cancer researchers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🦠 Metabolism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            🦠 Metabolism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20analysis%20as%20a%20driver%20for%20discovery%2C%20diagnosis%2C%20and%20therapy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic analysis as a driver for discovery, diagnosis, and therapy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20heterogeneity%20in%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic heterogeneity in cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Toward%20modeling%20metabolic%20state%20from%20single-cell%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toward modeling metabolic state from single cell transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20reprogramming%20and%20cancer%20progression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic reprogramming and cancer progression
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protein
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Protein
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Proteomic%20and%20interactomic%20insights%20into%20the%20molecular%20basis%20of%20cell%20functional%20diversity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proteomic and interactomic insights into the molecular basis of cell functional diversity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      摘要:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      引言:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      2 HiPPO 框架: 高阶多项式投影算子
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 HiPPO 框架: 高阶多项式投影算子">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 HiPPO 问题设置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 一般 HiPPO 框架
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-hippo-odes" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 高阶投影: 测度族和 HiPPO ODEs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-hippo-ode" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 HiPPO 递推关系: 从连续时间到离散时间通过 ODE 离散化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-rnn" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 低阶投影: 门控 RNN 的记忆机制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-hippo-legs" class="md-nav__link">
    <span class="md-ellipsis">
      3 HiPPO-LegS: 经过缩放的测度以获得时间尺度稳健性
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      相关工作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="相关工作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a1" class="md-nav__link">
    <span class="md-ellipsis">
      A.1 信号处理和正交多项式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.1 信号处理和正交多项式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a11" class="md-nav__link">
    <span class="md-ellipsis">
      A.1.1 滑动变换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a12-ml" class="md-nav__link">
    <span class="md-ellipsis">
      A.1.2 ML 中的正交多项式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a2" class="md-nav__link">
    <span class="md-ellipsis">
      A.2 机器学习中的记忆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a3" class="md-nav__link">
    <span class="md-ellipsis">
      A.3 直接相关的方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.3 直接相关的方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      傅立叶循环单元
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#odes" class="md-nav__link">
    <span class="md-ellipsis">
      神经 ODEs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b" class="md-nav__link">
    <span class="md-ellipsis">
      B 技术准备工作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="B 技术准备工作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#b1" class="md-nav__link">
    <span class="md-ellipsis">
      B.1 正交多项式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="B.1 正交多项式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#b11-legendre" class="md-nav__link">
    <span class="md-ellipsis">
      B.1.1 Legendre 多项式的性质
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b12-laguerre" class="md-nav__link">
    <span class="md-ellipsis">
      B.1.2 Laguerre 多项式的性质
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b13-chebyshev" class="md-nav__link">
    <span class="md-ellipsis">
      B.1.3 Chebyshev 多项式的性质
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b2" class="md-nav__link">
    <span class="md-ellipsis">
      B.2 莱布尼茨积分法则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b3-ode" class="md-nav__link">
    <span class="md-ellipsis">
      B.3 ODE 离散化
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      C 通用 HiPPO 框架
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C 通用 HiPPO 框架">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c1-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      C.1 通用 HiPPO 框架
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c2" class="md-nav__link">
    <span class="md-ellipsis">
      C.2 投影和系数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c3-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      C.3 系数动态：Hippo 算子
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C.3 系数动态：Hippo 算子">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      归一化动态
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c4" class="md-nav__link">
    <span class="md-ellipsis">
      C.4 离散化
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-hippo" class="md-nav__link">
    <span class="md-ellipsis">
      D HiPPO 投影算子的推导
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D HiPPO 投影算子的推导">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#d1-hippo-legt" class="md-nav__link">
    <span class="md-ellipsis">
      D.1 平移的勒让德测度的推导（HiPPO-LegT）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D.1 平移的勒让德测度的推导（HiPPO-LegT）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      测度和基函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      导数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      滑动近似
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      系数动态
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d2-hippo-lagt" class="md-nav__link">
    <span class="md-ellipsis">
      D.2 翻译的拉盖尔（HiPPO-LagT）的推导
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D.2 翻译的拉盖尔（HiPPO-LagT）的推导">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      测度和基函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      倾斜的测度
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      导数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      系数动态
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      重构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      标准化动态
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d3-hippo-legs" class="md-nav__link">
    <span class="md-ellipsis">
      D.3 缩放勒让德（HiPPO-LegS）的推导
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d4" class="md-nav__link">
    <span class="md-ellipsis">
      D.4 傅里叶基的推导
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D.4 傅里叶基的推导">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#d41" class="md-nav__link">
    <span class="md-ellipsis">
      D.4.1 平移傅里叶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d42" class="md-nav__link">
    <span class="md-ellipsis">
      D.4.2 傅里叶循环单元
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d5" class="md-nav__link">
    <span class="md-ellipsis">
      D.5 平移切比雪夫的推导
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/aletolia/aletolia.github.io.git/edit/master/docs/Recurrent memory with optimal polynomial projections..md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/aletolia/aletolia.github.io.git/raw/master/docs/Recurrent memory with optimal polynomial projections..md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Recurrent memory with optimal polynomial projections.</h1>

<h2 id="_1">摘要:<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>在从序列数据中学习的中心问题是，随着更多数据被处理，以一种增量方式表示累积的历史记录。我们引入了一个通用框架 (HiPPO)，用于<strong><mark>将连续信号和离散时间序列在线压缩到多项式基上</mark></strong>。<strong><u>给定一个指定过去每个时间步骤重要性的测度，HiPPO 产生了一个自然的在线函数逼近问题的最优解</u></strong>。作为特例，我们的框架从第一原理简单推导出最近的 Legendre 记忆单元 (LMU)，并推广了诸如 GRU 等循环神经网络的通用门控机制。这个形式框架产生了一种新的记忆更新机制 (HiPPO-LegS)，可以随时间扩展以记住所有历史，避免了对时间尺度的先验假设。HiPPO-LegS 享有时间尺度稳健性、快速更新和有界梯度的理论优势。通过将记忆动力学纳入循环神经网络，HiPPO RNN 在经验上可以捕获复杂的时间依赖性。在基准置换 MNIST 数据集上，HiPPO-LegS 设置了 98.3% 的新的最佳精度记录。最后，在一个新的轨迹分类任务中测试对时间尺度外的分布和丢失数据的稳健性，HiPPO-LegS 的精度比 RNN 和神经 ODE 基线高出 25-40%。 </p>
<h2 id="_2">引言:<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>对序列数据进行建模和学习是现代机器学习中的一个基本问题，影响到诸如语言模型、语音识别、视频处理和强化学习等任务。建模长期和复杂时间依赖性的一个核心方面是记忆，或者存储和并入来自先前时间步骤的信息。挑战在于使用有限的存储空间学习整个累积历史的表示，这必须在接收到更多数据时在线更新。</p>
<p>一种成熟的方法是对随时间演化并吸收更多信息的状态进行建模。这种方法在深度学习中的体现是循环神经网络 (RNN)，人们已经发现它存在有限的记忆视野 (例如，梯度消失问题)。尽管提出了各种启发式方法来克服这一点，比如成功的 LSTM 和 GRU 中的门控机制，或者最近的 Fourier 循环单元和 Legendre 记忆单元 (LMU) 中的高阶频率，但对记忆的统一理解仍然是一个挑战。此外，现有方法通常需要对序列长度或时间尺度进行先验假设，并且在此范围之外效果不佳; 这在分布发生转移的情况下可能会带来问题 (例如医疗数据中不同仪器的采样率不同)。最后，其中许多缺乏关于它们捕获长期依赖性质量的理论保证，如梯度有界性。为了设计更好的记忆表示，理想情况下我们应该 (i) 对现有方法有一个统一的认识，(ii) 能够在不对时间尺度做先验假设的情况下处理任何长度的依赖性，以及 (iii) 对其记忆机制有严格的理论理解。</p>
<p>我们的洞见是将记忆作为一个在线函数逼近的技术问题来表述，其中一个函数 <span class="arithmatex">\(f(t): \mathbb{R}_{+} \rightarrow \mathbb{R}\)</span> 通过存储它在某些基函数上的最优系数来进行总结。这个逼近是相对于一个指定过去每个时间重要性的测度来评估的。给定这个函数逼近公式化，正交多项式 (OPs) 作为一个自然的基 emerge 出来，因为它们的最优系数可以用闭式表示 [14]。正交多项式拥有丰富且经过深入研究的历史 [65]，以及在逼近理论 [68] 和信号处理 [57] 中的广泛应用，它们为这个记忆表示问题带来了一整套技术。我们形式化了一个框架 HiPPO(高阶多项式投影算子)，它产生了算子将任意函数投影到正交多项式空间上，相对于给定的测度。这个通用框架允许我们分析几个测度族，其中这个算子作为一个闭式 ODE 或线性递归关系，允许在输入函数随时间展开时快速增量更新最优多项式逼近。</p>
<p>通过提出支配循环序列模型的形式优化问题，HiPPO 框架 (第 2 节) 概括并解释了之前的方法，开启了适用于不同时间尺度序列数据的新方法，并且带来了一些理论保证。(i) 例如，通过一个简短的推导，我们准确地恢复了 LMU[71] 作为一个特例 (第 2.3 节)，它提出了一个投影到固定长度滑动窗口的更新规则。HiPPO 还揭示了经典技术如 LSTM 和 GRU 中的门控机制的新见解，它们在只使用低阶近似度数的一个极端情况下出现 (第 2.5 节)。(ii) <strong><em>通过选择更合适的测度，HiPPO 产生了一种新机制 (Scaled Legendre，或 LegS)，它始终考虑函数的整个历史记录，而不是滑动窗口</em></strong>。这种灵活性消除了对序列长度的超参数或先验需求，允许 LegS 推广到不同的输入时间尺度。(iii) 与动力系统和逼近理论的联系使我们能够展示 HiPPO-LegS 的一些理论优势: 不变于输入时间尺度、更有效的渐近更新，以及梯度流和逼近误差的边界 (第 3 节)。</p>
<p>我们将 HiPPO 记忆机制集成到 RNN 中，并在用于评测长期依赖性的标准任务上实证地展示了它们优于基线方法的表现。在 permuted MNIST 数据集上，我们无需超参数的 HiPPO-LegS 方法实现了 98.3% 的新的最佳精度记录，超过了之前 RNN 最佳结果 1 个多点，甚至优于具有全局上下文的变压器模型 (第 4.1 节)。接下来，我们在一个新颖的轨迹分类任务上展示了 HiPPO-LegS 的时间尺度稳健性，它能够推广到看不见的时间尺度并处理缺失数据，而 RNN 和神经 ODE 基线则失败了 (第 4.2 节)。最后，我们验证了 HiPPO 的理论，包括计算效率和可扩展性，允许在数百万个时间步长上快速精确地在线重构函数 (第 4.3 节)。重现我们实验的代码可在 https://github.com/HazyResearch/hippo-code 获得。</p>
<h2 id="2-hippo">2 HiPPO 框架: 高阶多项式投影算子<a class="headerlink" href="#2-hippo" title="Permanent link">&para;</a></h2>
<h3 id="21-hippo">2.1 HiPPO 问题设置<a class="headerlink" href="#21-hippo" title="Permanent link">&para;</a></h3>
<p>给定一个输入函数 <span class="arithmatex">\(f(t) \in \mathbb{R}\)</span> 在 <span class="arithmatex">\(t \geq 0\)</span> 上，许多问题需要在每个时间 <span class="arithmatex">\(t \geq 0\)</span> 时对累积历史 <span class="arithmatex">\(f_{\leq t}:=\left.f(x)\right|_{x \leq t}\)</span> 进行操作，<u><em>以理解到目前为止看到的输入并做出未来预测</em></u>。由于函数空间非常庞大，历史记录不可能被完美地记住，<strong>必须被压缩</strong>; 我们提出通过将其投影到有限维子空间的一般方法。因此，我们的目标是维护 (在线) 这个历史的压缩表示。为了完整地指定这个问题，我们需要两个组成部分: <strong><mark>量化逼近的一种方式，以及一个合适的子空间</mark></strong>。</p>
<p><strong>相对于一个测度的函数逼近</strong> ：为了评价这种逼近的程度，我们需要在函数空间中定义一个距离。<strong><mark>任何概率测度 <span class="arithmatex">\(\mu\)</span> 在 <span class="arithmatex">\([0， \infty)\)</span> 上为可平方积分函数空间赋予内积 <span class="arithmatex">\(\langle f,g\rangle_\mu=\int_0^{\infty} f(x) g(x) \mathrm{d} \mu(x)\)</span>，诱导出一个 Hilbert 空间结构 <span class="arithmatex">\(\mathcal{H}_\mu\)</span> 和相应的范数 <span class="arithmatex">\(\|f\|_{L_2(\mu)}=\langle f, f\rangle_\mu^{1 / 2}\)</span>。</mark></strong></p>
<p><strong>多项式基展开</strong>：<strong><mark>这个函数空间的任何 N 维子空间 <span class="arithmatex">\(\mathcal{G}\)</span> 都是近似的合适候选</mark></strong>。<strong><u>参数 N 对应于近似的阶数</u></strong>，或压缩的大小; 投影历史可以由它在 <span class="arithmatex">\(\mathcal{G}\)</span> 的任何一组基上的 N 个系数表示。在本文的其余部分，<strong><u>我们使用多项式作为一个自然的基，因此 <span class="arithmatex">\(\mathcal{G}\)</span> 是次数小于 N 的多项式集合</u></strong>。我们注意到多项式基是非常通用的; 例如，Fourier 基 <span class="arithmatex">\(\sin (n x)， \cos (n x)\)</span> 可以被看作是单位圆上的多项式 <span class="arithmatex">\((e^{2 \pi i x})^n\)</span>(参见附录 D.4)。在附录 C 中，我们还形式化了一个更通用的框架，<strong><u><em>允许通过对测度进行傾斜来使用除多项式之外的其他基。</em></u></strong></p>
<p><strong>在线逼近</strong>：<strong><u><em>由于我们关心逼近每个时间 <span class="arithmatex">\(t\)</span> 的 <span class="arithmatex">\(f_{&lt;t}\)</span>，我们还让测度随时间变化</em></u></strong>。对于每个 <span class="arithmatex">\(t\)</span>，令 <span class="arithmatex">\(\mu^{(t)}\)</span> 是一个支撑在 <span class="arithmatex">\((-\infty, t]\)</span> 上的测度 (因为 <span class="arithmatex">\(f \leq t\)</span> 只定义到时间 <span class="arithmatex">\(t\)</span>)。<strong><u><em>总的来说，我们寻求 <span class="arithmatex">\(\mathcal{G}\)</span> 中的某个 <span class="arithmatex">\(g^{(t)}\)</span> 使 <span class="arithmatex">\(\|f_{\leq t}-g^{(t)}\|_{L_2(\mu^{(t)})}\)</span> 最小化</em></u></strong>。直观地说，测度 <span class="arithmatex">\(\mu\)</span> 控制着输入域各部分的重要性，基决定了允许的近似。挑战在于如何在给定 <span class="arithmatex">\(\mu^{(t)}\)</span> 的情况下以闭式解决优化问题，以及这些系数如何在 <span class="arithmatex">\(t \rightarrow \infty\)</span>​时在线维护。</p>
<h3 id="22-hippo">2.2 一般 HiPPO 框架<a class="headerlink" href="#22-hippo" title="Permanent link">&para;</a></h3>
<p>我们简要概述了解决这个问题背后的主要思路，这为许多测度族 <span class="arithmatex">\(\mu^{(t)}\)</span> 提供了一种出人意料的简单而通用的策略。<strong><u><em>这个框架建立在信号处理文献中研究了很久的正交多项式及相关变换的丰富历史基础之上</em></u></strong>。我们的形式抽象 (定义 1) 在几个方面区别于之前关于滑动变换的工作，我们将在附录 A.1 中详细讨论。例如，我们的时变测度概念允许更合理地选择 <span class="arithmatex">\(\mu^{(t)}\)</span>，这将导致质量不同的行为的解。附录 C 包含了我们框架的全部细节和形式。</p>
<p><strong>通过连续动力学计算投影</strong>：如前所述，近似函数可以由它在任何基上展开的 N 个系数表示; 第一个关键步骤是选择 <span class="arithmatex">\(\mathcal{G}\)</span> 的一个合适基 <span class="arithmatex">\(\{g_n\}_{n&lt;N}\)</span>。利用逼近理论中的经典技术，一个自然的基是测度 <span class="arithmatex">\(\mu^{(t)}\)</span> 的正交多项式集合，<strong><u>它形成了该子空间的一个正交基。然后最优基展开的系数就简单地是 <span class="arithmatex">\(c_n^{(t)}:=\langle f_{\leq t}， g_n\rangle_{\mu^{(t)}}\)</span></u></strong>。</p>
<p>第二个关键思想是对 <span class="arithmatex">\(t\)</span> 求导这个投影，<strong><u><em>其中通过对积分 (来自内积 <span class="arithmatex">\(\langle f_{\leq t}, g_n\rangle_{\mu^{(t)}}\)</span>) 求导将常常导致一个自相似关系，使 <span class="arithmatex">\(\frac{d}{dt} c_n(t)\)</span> 可以由 <span class="arithmatex">\((c_k(t))_{k\in[N]}\)</span> 和 <span class="arithmatex">\(f(t)\)</span> 表示。因此系数 <span class="arithmatex">\(c(t) \in \mathbb{R}^N\)</span> 应该按照一个 ODE 演化</em></u></strong>，其动力学由 <span class="arithmatex">\(f(t)\)</span> 决定。  </p>
<p>HiPPO 概要: 在线函数逼近。</p>
<p>定义 1.给定一个时变测度族 <span class="arithmatex">\(\mu^{(t)}\)</span> 支撑在 <span class="arithmatex">\((-\infty, t]\)</span> 上，一个 N 维多项式子空间 <span class="arithmatex">\(\mathcal{G}\)</span>，以及一个连续函数 <span class="arithmatex">\(f: \mathbb{R}_{\geq 0} \rightarrow \mathbb{R}\)</span>，HiPPO 在每个时间 <span class="arithmatex">\(t\)</span> 定义一个投影算子 <span class="arithmatex">\(\operatorname{proj}_t\)</span> 和一个系数提取算子 <span class="arithmatex">\(\operatorname{coef}_t\)</span>，具有以下性质:</p>
<p>(1) <span class="arithmatex">\(\operatorname{proj}_t\)</span> 取函数 <span class="arithmatex">\(f\)</span> 限制到时间 <span class="arithmatex">\(t\)</span> 之前的部分 <span class="arithmatex">\(f_{\leq t}:=\left.f(x)\right|_{x \leq t}\)</span>，并将其映射到 <span class="arithmatex">\(\mathcal{G}\)</span> 中的一个多项式 <span class="arithmatex">\(g^{(t)}\)</span>，使 <span class="arithmatex">\(\|f_{\leq t}-g^{(t)}\|_{L_2(\mu^{(t)})}\)</span> 最小化。</p>
<p>(2) <span class="arithmatex">\(\operatorname{coef}_t: \mathcal{G} \rightarrow \mathbb{R}^N\)</span> 将多项式 <span class="arithmatex">\(g^{(t)}\)</span> 映射到相对于测度 <span class="arithmatex">\(\mu^{(t)}\)</span> 定义的正交多项式基的系数 <span class="arithmatex">\(c(t) \in \mathbb{R}^N\)</span>。</p>
<p><span class="arithmatex">\(\operatorname{coef}\circ\operatorname{proj}\)</span> 的复合称为 hippo，<strong><mark>它是一个算子将函数 <span class="arithmatex">\(f: \mathbb{R}_{\geq 0} \rightarrow \mathbb{R}\)</span> 映射到最优投影系数 <span class="arithmatex">\(c: \mathbb{R}_{\geq 0} \rightarrow \mathbb{R}^N\)</span>，即 <span class="arithmatex">\((hippo(f))(t)=\operatorname{coef}_t(\operatorname{proj}_t(f))\)</span>。</mark></strong></p>
<p>对于每个 <span class="arithmatex">\(t\)</span>，最优投影 <span class="arithmatex">\(\operatorname{proj}_t(f)\)</span> 的问题由上述内积很好地定义，但天然计算是无法解决的。我们的推导 (附录 D) 将展示系数函数 <span class="arithmatex">\(c(t)=\operatorname{coef}_t(\operatorname{proj}_t(f))\)</span> 的形式为 <span class="arithmatex">\(\frac{d}{dt} c(t)=A(t)c(t)+B(t)f(t)\)</span>，其中 <span class="arithmatex">\(A(t) \in \mathbb{R}^{N \times N}， B(t) \in \mathbb{R}^{N \times 1}\)</span>。因此我们的结果展示了如何通过求解 ODE 或更具体地运行一个离散递推来在线高效地获得 <span class="arithmatex">\(c^{(t)}\)</span>。当离散化后，HiPPO 接收一个实数序列并产生一个 N 维向量序列。  </p>
<p>图 1 说明了在使用均匀测度时的整体框架。接下来，我们给出主要结果，展示了框架在几种具体实例下的 hippo 形式。</p>
<p><img alt="image.png" src="https://raw.githubusercontent.com/aletolia/Pictures/main/202403301442079.png" /></p>
<p>图 1:HiPPO 框架的说明。(1) 对于任何函数 <span class="arithmatex">\(f\)</span>，(2) 在每个时间 <span class="arithmatex">\(t\)</span>，都存在 <span class="arithmatex">\(f\)</span> 关于一个加权过去的测度 <span class="arithmatex">\(\mu^{(t)}\)</span> 在多项式空间上的一个最优投影 <span class="arithmatex">\(g^{(t)}\)</span>。(3) 对于适当选择的基，相应的表示 <span class="arithmatex">\(f\)</span> 历史压缩的系数 <span class="arithmatex">\(c(t) \in \mathbb{R}^N\)</span> 满足线性动力学。(4) 将这样的线性动态离散化，得到一个高效的闭式递推关系，用于在线压缩时间序列 <span class="arithmatex">\((f_k)_{k \in \mathbb{N}}\)</span>。</p>
<h3 id="23-hippo-odes">2.3 高阶投影: 测度族和 HiPPO ODEs<a class="headerlink" href="#23-hippo-odes" title="Permanent link">&para;</a></h3>
<p>我们的主要理论结果是 HiPPO 在各种测度族 <span class="arithmatex">\(\mu^{(t)}\)</span> 下的实例化。我们提供了两个自然的滑动窗口测度及其对应的投影算子的例子。对记忆机制的统一视角使我们能够以同样的策略 (见附录 D.1，D.2) 推导出这些闭式解。第一个以原则性的方式解释了核心的 Legendre 记忆单元 (LMU)[71] 更新，并描述了其局限性，而另一个是新颖的，展示了 HiPPO 框架的通用性。附录 D 对比了这些测度的权衡 (图 5)，包含了它们推导的证明，并推导了其他基 (如 Fourier，从而恢复 Fourier 循环单元 [79]) 和 Chebyshev) 的额外 HiPPO 公式。</p>
<p><strong><mark>平移 Legendre(LegT) 测度对最近历史 <span class="arithmatex">\([t-\theta, t]\)</span> 赋予均匀权重</mark></strong>。有一个超参数 <span class="arithmatex">\(\theta\)</span> 表示滑动窗口的长度，或被总结的历史长度。而平移 Laguerre(LagT) 测度则使用<strong>指数衰减测度，赋予更近期历史更高的重要性</strong>。</p>
<div class="arithmatex">\[
\text{LegT: } \mu^{(t)}(x)=\frac{1}{\theta} \mathbb{I}_{[t-\theta, t]}(x) \quad \text { LagT: } \mu^{(t)}(x)=e^{-(t-x)} \mathbb{I}_{(-\infty, t]}(x)= \begin{cases}e^{x-t} &amp; \text { if } x \leq t \\ 0 &amp; \text { if } x&gt;t\end{cases}
\]</div>
<p>定理 1.对于 LegT 和 LagT，满足定义 1 的 hippo 算子由线性时不变 (LTI) ODE <span class="arithmatex">\(\frac{d}{dt}c(t)=-Ac(t)+Bf(t)\)</span> 给出，其中 <span class="arithmatex">\(A \in \mathbb{R}^{N \times N}， B \in \mathbb{R}^{N \times 1}\)</span>:</p>
<p>LegT:</p>
<div class="arithmatex">\[
A_{nk}=\frac{1}{\theta}\left\{\begin{array}{ll}
(-1)^{n-k}(2n+1) &amp; \text { if } n \geq k \\
2n+1 &amp; \text { if } n \leq k
\end{array}, \quad B_n=\frac{1}{\theta}(2n+1)(-1)^n\right.
\]</div>
<p>LagT:</p>
<div class="arithmatex">\[
A_{nk}=\left\{\begin{array}{ll}
1 &amp; \text { if } n \geq k \\
0 &amp; \text { if } n&lt;k
\end{array}, \quad B_n=1\right.
\]</div>
<p>方程 (1) 证明了 LMU 更新 [71，方程 (1)]。另外，我们的推导 (附录 D.1) 表明除了投影之外，还有另一个逼近源。这个滑动窗口更新规则需要访问 <span class="arithmatex">\(f(t-\theta)\)</span>，而它已不再可用; 它假设当前系数 <span class="arithmatex">\(c(t)\)</span> 是函数 <span class="arithmatex">\(f(x)_{x \leq t}\)</span> 的足够精确模型，以至于 <span class="arithmatex">\(f(t-\theta)\)</span> 可以从中恢复。</p>
<h3 id="24-hippo-ode">2.4 HiPPO 递推关系: 从连续时间到离散时间通过 ODE 离散化<a class="headerlink" href="#24-hippo-ode" title="Permanent link">&para;</a></h3>
<p>由于实际数据本质上是离散的 (如序列和时间序列)，我们讨论如何使用标准技术对 HiPPO 投影算子进行离散化，以使连续时间 HiPPO ODE 成为离散时间线性递推关系。</p>
<p>在连续情况下，这些算子使用输入函数 <span class="arithmatex">\(f(t)\)</span> 并产生输出函数 <span class="arithmatex">\(c(t)\)</span>。离散时间情况 (i) 消费输入序列 <span class="arithmatex">\((f_k)_{k \in \mathbb{N}}\)</span>，(ii) 隐式定义一个函数 <span class="arithmatex">\(f(t)\)</span>，其中 <span class="arithmatex">\(f(k \cdot \Delta t)=f_k\)</span>，使用某个步长 <span class="arithmatex">\(\Delta t\)</span>，(iii) 通过 ODE 动力学产生函数 <span class="arithmatex">\(c(t)\)</span>，(iv) 离散回到输出序列 <span class="arithmatex">\(c_k:=c(k \cdot \Delta t)\)</span>。</p>
<p>离散化 ODE <span class="arithmatex">\(\frac{d}{dt}c(t)=u(t,c(t),f(t))\)</span> 的基本方法选择一个步长 <span class="arithmatex">\(\Delta t\)</span>，并执行离散更新 <span class="arithmatex">\(c(t+\Delta t)=c(t)+\Delta t \cdot u(t,c(t),f(t))\)</span>。一般来说，这个过程对离散化步长超参数 <span class="arithmatex">\(\Delta t\)</span> 是敏感的。</p>
<p>最后，我们注意到这提供了一种无缝处理带时间戳数据的方式，即使有缺失值: 时间戳之间的差异表示在离散化中使用的 (自适应)<span class="arithmatex">\(\Delta t\)</span>[13]。附录 B.3 包含了关于离散化的完整讨论。 </p>
<h3 id="25-rnn">2.5 低阶投影: 门控 RNN 的记忆机制<a class="headerlink" href="#25-rnn" title="Permanent link">&para;</a></h3>
<p>作为一个特例，我们考虑如果不在投影问题中纳入高阶多项式会发生什么。具体地，如果 <span class="arithmatex">\(N=1\)</span>，那么 HiPPO-LagT(2) 的离散版本就变成 <span class="arithmatex">\(c(t+\Delta t)=c(t)+\Delta t(-Ac(t)+Bf(t))=(1-\Delta t)c(t)+\Delta tf(t)\)</span>，因为 <span class="arithmatex">\(A=B=1\)</span>。<strong><u>如果输入 <span class="arithmatex">\(f(t)\)</span> 可以依赖隐藏状态 <span class="arithmatex">\(c(t)\)</span>，并且离散步长 <span class="arithmatex">\(\Delta t\)</span> 被自适应地选择 (作为输入 <span class="arithmatex">\(f(t)\)</span> 和状态 <span class="arithmatex">\(c(t)\)</span>​的函数)，如同 RNN 一样，那么这就精确成为一个门控 RNN</u></strong>。例如，通过并行堆叠多个单元并选择特定的更新函数，我们可以将 GRU 更新单元作为一个特例获得。与使用一个隐藏特征并将其投影到高阶多项式的 HiPPO 不同，这些模型使用许多隐藏特征但只将它们投影到次数 1。这种观点通过展示如何从第一原理推导出这些经典技术，揭示了对它们的新见解。</p>
<h2 id="3-hippo-legs">3 HiPPO-LegS: 经过缩放的测度以获得时间尺度稳健性<a class="headerlink" href="#3-hippo-legs" title="Permanent link">&para;</a></h2>
<p>揭示了在线函数逼近与记忆之间的紧密联系，使我们能够通过适当选择测度来产生具有更好理论性质的记忆机制。尽管滑动窗口在信号处理中很常见 (附录 A.1)，但对于记忆更直观的方法应随时间缩放窗口以避免遗忘。</p>
<p>我们新颖的经过缩放的 Legendre 测度 (LegS) 对所有历史 <span class="arithmatex">\([0, t]\)</span> 赋予均匀权重:<span class="arithmatex">\(\mu^{(t)}=\frac{1}{t} \mathbb{I}_{[0， t]}\)</span>。附录 D 图 5 以可视化的方式比较了 LegS、LegT 和 LagT，显示了缩放测度的优势。</p>
<p>简单地指定期望的测度，专门化 HiPPO 框架 (第 2.2 和 2.4 节) 就产生了一种新的记忆机制 (证明见附录 D.3)。  </p>
<p>定理 2. HiPPO-LegS 的连续时间 (3) 和离散时间 (4) 动力学为:</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{dt}c(t) &amp; =-\frac{1}{t}Ac(t)+\frac{1}{t}Bf(t)\\
c_{k+1} &amp; =\left(1-\frac{A}{k}\right)c_k+\frac{1}{k}Bf_k
\end{aligned}
\]</div>
<div class="arithmatex">\[
A_{nk}=\left\{\begin{array}{ll}
(2n+1)^{1/2}(2k+1)^{1/2} &amp; \text{if } n&gt;k\\
n+1 &amp; \text{if } n=k,\\
0 &amp; \text{if } n&lt;k
\end{array}\quad B_n=(2n+1)^{\frac{1}{2}}\right.
\]</div>
<p>我们证明 HiPPO-LegS 享有有利的理论性质: 它对输入时间尺度是不变的，计算快捷，并且梯度和逼近误差有界。所有证明见附录 E。</p>
<p>时间尺度稳健性。由于 LegS 的窗口大小是自适应的，投影到这个测度上在直觉上对时间尺度是稳健的。<strong><u>形式上，HiPPO-LegS 算子是时间尺度等变的: 扭曲输入 <span class="arithmatex">\(f\)</span> 不会改变逼近系数。</u></strong></p>
<p>命题 3.对任何标量 <span class="arithmatex">\(\alpha&gt;0\)</span>，如果 <span class="arithmatex">\(h(t)=f(\alpha t)\)</span>，那么 <span class="arithmatex">\(hippo(h)(t)=hippo(f)(\alpha t)\)</span>。换言之，如果 <span class="arithmatex">\(\gamma: t \mapsto \alpha t\)</span> 是任何扭曲函数，那么 <span class="arithmatex">\(hippo(f \circ \gamma)=hippo(f) \circ \gamma\)</span>。</p>
<p>非正式地说，HiPPO-LegS 没有时间尺度超参数反映了这一点; 特别是离散递归 (4) 对离散化步长是不变的。相比之下，LegT 有一个窗口大小超参数 <span class="arithmatex">\(\theta\)</span>，LegT 和 LagT 在离散时间情况下都有一个步长超参数 <span class="arithmatex">\(\Delta t\)</span>。这个超参数在实践中很重要; 第 2.5 节展示了 <span class="arithmatex">\(\Delta t\)</span> 与 RNN 的门控机制有关，已知后者对其参数化是敏感的 [31，39，66]。我们在第 4.2 节中实证了时间尺度稳健性的好处。</p>
<p>计算效率。为了计算 HiPPO 更新的单步，主要操作是乘以 (离散化的) 方阵 <span class="arithmatex">\(A\)</span>。更一般的离散化专门需要对任何形式 <span class="arithmatex">\(I+\Delta t \cdot A\)</span> 和 <span class="arithmatex">\((I-\Delta t \cdot A)^{-1}\)</span> 的矩阵进行快速乘法，其中 <span class="arithmatex">\(\Delta t\)</span> 为任意步长。尽管这在一般情况下是 <span class="arithmatex">\(O(N^2)\)</span> 操作，但 LegS 算子使用具有特殊结构的固定 <span class="arithmatex">\(A\)</span> 矩阵，事实证明对任何离散化都有快速乘法算法。</p>
<p>命题 4.在任何广义双线性变换离散化 (参见附录 B.3) 下，方程 (4) 中 HiPPO-LegS 递推的每一步可以在 <span class="arithmatex">\(O(N)\)</span> 操作下计算。</p>
<p>第 4.3 节验证了 HiPPO 层在实践中的效率，其中展开定理 2 的离散版本比标准 RNN 中的标准矩阵乘法快 10 倍。</p>
<p>梯度流。为了缓解 RNN 中的梯度消失问题 [56]，人们做了大量工作，其中基于反向传播的学习受到了梯度幅值随时间指数衰减的阻碍。由于 LegS 是为记忆而设计的，它避免了梯度消失问题。</p>
<p>命题 5.对于任何时间 <span class="arithmatex">\(t_0&lt;t_1\)</span>，HiPPO-LegS 算子在时间 <span class="arithmatex">\(t_1\)</span> 的输出相对于时间 <span class="arithmatex">\(t_0\)</span> 的输入的梯度范数为 <span class="arithmatex">\(\left\|\frac{\partial c(t_1)}{\partial f(t_0)}\right\|=\Theta(1/t_1)\)</span>。</p>
<p>逼近误差界。LegS 的误差率随输入的平滑性降低。  </p>
<p>命题 6.设 <span class="arithmatex">\(f: \mathbb{R}_+ \rightarrow \mathbb{R}\)</span> 为可微函数，在时间 <span class="arithmatex">\(t\)</span> 由最高多项式次数为 <span class="arithmatex">\(N-1\)</span> 的 HiPPO-LegS 投影为 <span class="arithmatex">\(g^{(t)}=proj_t(f)\)</span>。如果 <span class="arithmatex">\(f\)</span> 是 L-Lipschitz 的，那么 <span class="arithmatex">\(\|f_{\leq t}-g^{(t)}\|=O(tL/\sqrt{N})\)</span>。如果 <span class="arithmatex">\(f\)</span> 具有有界的 k 阶导数，那么 <span class="arithmatex">\(\|f_{\leq t}-g^{(t)}\|=O(t^kN^{-k+1/2})\)</span>。</p>
<h2 id="_3">相关工作<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="a1">A.1 信号处理和正交多项式<a class="headerlink" href="#a1" title="Permanent link">&para;</a></h3>
<h4 id="a11">A.1.1 滑动变换<a class="headerlink" href="#a11" title="Permanent link">&para;</a></h4>
<p>本文的技术贡献建立在信号处理中逼近理论的丰富历史之上。我们的主要框架——将函数正交化相对于时变测度 (第 2 节)——与经典信号处理变换的 " 在线 " 版本有关。简而言之,这些方法在离散序列的滑动窗口上计算特定的变换。具体地,给定信号 <span class="arithmatex">\((f_k)\)</span>,它们计算 <span class="arithmatex">\(c_{n,k}=\sum_{i=0}^{N-1} f_{k+i} \psi(i, n)\)</span>,其中 <span class="arithmatex">\(\{\psi(i, n)\}\)</span> 是一个离散正交变换。我们的技术问题在几个关键方面有所不同:</p>
<p><strong>特定的离散变换</strong>：文献中考虑的滑动变换的例子包括滑动 DFT[26, 28, 36, 37]、滑动 DCT[43]、滑动离散 (Walsh-)Hadamard 变换 [54, 55, 75]、Haar[51]、滑动离散 Hartley 变换 [44] 和滑动离散 Chebyshev 矩 [12]。虽然每一个都解决了一个特定的变换,但我们提出了一种通用方法 (第 2 节),一次解决了几种变换。此外,我们没有发现针对我们在这里考虑的正交多项式 (特别是 Legendre 和 Laguerre 多项式) 的滑动变换算法。我们在附录 D 中的推导涵盖了 Legendre、(广义)Laguerre、Fourier 和 Chebyshev 连续滑动变换。</p>
<p><strong>固定长度滑动窗口</strong>：所有提及的工作都在滑动窗口设置中进行,即考虑离散信号上的固定大小上下文窗口。我们基于测度的逼近抽象允许考虑一种新型的经过缩放的测度,其中窗口大小随时间增加,导致了理论 (第 3 节) 和实证 (第 4.2 节) 性质质量不同的方法。我们没有发现任何先前解决这种缩放设置的工作。</p>
<p><strong>离散与连续时间</strong>：即使在固定长度滑动窗口的情况下,我们对 " 平移测度 " 问题 (例如 HiPPO-LegT,附录 D.1) 的解也是在潜在的连续信号上解决了一个连续时间滑动窗口问题,然后离散化。</p>
<p>另一方面,滑动变换问题直接在离散流上计算变换。<strong><u>离散变换等价于通过高斯求积在测度上 (方程 (18)) 计算投影系数,它假设离散输入是从求积节点处的信号中子采样得到的 [14]</u></strong>。然而,由于这些节点在一般情况下是不均匀间隔的,因此滑动离散变换与对潜在连续信号的离散化是不一致的。</p>
<p>因此,我们的主要抽象 (定义 1) 与标准变换有着根本不同的解释,我们首先计算潜在的连续时间问题 (如方程 (20)) 的动力学的方法也因此是新颖的。我们注意到,使用基于标准离散时间的方法来处理我们新颖的缩放测度是 fundamentally 有困难的。这些离散滑动方法需要固定大小的上下文,以便具有一致的变换尺寸,而缩放测度则需要随时间解决输入点数量增加的变换。</p>
<h4 id="a12-ml">A.1.2 ML 中的正交多项式<a class="headerlink" href="#a12-ml" title="Permanent link">&para;</a></h4>
<p>更广泛地说,正交多项式和正交多项式变换最近在机器学习的各个方面都有应用。例如,Dao 等人 [19] 利用正交多项式与求积之间的联系,推导出计算机器学习中核函数特征的规则。更直接地,[67] 将受正交多项式变换 ([22]) 直接启发的参数化结构矩阵族作为神经网络的层进行应用。某些特定的正交多项式族如 Chebyshev 多项式在数值分析和优化中有许多已知的经典用途,因为它们具有理想的逼近性质。<strong><u>最近,它们被应用到图卷积神经网络 [24] 等 ML 模型中,且其推广形式如 Gegenbauer 和 Jacobi 多项式已被用于分析优化动力学</u></strong> [7, 76]。表示为蝴蝶矩阵乘积的正交多项式和 Fourier 变换的推广已经在自动算法设计 [20]、模型压缩 [1] 以及替代语音识别中的手工预处理 [21] 中找到了应用。正交多项式已知具有各种效率结果 [22],我们猜测 HiPPO 方法的效率性质 (命题 4) 可以推广到除本文考虑之外的任意测度。</p>
<h3 id="a2">A.2 机器学习中的记忆<a class="headerlink" href="#a2" title="Permanent link">&para;</a></h3>
<p><strong>序列模型中的记忆</strong>：在语言、强化学习和持续学习等领域,序列或时间数据可能涉及越来越长的依赖关系。然而,直接的参数化建模无法处理长度未知和可能无界的输入。许多现代解决方案,如注意力 [70] 和扩张卷积 [5],都是在有限窗口上的函数,因此避免了对显式记忆表示的需求。虽然这对于某些任务是足够的,但这些方法只能处理有限的上下文窗口,而不是整个序列。直接增加窗口长度会带来重大的计算和内存挑战。这促生了各种在计算和存储受限的情况下扩展这个固定上下文窗口的方法 [6,15,18,42,59,60,64,74]。</p>
<p>我们转而关注连续和离散信号的在线处理和记忆化这一核心问题,并期望研究这个基础性问题将有助于改进各种模型。</p>
<p><strong>循环记忆</strong>：循环神经网络是在线对序列数据建模的自然工具,具有无界上下文的吸引力,换言之,它们可以无限总结历史。然而,由于优化过程中的困难 (梯度消失/爆炸 [56]),必须特别注意赋予它们更长的记忆。无处不在的 LSTM[34] 和 GRU[17] 等简化形式使用门控制更新以平滑优化过程。通过更精心的参数化,单单增加门控就使 RNN 显著更加稳健并能够解决长期依赖问题 [31]。Tallec 和 Ollivier[66] 表明,门控实际上对循环动力学是基本的,因为它们允许时间扩张。赋予 RNN 更好记忆的其他方法还包括注入噪声 [32] 或非饱和门 [9],但可能存在不稳定性问题。有一系列工作通过 (近似) 正交矩阵来控制循环更新的谱以控制梯度 [3],但被发现在不同任务中的稳健性较差 [33]。</p>
<h3 id="a3">A.3 直接相关的方法<a class="headerlink" href="#a3" title="Permanent link">&para;</a></h3>
<p>LMU Legendre 记忆单元 [71,72,73] 的主要结果是使用 LegT 测度 (第 2.3 节) 对我们框架的一个直接实例。最初的 LMU 受神经生物学进展的启发,从与我们相反的方向来解决这个问题: 它考虑在频域中逼近脉冲神经元,而我们直接在时域中解决一个可解释的优化问题。更具体地说,他们考虑了时滞线性时不变 (LTI) 动力系统,并用 Padé近似展开来逼近动力学;Voelker 等人 [71] 观察到结果也可以用 Legendre 多项式来解释,但没有意识到它是一个自然投影问题的最优解。这种方法涉及更重的机器,我们无法找到对更新机制的完整证明 [71,72,73]。</p>
<p>相比之下,我们的方法直接提出了相关的在线信号逼近问题,这与正交多项式族有关,并导出了几种相关记忆机制的简单推导 (附录 D)。我们在时域而不是频域的解释,以及对 LegT 测度的相关推导 (附录 D.1),揭示了源于滑动窗口的一组不同的逼近,这在实证上得到了确认 (附录 F.8)。</p>
<p>由于我们工作的动机与 Voelker 等人 [71] 有实质不同,但在特殊情况下找到了相同的记忆机制,我们强调将这些序列模型与生物神经系统之间的潜在联系作为未来工作的一个探索方向,例如在频域中对我们方法的替代解释。</p>
<p>我们注意到,LMU 一词实际上是指一种特定的循环神经网络架构,它将投影算子与其他特定的神经网络组件交织在一起。相比之下,我们使用 HiPPO 来指代单独的投影算子 (定理 1),它是一个与模型无关的函数到函数或序列到序列的算子。HiPPO 被集成到第 4 节的 RNN 架构中,对 LMU 架构做了轻微改进,如附录 F.2 和 F.3 中的消融实验所示。作为一个独立的模块,HiPPO 可以用作其他类型模型中的一个层。</p>
<h4 id="_4">傅立叶循环单元<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>傅立叶循环单元（FRU）[79] 使用傅立叶基（余弦和正弦）来表示输入信号，其灵感来自离散傅立叶变换。具体来说，每个循环单元计算输入信号关于随机选择的频率的离散傅立叶变换。目前尚不清楚如何利用关于其他基（例如 Legendre、Laguerre、Chebyshev）的离散变换来产生类似的记忆机制。我们证明了 FRU 也是 HiPPO 框架的一种实例（附录 D.4），其中傅立叶基可以被视为单位圆上的正交多项式 <span class="arithmatex">\(z^n\)</span>。Zhang 等人[79] 证明了，如果选择合适的时间尺度超参数，FRU 具有有界梯度，从而避免了梯度消失和梯度爆炸。这主要是因为如果选择了离散化步长 <span class="arithmatex">\(\Delta t=\Theta\left(\frac{1}{T}\right)\)</span>，并且时间跨度 <span class="arithmatex">\(T\)</span> 已知，则 <span class="arithmatex">\((1-\Delta t)^T=\Theta(1)\)</span>（见附录 B. 3 和 E）。很容易证明，这个属性不是 FRU 固有的，而是滑动窗口方法的属性，并且我们所有转换的 HiPPO 方法都共享这个属性（附录 (D) 除外）。我们展示了更强的属性，即 HiPPO-LegS，它使用缩放而不是滑动窗口，也享有有界梯度保证，而不需要一个良好指定的时间尺度超参数（命题 5）。</p>
<h4 id="odes">神经 ODEs<a class="headerlink" href="#odes" title="Permanent link">&para;</a></h4>
<p><strong><u>HiPPO 产生描述系数动态的线性 ODEs</u></strong>。最近的工作还将 ODEs 纳入了机器学习模型中。Chen 等人[13] 引入了神经 ODEs，利用神经网络参数化的一般非线性 ODEs 在正规化流和时间序列建模的背景下。神经 ODEs 在建模不规则采样时间序列方面表现出有希望的结果[40]，尤其是与 RNNs[61] 结合使用时。尽管神经 ODEs 很具表现力[27, 78]，由于其复杂的参数化，它们通常在训练过程中速度较慢[29, 53, 58]，因为它们需要更复杂的 ODE 求解器。<strong><u>另一方面，HiPPO ODEs 是线性的，并且可以利用线性系统中的经典离散化技术（如欧拉方法、双线性方法和零阶保持（ZOH））快速求解[35]。</u></strong></p>
<h3 id="b">B 技术准备工作<a class="headerlink" href="#b" title="Permanent link">&para;</a></h3>
<p>我们在这里收集了一些技术背景，将用于介绍通用的 HiPPO 框架并推导特定的 HiPPO 更新规则。</p>
<h4 id="b1">B.1 正交多项式<a class="headerlink" href="#b1" title="Permanent link">&para;</a></h4>
<p>正交多项式是处理函数空间的标准工具[14,65]。<strong><u><mark>每个测度 <span class="arithmatex">\(\mu\)</span> 引导出一个唯一的（至标量倍数）正交多项式（OPs）序列 <span class="arithmatex">\(P_0(x), P_1(x), \ldots\)</span>，满足 <span class="arithmatex">\(\operatorname{deg}\left(P_i\right)=i\)</span> 和 <span class="arithmatex">\(\left\langle P_i, P_j\right\rangle_\mu:=\int P_i(x) P_j(x) \mathrm{d} \mu(x)=0\)</span></mark></u></strong>，对于所有 <span class="arithmatex">\(i \neq j\)</span>。这是通过对于 <span class="arithmatex">\(\langle\cdot,\rangle_\mu\)</span> 进行格拉姆 - 施密特正交化得到的多项式基 <span class="arithmatex">\(\left\{x^i\right\}\)</span> 的序列。OPs 形成正交基的事实很有用，因为用来近似函数 <span class="arithmatex">\(f\)</span> 的最佳正交多项式 <span class="arithmatex">\(g(\deg(g)&lt;N)\)</span> 可以通过如下方式给出：
$$
\sum_{i=0}^{N-1} c_i P_i(x) /\left|P_i\right|<em>\mu^2 \quad \text { 其中 } c_i=\left\langle f, P_i\right\rangle</em>\mu=\int f(x) P_i(x) \mathrm{d} \mu(x) .
$$</p>
<p>经典的 OPs 族包括 Jacobi（包括 Legendre 和 Chebyshev 多项式作为特例）、Laguerre 和 Hermite 多项式。傅立叶基也可以解释为复平面中单位圆上的 OPs。</p>
<blockquote>
<p>在数学中，测度是一种将几何空间的测度 (长度、面积、体积) 和其他常见概念 (如大小、质量和事件的概率) 广义化后产生的概念。传统的黎曼积分是在区间上进行的，为了把积分推广到更一般的集合上，人们就发展出测度的概念。一个特别重要的例子是勒贝格测度，它从 <span class="arithmatex">\(n\)</span> 维欧式空间 <span class="arithmatex">\(\mathbb{R}^n\)</span> 出发，概括了传统长度、面积和体积等等的概念。</p>
<p>研究测度的学问被统称为测度论，因为指定的数值通常是非负实数，所以测度论通常会被视为实分析的一个分支，它在数学分析和概率论有重要的地位。</p>
<p><strong>正式定义</strong> </p>
<p>定义 <span class="arithmatex">\(-(X, \Sigma)\)</span> 为可测空间，函数 <span class="arithmatex">\(\mu: \Sigma \rightarrow[0, \infty)\)</span> 若满足:</p>
<ul>
<li><span class="arithmatex">\(\mu(\varnothing)=0\)</span> (空集合的测度为零)</li>
<li>可数可加性 <span class="arithmatex">\(\left(\sigma\right.\)</span>-可加性)：若集合序列 <span class="arithmatex">\(\left\{E_n \in \Sigma\right\}_{n \in \mathbb{N}}\)</span> 对所有不相等正整数 <span class="arithmatex">\(i \neq j\)</span> 都有 <span class="arithmatex">\(E_i \cap E_j=\varnothing\)</span> ，则</li>
</ul>
<div class="arithmatex">\[
\mu\left(\bigcup_{n \in \mathbb{N}} E_n\right)=\sum_{n=1}^{\infty} \mu\left(E_n\right) 。
\]</div>
<p>那 <span class="arithmatex">\(\mu\)</span> 被称为定义在 <span class="arithmatex">\(\Sigma\)</span> 上的一个非负测度，或简称为测度。为了叙述简便起见，也可称 <span class="arithmatex">\((X, \Sigma, \mu)\)</span>​ 为一测度空间。</p>
<p>直观上，测度是 "体积” 的推广；因为空集合的 “体积" 当然为零，而且互相独立的一群 (可数个) 物体，总 “体积" 当然要是所有物体 “体积 <span class="arithmatex">\({ }^n\)</span> 直接加总 (的极限) 。而要定义 “体积"，必须先要决定怎样的一群子集合，是 “可以测量的"，详细请见 <span class="arithmatex">\(\sigma\)</span>-代数。</p>
<p>如果将 <span class="arithmatex">\(\mu\)</span> 的值域扩展到复数，也就是说 <span class="arithmatex">\(\mu: \Sigma \rightarrow \mathbb{C}\)</span> ，那 <span class="arithmatex">\(\mu\)</span> 会被进一步称为复数测度。 <span class="arithmatex">\({ }^{\text {[1] }}\)</span></p>
<p>定义的分歧</p>
<p>若照着上述定义，根据可数可加性，不少母集合本身的测度值会变成无穷大 (如对 <span class="arithmatex">\(\mathbb{R}^n\)</span> 本身取勒贝格测度)，所以实际上不存在。但某些书籍 <span class="arithmatex">\({ }^{[2]}\)</span>​​ 会形式上将无穷大视为一个数，而容许测度取值为无穷大；这样定义的书籍，会把只容许有限实数值的测度称为 (非负) 有限测度。但这样"定义"，会造成可数可加性与数列收敛的定义产生矛盾。</p>
<p>所以要延续体积是一种 " 测度 " 的这种直观概念（也就是严谨的定义勒贝格测度），那就必须把 <span class="arithmatex">\(\sigma\)</span>-代数换成条件比较宽松的半集合环，然后以此为基础去定义一个对应到 " 体积" 的前测度。</p>
<p>更进一步的，如果对测度空间 <span class="arithmatex">\((X, \Sigma, \mu)\)</span> 来说，母集合 <span class="arithmatex">\(X\)</span> 可表示为 <span class="arithmatex">\(\Sigma\)</span> 内的某可测集合序列 <span class="arithmatex">\(\left\{E_n \in \Sigma\right\}_{n \in \mathbb{N}}\)</span>​ 的并集：
$$
X=\bigcup_{n \in \mathbb{N}} E_n
$$</p>
<p>且 <span class="arithmatex">\(\mu\)</span> 只容许取有限值，则 <span class="arithmatex">\(\mu\)</span> 会被进一步的称为 (非负) <span class="arithmatex">\(\sigma\)</span>​-有限测度。</p>
<p>单调性 </p>
<p>测度 <span class="arithmatex">\(\mu\)</span> 的单调性：若 <span class="arithmatex">\(E_1\)</span> 和 <span class="arithmatex">\(E_2\)</span> 为可测集，而且 <span class="arithmatex">\(E_1 \subseteq E_2\)</span> ，则 <span class="arithmatex">\(\mu\left(E_1\right) \leq \mu\left(E_2\right)\)</span> 。</p>
<p><strong>可数个可测集的并集的测度</strong></p>
<p>若 <span class="arithmatex">\(E_1, E_2, E_3 \cdots\)</span> 为可测集 (不必是两两不交的)，则集合 <span class="arithmatex">\(E_n\)</span>​ 的并集是可测的，且有如下不等式（“次可列可加性"）：</p>
<div class="arithmatex">\[
\mu\left(\bigcup_{i=1}^{\infty} E_i\right) \leq \sum_{i=1}^{\infty} \mu\left(E_i\right)
\]</div>
<p>如果还满足并且对于所有的 <span class="arithmatex">\(n ， E_n \subseteq E_{n+1}\)</span> ，则如下极限式成立:</p>
<div class="arithmatex">\[
\mu\left(\bigcup_{i=1}^{\infty} E_i\right)=\lim _{i \rightarrow \infty} \mu\left(E_i\right) .
\]</div>
<p><strong>可数个可测集的交集的测度</strong> </p>
<p>若 <span class="arithmatex">\(E_1, E_2, \cdots\)</span> 为可测集，并且对于所有的 <span class="arithmatex">\(n ， E_{n+1} \subseteq E_n\)</span> ，则 <span class="arithmatex">\(E_n\)</span> 的交集是可测的。进一步说，如果至少一个 <span class="arithmatex">\(E_n\)</span>​ 的测度有限，则有极限：</p>
<div class="arithmatex">\[
\mu\left(\bigcap_{i=1}^{\infty} E_i\right)=\lim _{i \rightarrow \infty} \mu\left(E_i\right)
\]</div>
<p>如若不假设至少一个 <span class="arithmatex">\(E_n\)</span> 的测度有限，则上述性质一般不成立。例如对于每一个 <span class="arithmatex">\(n \in \mathbb{N}\)</span> ，令</p>
<div class="arithmatex">\[
E_n=[n, \infty) \subseteq \mathbb{R}
\]</div>
<p>这里，全部集合都具有无限测度，但它们的交集是空集。</p>
</blockquote>
<h5 id="b11-legendre">B.1.1 Legendre 多项式的性质<a class="headerlink" href="#b11-legendre" title="Permanent link">&para;</a></h5>
<p>Legendre 多项式 根据标准定义的规范 Legendre 多项式 <span class="arithmatex">\(P_n\)</span>，它们相对于测度 <span class="arithmatex">\(\omega^{\text {leg }}=1_{[-1,1]}\)</span> 是正交的：</p>
<div class="arithmatex">\[
\frac{2 n+1}{2} \int_{-1}^1 P_n(x) P_m(x) \mathrm{d} x=\delta_{n m}\tag{5}
\]</div>
<p>同样，它们满足</p>
<div class="arithmatex">\[
\begin{aligned}
P_n(1) &amp; =1 \\
P_n(-1) &amp; =(-1)^n .
\end{aligned}
\]</div>
<p>移位和缩放的 Legendre 多项式 我们还将考虑将 Legendre 多项式缩放到在区间 <span class="arithmatex">\([0, t]\)</span> 上是正交的。对（5）进行变量替换得到</p>
<div class="arithmatex">\[
\begin{aligned}
(2 n+1) \int_0^t P_n\left(\frac{2 x}{t}-1\right) P_m\left(\frac{2 x}{t}-1\right) \frac{1}{t} \mathrm{~dx} &amp; =(2 n+1) \int P_n\left(\frac{2 x}{t}-1\right) P_m\left(\frac{2 x}{t}-1\right) \omega^{\operatorname{leg}}\left(\frac{2 x}{t}-1\right) \frac{1}{t} \mathrm{~d} x \\
&amp; =\frac{2 n+1}{2} \int P_n(x) P_m(x) \omega^{\operatorname{leg}}(x) \mathrm{d} x \\
&amp; =\delta_{n m} .
\end{aligned}
\]</div>
<p>因此，相对于测度 <span class="arithmatex">\(\omega_t=1_{[0, t]} / t\)</span>（对于所有 <span class="arithmatex">\(t\)</span>，这是一个概率测度），归一化的正交多项式是</p>
<div class="arithmatex">\[
(2 n+1)^{1 / 2} P_n\left(\frac{2 x}{t}-1\right) .
\]</div>
<p>类似地，基</p>
<div class="arithmatex">\[
(2 n+1)^{1 / 2} P_n\left(2 \frac{x-t}{\theta}+1\right)
\]</div>
<p>对于均匀测度 <span class="arithmatex">\(\frac{1}{\theta} \mathbb{I}_{[t-\theta, t]}\)</span> 也是正交的。</p>
<p>一般来说，对于任何均匀测度，正交基包括 <span class="arithmatex">\((2 n+1)^{\frac{1}{2}}\)</span> 乘以相应的线性平移版本的 <span class="arithmatex">\(P_n\)</span>​。</p>
<p>Legendre 多项式的导数 我们注意到 Legendre 多项式的以下递推关系（[2, Chapter 12]）：</p>
<div class="arithmatex">\[
\begin{aligned}
(2 n+1) P_n &amp; =P_{n+1}^{\prime}-P_{n-1}^{\prime} \\
P_{n+1}^{\prime} &amp; =(n+1) P_n+x P_n^{\prime}
\end{aligned}
\]</div>
<p>第一个方程得到</p>
<div class="arithmatex">\[
P_{n+1}^{\prime}=(2 n+1) P_n+(2 n-3) P_{n-2}+\ldots,\tag{6}
\]</div>
<p>其中求和停在 <span class="arithmatex">\(P_0\)</span> 或 <span class="arithmatex">\(P_1\)</span>​。</p>
<p>这些方程直接意味着</p>
<div class="arithmatex">\[
P_n^{\prime}=(2 n-1) P_{n-1}+(2 n-5) P_{n-3}+\ldots\tag{7}
\]</div>
<p>和</p>
<div class="arithmatex">\[
\begin{aligned}
(x+1) P_n^{\prime}(x) &amp; =P_{n+1}^{\prime}+P_n^{\prime}-(n+1) P_n \\
&amp; =n P_n+(2 n-1) P_{n-1}+(2 n-3) P_{n-2}+\ldots .
\end{aligned}\tag{8}
\]</div>
<p>这些将在 HiPPO-LegT 和 HiPPO-LegS 更新的推导中使用。</p>
<h5 id="b12-laguerre">B.1.2 Laguerre 多项式的性质<a class="headerlink" href="#b12-laguerre" title="Permanent link">&para;</a></h5>
<p>标准的 Laguerre 多项式 <span class="arithmatex">\(L_n(x)\)</span> 被定义为相对于权函数 <span class="arithmatex">\(e^{-x}\)</span> 在 <span class="arithmatex">\([0, \infty\)</span> ) 上是正交的，而广义 Laguerre 多项式（也称为关联 Laguerre 多项式）<span class="arithmatex">\(L_n^{(\alpha)}\)</span> 被定义为相对于权函数 <span class="arithmatex">\(x^\alpha e^{-x}\)</span> 在 <span class="arithmatex">\([0, \infty)\)</span> 上是正交的：</p>
<div class="arithmatex">\[
\int_0^{\infty} x^\alpha e^{-x} L_n^{(\alpha)}(x) L_m^{(\alpha)}(x) \mathrm{d} x=\frac{(n+\alpha) !}{n !} \delta_{n, m} \tag{9}
\]</div>
<p>此外，它们满足</p>
<div class="arithmatex">\[
L_n^{(\alpha)}(0)=\left(\begin{array}{c}
n+\alpha \\
n
\end{array}\right)=\frac{\Gamma(n+\alpha+1)}{\Gamma(n+1) \Gamma(\alpha+1)} .\tag{10}
\]</div>
<p>标准的 Laguerre 多项式对应于广义 Laguerre 多项式的 <span class="arithmatex">\(\alpha=0\)</span>​ 的情况。</p>
<p>广义 Laguerre 多项式的导数 我们注意到广义 Laguerre 多项式的以下递推关系（[2, Chapter 13.2]）：</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\mathrm{d}}{\mathrm{d} x} L_n^{(\alpha)}(x) &amp; =-L_{n-1}^{(\alpha+1)}(x) \\
L_n^{(\alpha+1)}(x) &amp; =\sum_{i=0}^n L_i^{(\alpha)}(x) .
\end{aligned}
\]</div>
<p>这些方程意味着</p>
<div class="arithmatex">\[
\frac{d}{d t} L_n^{(\alpha)}(x)=-L_0^{(\alpha)}(x)-L_1^{(\alpha)}(x)-\cdots-L_{n-1}^{(\alpha)}(x) .
\]</div>
<h5 id="b13-chebyshev">B.1.3 Chebyshev 多项式的性质<a class="headerlink" href="#b13-chebyshev" title="Permanent link">&para;</a></h5>
<p>设 <span class="arithmatex">\(T_n\)</span> 为经典的 Chebyshev 多项式（第一类），定义为相对于权函数 <span class="arithmatex">\(\left(1-x^2\right)^{1 / 2}\)</span> 在 <span class="arithmatex">\([-1,1]\)</span> 上是正交的，并且 <span class="arithmatex">\(p_n\)</span> 是 <span class="arithmatex">\(T_n\)</span> 的归一化版本（即，其范数为 1）：</p>
<div class="arithmatex">\[
\begin{aligned}
&amp; \omega^{\text {cheb }}=\left(1-x^2\right)^{-1 / 2} \mathbb{I}_{(-1,1)}, \\
&amp; p_n(x)=\sqrt{\frac{2}{\pi}} T_n(x) \quad \text { 对于 } n \geq 1, \\
&amp; p_0(x)=\frac{1}{\sqrt{\pi}} .
\end{aligned}
\]</div>
<p>注意 <span class="arithmatex">\(\omega^{\text {cheb }}\)</span> 并非归一化（其积分为 <span class="arithmatex">\(\pi\)</span>）。</p>
<p><strong>Chebyshev 多项式的导数</strong> Chebyshev 多项式满足</p>
<div class="arithmatex">\[
2 T_n(x)=\frac{1}{n+1} \frac{d}{d x} T_{n+1}(x)-\frac{1}{n-1} \frac{d}{d x} T_{n-1}(x) \quad n=2,3, \ldots
\]</div>
<p>通过将这个级数进行折叠，我们得到</p>
<div class="arithmatex">\[
\frac{1}{n} T_n^{\prime}=\left\{\begin{array}{ll}
2\left(T_{n-1}+T_{n-3}+\cdots+T_2\right)+T_0 &amp; n \text { 是奇数 } \\
2\left(T_{n-1}+T_{n-3}+\cdots+T_1\right) &amp; n \text { 是偶数 }
\end{array} .\right.\tag{11}
\]</div>
<p><strong>Translated Chebyshev 多项式</strong> 我们还将考虑将 Chebyshev 多项式进行平移和缩放，<mark><strong>使其在固定长度 <span class="arithmatex">\(\theta\)</span> 的区间 <span class="arithmatex">\([t-\theta, t]\)</span> 上是正交的。</strong></mark>
<mark>**归一化（概率）测度为</mark>**</p>
<div class="arithmatex">\[
\omega(t, x)=\frac{2}{\theta \pi} \omega^{\text {cheb }}\left(\frac{2(x-t)}{\theta}+1\right)=\frac{1}{\theta \pi}\left(\frac{x-t}{\theta}+1\right)^{-1 / 2}\left(-\frac{x-t}{\theta}\right)^{-1 / 2} \mathbb{I}_{(t-\theta, t)} .
\]</div>
<p>正交多项式基为</p>
<div class="arithmatex">\[
p_n(t, x)=\sqrt{\pi} p_n\left(\frac{2(x-t)}{\theta}+1\right) .
\]</div>
<p>用原始的 Chebyshev 多项式表示，这些是</p>
<div class="arithmatex">\[
\begin{aligned}
p_n(t, x) &amp; =\sqrt{2} T_n\left(\frac{2(x-t)}{\theta}+1\right) \quad \text { 对于 } n \geq 1, \\
p_0^{(t)} &amp; =T_0\left(\frac{2(x-t)}{\theta}+1\right) .
\end{aligned}
\]</div>
<h4 id="b2">B.2 莱布尼茨积分法则<a class="headerlink" href="#b2" title="Permanent link">&para;</a></h4>
<p>作为推导 HiPPO 更新规则的标准策略的一部分（附录 C），我们将会对具有变化限制的积分进行微分。例如，当分析缩放的 Legendre（LegS）测度时，我们可能希望对表达式 <span class="arithmatex">\(\int f(t, x) \mu(t, x) \mathrm{d} x=\int_0^t f(t, x) \frac{1}{t} \mathrm{~d} x\)</span> 关于 <span class="arithmatex">\(t\)</span> 进行微分。</p>
<p>通过这样的积分进行微分可以通过莱布尼茨积分法则进行形式化，其基本版本如下：</p>
<div class="arithmatex">\[
\frac{\partial}{\partial t} \int_{\alpha(t)}^{\beta(t)} f(x, t) \mathrm{d} x=\int_{\alpha(t)}^{\beta(t)} \frac{\partial}{\partial t} f(x, t) \mathrm{d} x-\alpha^{\prime}(t) f(\alpha(t), t)+\beta^{\prime}(t) f(\beta(t), t) .
\]</div>
<p>在我们的推导中（附录 <span class="arithmatex">\([\mathrm{D})\)</span>），我们省略了正式的方法，而是使用以下技巧。我们用指示函数替换被积函数的限制；并在微分时使用狄拉克 δ 函数 <span class="arithmatex">\(\delta\)</span>（即，使用分布导数的形式）。例如，可以使用此技巧简洁地推导上述公式：</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial t} \int_{\alpha(t)}^{\beta(t)} f(x, t) \mathrm{d} x &amp; =\frac{\partial}{\partial t} \int f(x, t) \mathbb{I}_{[\alpha(t), \beta(t)]}(x) \mathrm{d} x \\
&amp; =\int \frac{\partial}{\partial t} f(x, t) \mathbb{I}_{[\alpha(t), \beta(t)]}(x) \mathrm{d} x+\int f(x, t) \frac{\partial}{\partial t} \mathbb{I}_{[\alpha(t), \beta(t)]}(x) \mathrm{d} x \\
&amp; =\int \frac{\partial}{\partial t} f(x, t) \mathbb{I}_{[\alpha(t), \beta(t)]}(x) \mathrm{d} x+\int f(x, t)\left(\beta^{\prime}(t) \delta_{\beta(t)}(x)-\alpha^{\prime}(t) \delta_{\alpha(t)}\right)(x) \mathrm{d} x \\
&amp; =\int_{\alpha(t)}^{\beta(t)} \frac{\partial}{\partial t} f(x, t) \mathrm{d} x-\alpha^{\prime}(t) f(\alpha(t), t)+\beta^{\prime}(t) f(\beta(t), t)
\end{aligned}
\]</div>
<h4 id="b3-ode">B.3 ODE 离散化<a class="headerlink" href="#b3-ode" title="Permanent link">&para;</a></h4>
<p>在我们的框架中，时间序列输入将以连续函数的形式进行建模，然后进行离散化。这里我们提供一些有关 ODE 离散化方法的背景知识，包括一种新的离散化方法，适用于我们的新方法遇到的特定类型的 ODE。</p>
<p>ODE 的一般形式为 <span class="arithmatex">\(\frac{d}{d t} c(t)=f(t, c(t))\)</span>。我们还将关注形式为 <span class="arithmatex">\(\frac{d}{d t} c(t)=A c(t)+B f(t)\)</span> 的线性时不变 ODE，作为一种特殊情况。对 ODE 进行离散化的一般方法，对于步长 <span class="arithmatex">\(\Delta t\)</span>​，是将 ODE 重新写为</p>
<div class="arithmatex">\[
c(t+\Delta t)-c(t)=\int_t^{t+\Delta t} f(s, c(s)) \mathrm{d} s，\tag{12}
\]</div>
<p>然后近似 RHS 积分。许多 ODE 离散化方法对应于近似 RHS 积分的不同方式：</p>
<p>欧拉法（也称为前向欧拉）。为了近似方程（12）的 RHS，保留左端点 <span class="arithmatex">\(\Delta t f(t, c(t))\)</span>。对于线性 ODE，我们得到：</p>
<div class="arithmatex">\[
c(t+\Delta t)=(I+\Delta t A) c(t)+\Delta t B f(t)。
\]</div>
<p>反向欧拉。为了近似方程（12）的 RHS，保留右端点 <span class="arithmatex">\(\Delta t f(t+\Delta t, c(t+\Delta t))\)</span>。对于线性 ODE，我们得到线性方程和更新：</p>
<div class="arithmatex">\[
\begin{aligned}
c(t+\Delta t)-\Delta t A c(t+\Delta t) &amp; =c(t)+\Delta t B f(t) \\
c(t+\Delta t) &amp; =(I-\Delta t A)^{-1} c(t)+\Delta t(I-\Delta t A)^{-1} B f(t)。
\end{aligned}
\]</div>
<p>双线性（又称梯形法则、Tustin 方法）。为了近似方程（12）的 RHS，对端点取平均 <span class="arithmatex">\(\Delta t \frac{f(t, c(t))+f(t+\Delta t, c(t+\Delta t))}{2}\)</span>。对于线性 ODE，我们再次得到线性方程和更新：</p>
<div class="arithmatex">\[
\begin{aligned}
c(t+\Delta t)-\frac{\Delta t}{2} A c(t+\Delta t) &amp; =(I+\Delta t / 2 A) c(t)+\Delta t B f(t) \\
c(t+\Delta t) &amp; =(I-\Delta t / 2 A)^{-1}(I+\Delta t / 2 A) c(t)+\Delta t(I-\Delta t / 2 A)^{-1} B f(t)。
\end{aligned}
\]</div>
<p>广义双线性变换（GBT）。这种方法 [77] 通过对端点的加权平均 <span class="arithmatex">\(\Delta t[(1-\alpha) f(t, c(t))+\alpha f(t+\Delta t, c(t+\Delta t))]\)</span> 来近似方程（12）的 RHS，其中 <span class="arithmatex">\(\alpha \in[0,1]\)</span>。对于线性 ODE，我们再次得到线性方程和更新：</p>
<div class="arithmatex">\[
\begin{aligned}
c(t+\Delta t)-\Delta t \alpha A c(t+\Delta t) &amp; =(I+\Delta t(1-\alpha) A) c(t)+\Delta t B f(t) \\
c(t+\Delta t) &amp; =(I-\Delta t \alpha A)^{-1}(I+\Delta t(1-\alpha) A) c(t)+\Delta t(I-\Delta t \alpha A)^{-1} B f(t)。
\end{aligned}
\]</div>
<p>GBT 推广了上述提到的三种方法：前向欧拉对应于 <span class="arithmatex">\(\alpha=0\)</span>，反向欧拉对应于 <span class="arithmatex">\(\alpha=1\)</span>，而双线性对应于 <span class="arithmatex">\(\alpha=1/2\)</span>。</p>
<p>我们还注意到另一种方法称为零阶保持（ZOH）[23]，它专门用于线性 ODE。假定在 <span class="arithmatex">\(t\)</span> 和 <span class="arithmatex">\(t+\Delta t\)</span> 之间的常量输入 <span class="arithmatex">\(f\)</span> 下计算方程（12）的 RHS。这将得到更新 <span class="arithmatex">\(c(t+\Delta t)=e^{\Delta t A} c(t)+\left(\int_{\tau=0}^{\Delta t} e^{\tau A} \mathrm{~d} \tau\right) B f(t)\)</span>。如果 <span class="arithmatex">\(A\)</span> 可逆，则可以简化为 <span class="arithmatex">\(c(t+\Delta t)=e^{\Delta t A} c(t)+A^{-1}\left(e^{\Delta t A}-I\right) B f(t)\)</span>​。</p>
<p>HiPPO-LegS 对于离散化步长的不变性。在 HiPPO-LegS 的情况下，我们有一个形式为 <span class="arithmatex">\(\frac{d}{d t} c(t)=\frac{1}{t} A c(t)+\frac{1}{t} B f(t)\)</span> 的线性 ODE。将 GBT 离散化（它泛化了前向/反向欧拉和双线性）应用于这个线性 ODE，我们得到：</p>
<div class="arithmatex">\[
\begin{aligned}
c(t+\Delta t)-\Delta t \alpha \frac{1}{t+\Delta t} A c(t+\Delta t) &amp; =\left(I+\Delta t(1-\alpha) \frac{1}{t} A\right) c(t)+\Delta t \frac{1}{t} B f(t) \\
c(t+\Delta t) &amp; =\left(I-\frac{\Delta t}{t+\Delta t} \alpha A\right)^{-1}\left(I+\frac{\Delta t}{t}(1-\alpha) A\right) c(t)+\frac{\Delta t}{t}\left(I-\frac{\Delta t}{t+\Delta t} \alpha A\right)^{-1} B
\end{aligned}
\]</div>
<p>我们强调，这个系统对于离散化步长 <span class="arithmatex">\(\Delta t\)</span> 是不变的。实际上，如果 <span class="arithmatex">\(c^{(k)}:=c(k \Delta t)\)</span> 和 <span class="arithmatex">\(f_k:=f(k \Delta t)\)</span>，那么我们有递推关系</p>
<p>$$
c^{(k+1)}=\left(I-\frac{1}{k+1} \alpha A\right)^{-1}\left(I+\frac{1}{k}(1-\alpha) A\right) c^{(k)}</p>
<p>+\frac{1}{k}\left(I-\frac{1}{k+1} \alpha A\right)^{-1} B f_k，
$$</p>
<p>这不依赖于 <span class="arithmatex">\(\Delta t\)</span>。</p>
<p>消融：不同离散化方法的比较为了理解离散化中的近似误差的影响，在图 4 中，我们展示了 HiPPO-LegS 更新在函数逼近（附录 F.8）中的绝对误差，对于不同的离散化方法：前向欧拉、反向欧拉和双线性。双线性方法通常提供足够精确的近似。我们将使用双线性作为实验中 LegS 更新的离散化方法。</p>
<p><img alt="image.png" src="https://raw.githubusercontent.com/aletolia/Pictures/main/202403301506186.png" /></p>
<p>图 4：不同离散化方法的绝对误差。前向和反向欧拉通常不太准确，而双线性方法产生了更准确的近似。</p>
<h3 id="c-hippo">C 通用 HiPPO 框架<a class="headerlink" href="#c-hippo" title="Permanent link">&para;</a></h3>
<p>我们详细介绍通用的 HiPPO 框架，如在第 2 节中所述。我们还将其推广以包括除多项式之外的其他基。</p>
<p>给定时间变化的测度族 <span class="arithmatex">\(\mu^{(t)}\)</span>，支撑在 <span class="arithmatex">\((-\infty, t]\)</span> 上，一系列基函数 <span class="arithmatex">\(\mathcal{G}=\operatorname{span}\left\{g_n^{(t)}\right\}_{n \in[N]}\)</span>，以及连续函数 <span class="arithmatex">\(f: \mathbb{R}_{\geq 0} \rightarrow \mathbb{R}\)</span>，HiPPO 定义了一个算子，将 <span class="arithmatex">\(f\)</span> 映射到最优投影系数 <span class="arithmatex">\(c: \mathbb{R}_{\geq 0} \rightarrow \mathbb{R}^N\)</span>，使得</p>
<div class="arithmatex">\[
g^{(t)}:=\operatorname{argmin}_{g \in \mathcal{G}}\left\|f_{\leq t}-g\right\|_{\mu^{(t)}}, \quad \text { and } \quad g^{(t)}=\sum_{n=0}^{N-1} c_n(t) g_n^{(t)} .
\]</div>
<p>第一步指的是定义 1 中的 proj <span class="arithmatex">\(_t\)</span> 算子，第二步是 coef <span class="arithmatex">\(t\)</span> 算子。我们着重讨论系数 <span class="arithmatex">\(c(t)\)</span> 具有线性常微分方程 (ODE) 形式的情况，满足 <span class="arithmatex">\(\frac{d}{d t} c(t)=A(t) c(t)+B(t) f(t)\)</span>，其中 <span class="arithmatex">\(A(t) \in \mathbb{R}^{N \times N}\)</span>，<span class="arithmatex">\(B(t) \in \mathbb{R}^{N \times 1}\)</span>。</p>
<p>我们首先在附录 C.1 中更详细地描述了 hippo 算子（测度和基）。我们在附录 C.2 中定义了投影 proj <span class="arithmatex">\(_t\)</span> 和系数 coef <span class="arithmatex">\(t\)</span> 算子。然后我们给出了一般的策略来计算这些系数 <span class="arithmatex">\(c(t)\)</span>，通过导出控制系数动态的微分方程（附录 C.3）。最后我们讨论如何将连续的 hippo 算子转换为一个离散的算子，可以应用于序列数据（附录 C.4）。</p>
<h4 id="c1-hippo">C.1 通用 HiPPO 框架<a class="headerlink" href="#c1-hippo" title="Permanent link">&para;</a></h4>
<p>我们在这里更详细地描述和解释 HiPPO 的组成部分。回顾一下高层目标是在线函数逼近；这需要一组有效的逼近以及逼近质量的概念。</p>
<p>逼近测度：在每个 <span class="arithmatex">\(t\)</span>，逼近质量是指相对于支持在 <span class="arithmatex">\((-\infty, t]\)</span> 上的测度 <span class="arithmatex">\(\mu^{(t)}\)</span>。我们寻找一些多项式 <span class="arithmatex">\(g^{(t)}\)</span>，其次数最多为 <span class="arithmatex">\(N-1\)</span>，使得误差 <span class="arithmatex">\(\left\|f_{x \leq t}-g^{(t)}\right\|_{L_2\left(\mu^{(t)}\right)}\)</span> 最小化。直观地说，这个测度 <span class="arithmatex">\(\mu^{(t)}\)</span> 决定了过去的每个时间点的权重。为简单起见，我们假设测度 <span class="arithmatex">\(\mu^{(t)}\)</span> 在其定义域内以及时间上足够平滑；<strong><mark>特别地，它们具有密度 <span class="arithmatex">\(\omega(t, x):=\frac{\mathrm{d} \mu^{(t)}}{\mathrm{d} \lambda}(x)\)</span>，其中勒贝格测度 <span class="arithmatex">\(\mathrm{d} \lambda(x):=\mathrm{d} x\)</span>，使得 <span class="arithmatex">\(\omega\)</span> 几乎处处 <span class="arithmatex">\(C^1\)</span>。因此，对 <span class="arithmatex">\(\mathrm{d} \mu^{(t)}(x)\)</span> 进行积分可以重写为对 <span class="arithmatex">\(\omega(t, x) \mathrm{d} x\)</span> 进行积分。</mark></strong></p>
<p>为了简化，我们还假设测度 <span class="arithmatex">\(\mu^{(t)}\)</span> 被归一化为概率测度；任意缩放不会影响最优投影。</p>
<p><strong><mark>正交多项式基：让 <span class="arithmatex">\(\left\{P_n\right\}_{n \in \mathbb{N}}\)</span> 表示相对于某个基测度 <span class="arithmatex">\(\mu\)</span> 的一系列正交多项式</mark></strong>。类似地，定义 <span class="arithmatex">\(\left\{P_n^{(t)}\right\}_{n \in \mathbb{N}}\)</span> 为相对于时间变化的测度 <span class="arithmatex">\(\mu^{(t)}\)</span> 的一系列正交多项式。令 <span class="arithmatex">\(p_n^{(t)}\)</span> 为 <span class="arithmatex">\(P_n^{(t)}\)</span> 的归一化版本（即，具有单位范数），并定义</p>
<div class="arithmatex">\[
p_n(t, x)=p_n^{(t)}(x)。\tag{14}
\]</div>
<p>注意，<span class="arithmatex">\(P_n^{(t)}\)</span> 不需要被归一化，而 <span class="arithmatex">\(p_n^{(t)}\)</span> 需要。</p>
<p><strong><mark>倾斜的测度和基础：我们的目标只是存储函数的压缩表示，可以使用任何基，不一定是正交多项式。对于任意缩放函数</mark></strong></p>
<div class="arithmatex">\[
\chi(t, x)=\chi^{(t)}(x)，\tag{15}
\]</div>
<p>函数 <span class="arithmatex">\(p_n(x) \chi(x)\)</span> 相对于每个时间 <span class="arithmatex">\(t\)</span> 上以概率密度 <span class="arithmatex">\(\omega / \chi^2\)</span> 正交。因此，我们可以选择这个替代的基和测度来执行投影。</p>
<p><strong><mark>为了正式化这种倾斜的作用，定义 <span class="arithmatex">\(\nu^{(t)}\)</span> 为密度与 <span class="arithmatex">\(\omega^{(t)} /\left(\chi^{(t)}\right)^2\)</span> 成比例的归一化测度</mark></strong>。我们将计算归一化测度和它的标准正交基。令</p>
<div class="arithmatex">\[
\zeta(t)=\int \frac{\omega}{\chi^2}=\int \frac{\omega^{(t)}(x)}{\left(\chi^{(t)}(x)\right)^2} \mathrm{~d} x\tag{16}
\]</div>
<p>为归一化常数，以便 <span class="arithmatex">\(\nu^{(t)}\)</span> 具有密度 <span class="arithmatex">\(\frac{\omega^{(t)}}{\zeta(t)\left(\chi^{(t)}\right)^2}\)</span>。如果 <span class="arithmatex">\(\chi(t, x)=1\)</span>（没有倾斜），则该常数为 <span class="arithmatex">\(\zeta(t)=1\)</span>。一般来说，我们假设 <span class="arithmatex">\(\zeta\)</span> 对所有 <span class="arithmatex">\(t\)</span> 是常数；如果不是，它可以直接折叠到 <span class="arithmatex">\(\chi\)</span> 中。</p>
<p>接下来，注意（为简洁起见，在积分内部省略对 <span class="arithmatex">\(x\)</span> 的依赖）：</p>
<div class="arithmatex">\[
\begin{aligned}
\left\|\zeta(t)^{\frac{1}{2}} p_n^{(t)} \chi^{(t)}\right\|_{\nu^{(t)}}^2 &amp; =\int\left(\zeta(t)^{\frac{1}{2}} p_n^{(t)} \chi^{(t)}\right)^2 \frac{\omega^{(t)}}{\zeta(t)\left(\chi^{(t)}\right)^2} \\
&amp; =\int\left(p_n^{(t)}\right)^2 \omega^{(t)} \\
&amp; =\left\|p_n^{(t)}\right\|_{\mu^{(t)}}^2=1 .
\end{aligned}
\]</div>
<p>因此，我们定义 <span class="arithmatex">\(\nu^{(t)}\)</span> 的正交基：</p>
<div class="arithmatex">\[
g_n^{(t)}=\lambda_n \zeta(t)^{\frac{1}{2}} p_n^{(t)} \chi^{(t)}, \quad n \in \mathbb{N} .\tag{17}
\]</div>
<p>我们让基的每个元素都乘以一个 <span class="arithmatex">\(\lambda_n\)</span> 标量，出于很快要讨论的原因，因为任意缩放不会改变正交性：</p>
<div class="arithmatex">\[
\left\langle g_n^{(t)}, g_m^{(t)}\right\rangle_{\nu^{(t)}}=\lambda_n^2 \delta_{n, m}
\]</div>
<p>注意当 <span class="arithmatex">\(\lambda_n= \pm 1\)</span> 时，基 <span class="arithmatex">\(\left\{g_n^{(t)}\right\}\)</span> 是关于测度 <span class="arithmatex">\(\nu^{(t)}\)</span> 正交的标准正交基，对于每个时间 <span class="arithmatex">\(t\)</span>。按惯例记号，让 <span class="arithmatex">\(g_n(t, x):=g_n^{(t)}(x)\)</span>。我们只在拉盖尔（附录 D.2）和切比雪夫（附录 D.5）的情况下使用这种倾斜。</p>
<p>注意在 <span class="arithmatex">\(\chi=1\)</span>（即没有倾斜）的情况下，我们还有 <span class="arithmatex">\(\zeta=1\)</span> 和 <span class="arithmatex">\(g_n=\lambda_n p_n\)</span>（对于所有的 <span class="arithmatex">\(t, x\)</span>）。</p>
<h4 id="c2">C.2 投影和系数<a class="headerlink" href="#c2" title="Permanent link">&para;</a></h4>
<p>在给定测度和基函数的选择后，我们接下来看看如何计算系数 <span class="arithmatex">\(c(t)\)</span>。</p>
<p>输入：函数</p>
<p>我们有一个在线观察到的 <span class="arithmatex">\(C^1\)</span> 光滑函数 <span class="arithmatex">\(f:[0, \infty) \rightarrow \mathbb{R}\)</span>，我们希望在每个时间 <span class="arithmatex">\(t\)</span> 维护其历史的压缩表示 <span class="arithmatex">\(f(x)_{\leq t}=f(x)_{x \leq t}\)</span>。</p>
<p>输出：近似系数</p>
<p>函数 <span class="arithmatex">\(f\)</span> 可以通过存储其相对于基 <span class="arithmatex">\(\left\{g_n\right\}_{n&lt;N}\)</span> 的系数来进行近似。例如，在没有倾斜 <span class="arithmatex">\(\chi=1\)</span> 的情况下，这编码了 <span class="arithmatex">\(f\)</span> 的低于 <span class="arithmatex">\(N\)</span> 阶多项式逼近。特别地，在时间 <span class="arithmatex">\(t\)</span>，我们希望将 <span class="arithmatex">\(f_{\leq t}\)</span> 表示为多项式 <span class="arithmatex">\(g_n^{(t)}\)</span> 的线性组合。由于 <span class="arithmatex">\(g_n^{(t)}\)</span> 关于由 <span class="arithmatex">\(\langle\cdot, \cdot\rangle_{\nu^{(t)}}\)</span> 定义的希尔伯特空间正交，计算系数就足够了：</p>
<div class="arithmatex">\[
\begin{aligned}
c_n(t) &amp; =\left\langle f_{\leq t}, g_n^{(t)}\right\rangle_{\nu^{(t)}} \\
&amp; =\int f g_n^{(t)} \frac{\omega^{(t)}}{\zeta(t)\left(\chi^{(t)}\right)^2} \\
&amp; =\zeta(t)^{-\frac{1}{2}} \lambda_n \int f p_n^{(t)} \frac{\omega^{(t)}}{\chi^{(t)}} .
\end{aligned}\tag{18}
\]</div>
<p>重构</p>
<p>在任意时间 <span class="arithmatex">\(t\)</span>，<span class="arithmatex">\(f_{\leq t}\)</span> 可以被明确地重构为</p>
<div class="arithmatex">\[
\begin{aligned}
f_{\leq t} \approx g^{(t)} &amp; :=\sum_{n=0}^{N-1}\left\langle f_{\leq t}, g_n^{(t)}\right\rangle_{\nu^{(t)}} \frac{g_n^{(t)}}{\left\|g_n^{(t)}\right\|_{\nu^{(t)}}^2} \\
&amp; =\sum_{n=0}^{N-1} \lambda_n^{-2} c_n(t) g_n^{(t)} \\
&amp; =\sum_{n=0}^{N-1} \lambda_n^{-1} \zeta^{\frac{1}{2}} c_n(t) p_n^{(t)} \chi^{(t)} .
\end{aligned}\tag{19}
\]</div>
<p>方程 <span class="arithmatex">\((19)\)</span> 是 proj <span class="arithmatex">\(_t\)</span> 算子；给定测度和基参数，它定义了 <span class="arithmatex">\(f_{\leq t}\)</span> 的最优逼近。</p>
<h4 id="c3-hippo">C.3 系数动态：Hippo 算子<a class="headerlink" href="#c3-hippo" title="Permanent link">&para;</a></h4>
<p>为了满足端到端模型对输入函数 <span class="arithmatex">\(f(t)\)</span> 的需求，系数 <span class="arithmatex">\(c(t)\)</span> 足以编码关于 <span class="arithmatex">\(f\)</span> 历史的信息并允许在线预测。因此，将 <span class="arithmatex">\(c(t)\)</span> 定义为方程（18）中的 <span class="arithmatex">\(c_n(t)\)</span> 向量，我们的重点将放在如何从输入函数 <span class="arithmatex">\(f: \mathbb{R}_{\geq 0} \rightarrow \mathbb{R}\)</span> 计算函数 <span class="arithmatex">\(c: \mathbb{R}_{\geq 0} \rightarrow \mathbb{R}^N\)</span>​ 上。</p>
<p>在我们的框架中，我们将把这些系数视为动态系统随时间演化而计算。对方程（18）进行微分，得到：
$$
\begin{aligned}
\frac{d}{d t} c_n(t)= &amp; \zeta(t)^{-\frac{1}{2}} \lambda_n \int f(x)\left(\frac{\partial}{\partial t} p_n(t, x)\right) \frac{\omega}{\chi}(t, x) \mathrm{d} x \
&amp; +\int f(x)\left(\zeta^{-\frac{1}{2}} \lambda_n p_n(t, x)\right)\left(\frac{\partial}{\partial t} \frac{\omega}{\chi}(t, x)\right) \mathrm{d} x .
\end{aligned}\tag{20}
$$</p>
<p>在这里，我们利用了 <span class="arithmatex">\(\zeta\)</span> 对于所有 <span class="arithmatex">\(t\)</span> 都是常数的假设。</p>
<p>令 <span class="arithmatex">\(c(t) \in \mathbb{R}^{N-1}\)</span> 表示所有系数 <span class="arithmatex">\(\left(c_n(t)\right)_{0 \leq n&lt;N}\)</span> 的向量。</p>
<p>关键思想是，如果 <span class="arithmatex">\(\frac{\partial}{\partial t} P_n\)</span> 和 <span class="arithmatex">\(\frac{\partial}{\partial t} \frac{\omega}{\chi}\)</span> 具有可以与多项式 <span class="arithmatex">\(P_k\)</span> 相关联的闭式，那么可以为 <span class="arithmatex">\(c(t)\)</span> 写出一个普通微分方程。这使得这些系数 <span class="arithmatex">\(c(t)\)</span> 和因此最优多项式逼近可以在线计算。由于 <span class="arithmatex">\(\frac{d}{d t} P_n^{(t)}\)</span> 是一个关于 <span class="arithmatex">\(x\)</span> 的 <span class="arithmatex">\(n-1\)</span> 次多项式，可以将其写成 <span class="arithmatex">\(P_0, \ldots, P_{n-1}\)</span> 的线性组合，因此方程（20）的第一项是 <span class="arithmatex">\(c_0, \ldots, c_{n-1}\)</span> 的线性组合。对于许多权重函数 <span class="arithmatex">\(\omega\)</span>，我们可以找到缩放函数 <span class="arithmatex">\(\chi\)</span>，使得 <span class="arithmatex">\(\frac{\partial}{\partial t} \frac{\omega}{\chi}\)</span> 也可以用 <span class="arithmatex">\(\frac{\omega}{\chi}\)</span> 本身来表示，因此在这些情况下，方程（20）的第二项也是 <span class="arithmatex">\(c_0, \ldots, c_{N-1}\)</span> 和输入 <span class="arithmatex">\(f\)</span> 的线性组合。因此，这通常导致 <span class="arithmatex">\(c(t)\)</span>​​ 的封闭形式线性常微分方程。</p>
<h5 id="_5">归一化动态<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h5>
<p>我们定义自由参数 <span class="arithmatex">\(\lambda_n\)</span> 的目的有三个。</p>
<ol>
<li>首先，注意标准正交基不是唯一的，每个元素可以乘以 <span class="arithmatex">\(a \pm 1\)</span> 因子。</li>
<li>第二，选择 <span class="arithmatex">\(\lambda_n\)</span> 可以帮助简化推导。</li>
<li>第三，虽然选择 <span class="arithmatex">\(\lambda_n= \pm 1\)</span> 将是我们的默认选择，因为投影到标准正交基是最合理的，但 LMU 使用了不同的缩放。附录 [D.1] 将通过为 LegT 测度选择不同的 <span class="arithmatex">\(\lambda_n\)</span> 来恢复 LMU。</li>
</ol>
<p>假设方程（20）简化为形式如下的动态系统：</p>
<div class="arithmatex">\[
\frac{d}{d t} c(t)=-A(t) c(t)+B(t) f(t) .
\]</div>
<p>然后，令 <span class="arithmatex">\(\Lambda=\operatorname{diag}_{n \in[N]}\left\{\lambda_n\right\}\)</span>，</p>
<div class="arithmatex">\[
\frac{d}{d t} \Lambda^{-1} c(t)=-\Lambda^{-1} A(t) \Lambda \Lambda^{-1} c(t)+\Lambda^{-1} B(t) f(t) .
\]</div>
<p>因此，如果我们重新参数化系数 <span class="arithmatex">\(\left(\Lambda^{-1} c(t) \rightarrow c(t)\right)\)</span>，那么投影到标准正交基上的归一化系数将满足动态和相关重构：</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c(t) &amp; =-\left(\Lambda^{-1} A(t) \Lambda\right) c(t)+\left(\Lambda^{-1} B(t)\right) f(t) \\
f_{\leq t} \approx g^{(t)} &amp; =\sum_{n=0}^{N-1} \zeta^{\frac{1}{2}} c_n(t) p_n^{(t)} \chi^{(t)}
\end{aligned}\tag{21,22}
\]</div>
<p>这些是 hippo 和 proj <span class="arithmatex">\(_t\)</span> 算子。</p>
<h4 id="c4">C.4 离散化<a class="headerlink" href="#c4" title="Permanent link">&para;</a></h4>
<p>如此定义，hippo 是连续函数的映射。然而，由于 hippo 定义了一个系数动态的闭式常微分方程，标准的常微分方程离散化方法（附录 B.3）可以应用于将其转换为离散的内存更新。因此，我们重载这些算子，即 hippo 要么定义成形式为</p>
<div class="arithmatex">\[
\frac{d}{d t} c(t)=A(t) c(t)+B(t) f(t)
\]</div>
<p>或者是一个递归</p>
<div class="arithmatex">\[
c_t=A_t c_{t-1}+B_t f_t,
\]</div>
<p>这可以根据上下文进行清晰的选择。</p>
<p>附录 F.5 通过将（20）和（19）应用于近似合成函数来验证了该框架。</p>
<p><img alt="image.png" src="https://raw.githubusercontent.com/aletolia/Pictures/main/202403301516567.png" /></p>
<p>图 5：HiPPO 测度的说明 在时间 <span class="arithmatex">\(t_0\)</span>，函数 <span class="arithmatex">\(f(x)_{x \leq t_0}\)</span> 的历史通过关于测度 <span class="arithmatex">\(\mu^{\left(t_0\right)}\)</span> 的多项式逼近进行总结（蓝色），类似地，在时间 <span class="arithmatex">\(t_1\)</span>（紫色）也是如此。（左）平移的勒让德测度（LegT）在窗口 <span class="arithmatex">\([t-\theta, t]\)</span> 中分配权重。对于小的 <span class="arithmatex">\(t\)</span>，<span class="arithmatex">\(\mu^{(t)}\)</span> 支持在 <span class="arithmatex">\(x&lt;0\)</span> 的区域，而 <span class="arithmatex">\(f\)</span> 未定义。当 <span class="arithmatex">\(t\)</span> 很大时，测度不支持接近 0 的区域，导致对 <span class="arithmatex">\(f\)</span> 的投影忘记了函数的开头。（中）平移的拉盖尔（LagT）测度以指数方式衰减过去。它不会忘记，但也会在 <span class="arithmatex">\(x&lt;0\)</span> 上分配权重。（右）缩放的勒让德测度（LegS）均匀地加权整个历史 <span class="arithmatex">\([0, t]\)</span>。</p>
<h3 id="d-hippo">D HiPPO 投影算子的推导<a class="headerlink" href="#d-hippo" title="Permanent link">&para;</a></h3>
<p>我们推导了与在第 2.3 节中介绍的平移的勒让德（LegT）和平移的拉盖尔（LagT）测度以及在第 3 节中介绍的缩放的勒让德（LegS）测度相关的记忆更新，以展示框架的普适性。为了显示框架的普适性，我们还推导了使用傅里叶基函数（恢复傅里叶循环单元 [79]）和切比雪夫基函数的记忆更新。</p>
<p>绝大部分工作已经通过建立投影框架完成，证明只需按照附录 C 中概述的技术大纲进行。特别地，系数的定义（18）和重构（19）不会改变，我们只考虑如何计算系数动态（20）。</p>
<p>对于每种情况，我们遵循以下一般步骤：
- <strong>测度和基函数</strong>：定义测度 <span class="arithmatex">\(\mu^{(t)}\)</span> 或权重 <span class="arithmatex">\(\omega(t, x)\)</span>，以及基函数 <span class="arithmatex">\(p_n(t, x)\)</span>。
- <strong>导数</strong>：计算测度和基函数的导数。
- <strong>系数动态</strong>：将它们代入系数动态（方程 (20)）中，推导描述如何计算系数 <span class="arithmatex">\(c(t)\)</span> 的常微分方程。
- <strong>重构</strong>：提供重构函数 <span class="arithmatex">\(f_{\leq t}\)</span> 的完整公式，这是在此测度和基础下的最优投影。</p>
<p>在附录 D.1 和 D.2 中的推导证明了定理 1，而在附录 D.3 中的推导证明了定理 2。附录 D.4 和 D.5 展示了基于傅里叶的基函数的额外结果。图 5 说明了当我们使用勒让德和拉盖尔多项式作为基础时，对比了我们的主要时间变化测度族 <span class="arithmatex">\(\mu^{(t)}\)</span> 的整体框架。</p>
<h4 id="d1-hippo-legt">D.1 平移的勒让德测度的推导（HiPPO-LegT）<a class="headerlink" href="#d1-hippo-legt" title="Permanent link">&para;</a></h4>
<p>该测度固定了一个窗口长度 <span class="arithmatex">\(\theta\)</span>，并将其沿时间滑动。</p>
<h5 id="_6">测度和基函数<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h5>
<p>我们使用在区间 <span class="arithmatex">\([t-\theta, t]\)</span> 上支持的均匀权重函数，并选择勒让德多项式 <span class="arithmatex">\(P_n(x)\)</span> 作为基函数，将其从 <span class="arithmatex">\([-1,1]\)</span> 平移至 <span class="arithmatex">\([t-\theta, t]\)</span>：</p>
<div class="arithmatex">\[
\begin{aligned}
\omega(t, x) &amp; =\frac{1}{\theta} \mathbb{I}_{[t-\theta, t]} \\
p_n(t, x) &amp; =(2 n+1)^{1 / 2} P_n\left(\frac{2(x-t)}{\theta}+1\right) \\
g_n(t, x) &amp; =\lambda_n p_n(t, x) .
\end{aligned}
\]</div>
<p>这里，我们没有使用倾斜，所以 <span class="arithmatex">\(\chi=1\)</span> 且 <span class="arithmatex">\(\zeta=1\)</span>（方程 (15) 和 (16)）。我们暂时不指定 <span class="arithmatex">\(\lambda_n\)</span>。
在端点处，这些基函数满足</p>
<div class="arithmatex">\[
\begin{aligned}
g_n(t, t) &amp; =\lambda_n(2 n+1)^{\frac{1}{2}} \\
g_n(t, t-\theta) &amp; =\lambda_n(-1)^n(2 n+1)^{\frac{1}{2}} .
\end{aligned}
\]</div>
<h5 id="_7">导数<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h5>
<p>测度的导数是</p>
<div class="arithmatex">\[
\frac{\partial}{\partial t} \omega(t, x)=\frac{1}{\theta} \delta_t-\frac{1}{\theta} \delta_{t-\theta} .
\]</div>
<p>勒让德多项式的导数可以表示为其他勒让德多项式的线性组合（参见附录 B.1.1）。</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial t} g_n(t, x) &amp; =\lambda_n(2 n+1)^{\frac{1}{2}} \cdot \frac{-2}{\theta} P_n^{\prime}\left(\frac{2(x-t)}{\theta}+1\right) \\
&amp; =\lambda_n(2 n+1)^{\frac{1}{2}} \frac{-2}{\theta}\left[(2 n-1) P_{n-1}\left(\frac{2(x-t)}{\theta}+1\right)+(2 n-5) P_{n-3}\left(\frac{2(x-t)}{\theta}+1\right)+\ldots\right] \\
&amp; =-\lambda_n(2 n+1)^{\frac{1}{2}} \frac{2}{\theta}\left[\lambda_{n-1}^{-1}(2 n-1)^{\frac{1}{2}} g_{n-1}(t, x)+\lambda_{n-3}^{-1}(2 n-3)^{\frac{1}{2}} g_{n-3}(t, x)+\ldots\right] .
\end{aligned}
\]</div>
<p>我们在这里使用了方程 (7)。</p>
<h5 id="_8">滑动近似<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h5>
<p>作为 LegT 测度的特例，我们需要考虑由于滑动窗口测度的特性而产生的近似。
在下一节分析 <span class="arithmatex">\(\frac{d}{d t} c(t)\)</span> 时，我们将需要使用值 <span class="arithmatex">\(f(t-\theta)\)</span>。然而，在时间 <span class="arithmatex">\(t\)</span>，此输入不再可用。相反，我们需要依赖于函数的压缩表示：根据重构方程（19），如果近似到目前为止是成功的，我们应该有</p>
<div class="arithmatex">\[
\begin{aligned}
&amp; f_{\leq t}(x) \approx \sum_{k=0}^{N-1} \lambda_k^{-1} c_k(t)(2 k+1)^{\frac{1}{2}} P_k\left(\frac{2(x-t)}{\theta}+1\right) \\
&amp; f(t-\theta) \approx \sum_{k=0}^{N-1} \lambda_k^{-1} c_k(t)(2 k+1)^{\frac{1}{2}}(-1)^k .
\end{aligned}
\]</div>
<h5 id="_9">系数动态<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h5>
<p>我们准备推导系数动态方程。</p>
<p>将测度和基函数的导数代入方程 (20) 中得到</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c_n(t)=\int &amp; f(x)\left(\frac{\partial}{\partial t} g_n(t, x)\right) \omega(t, x) \mathrm{d} x \\
&amp; +\int f(x) g_n(t, x)\left(\frac{\partial}{\partial t} \omega(t, x)\right) \mathrm{d} x \\
=- &amp; \lambda_n(2 n+1)^{\frac{1}{2}} \frac{2}{\theta}\left[\lambda_{n-1}^{-1}(2 n-1)^{\frac{1}{2}} c_{n-1}(t)+\lambda_{n-3}^{-1}(2 n-5)^{\frac{1}{2}} c_{n-3}(t)+\ldots\right] \\
&amp; +\frac{1}{\theta} f(t) g_n(t, t)-\frac{1}{\theta} f(t-\theta) g_n(t, t-\theta) \\
\approx- &amp; \frac{\lambda_n}{\theta}(2 n+1)^{\frac{1}{2}} \cdot 2\left[(2 n-1)^{\frac{1}{2}} \frac{c_{n-1}(t)}{\lambda_{n-1}}+(2 n-5)^{\frac{1}{2}} \frac{c_{n-3}(t)}{\lambda_{n-3}}+\ldots\right] \\
&amp; +(2 n+1)^{\frac{1}{2}} \frac{\lambda_n}{\theta} f(t)-(2 n+1)^{\frac{1}{2}} \frac{\lambda_n}{\theta}(-1)^n \sum_{k=0}^{N-1}(2 k+1)^{\frac{1}{2}} \frac{c_k(t)}{\lambda_k}(-1)^k \\
=- &amp; \frac{\lambda_n}{\theta}(2 n+1)^{\frac{1}{2}} \cdot 2\left[(2 n-1)^{\frac{1}{2}} \frac{c_{n-1}(t)}{\lambda_{n-1}}+(2 n-5)^{\frac{1}{2}} \frac{c_{n-3}(t)}{\lambda_{n-3}}+\ldots\right] \\
&amp; -(2 n+1)^{\frac{1}{2}} \frac{\lambda_n}{\theta} \sum_{k=0}^{N-1}(-1)^{n-k}(2 k+1)^{\frac{1}{2}} \frac{c_k(t)}{\lambda_k}+(2 n+1)^{\frac{1}{2}} \frac{\lambda_n}{\theta} f(t) \\
=- &amp; \frac{\lambda_n}{\theta}(2 n+1)^{\frac{1}{2}} \sum_{k=0}^{N-1} M_{n k}(2 k+1)^{\frac{1}{2}} \frac{c_k(t)}{\lambda_k}+(2 n+1)^{\frac{1}{2}} \frac{\lambda_n}{\theta} f(t),
\end{aligned}
\]</div>
<p>其中</p>
<div class="arithmatex">\[
M_{n k}=\left\{\begin{array}{ll}
1 &amp; \text { if } k \leq n \\
(-1)^{n-k} &amp; \text { if } k \geq n
\end{array} .\right.
\]</div>
<p>现在我们考虑 <span class="arithmatex">\(\lambda_n\)</span> 的两种实例化。第一种是更自然的 <span class="arithmatex">\(\lambda_n=1\)</span>，这将使 <span class="arithmatex">\(g_n\)</span> 成为正交基。我们得到</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c(t) &amp; =-\frac{1}{\theta} A c(t)+\frac{1}{\theta} B f(t) \\
A_{n k} &amp; =(2 n+1)^{\frac{1}{2}}(2 k+1)^{\frac{1}{2}} \begin{cases}1 &amp; \text { if } k \leq n \\
(-1)^{n-k} &amp; \text { if } k \geq n\end{cases} \\
B_n &amp; =(2 n+1)^{\frac{1}{2}} .
\end{aligned}
\]</div>
<p>第二种情况取 <span class="arithmatex">\(\lambda_n=(2 n+1)^{\frac{1}{2}}(-1)^n\)</span>。这产生了</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c(t) &amp; =-\frac{1}{\theta} A c(t)+\frac{1}{\theta} B f(t) \\
A_{n k} &amp; =(2 n+1) \begin{cases}(-1)^{n-k} &amp; \text { if } k \leq n \\
1 &amp; \text { if } k \geq n\end{cases} \\
B_n &amp; =(2 n+1)(-1)^n .
\end{aligned}
\]</div>
<p>这正是 LMU 的更新方程。根据方程 (19)，在每个时间 <span class="arithmatex">\(t\)</span>，我们有</p>
<div class="arithmatex">\[
f(x) \approx g^{(t)}(x)=\sum_n \lambda_n^{-1} c_n(t)(2 n+1)^{\frac{1}{2}} P_n\left(\frac{2(x-t)}{\theta}+1\right) .
\]</div>
<h4 id="d2-hippo-lagt">D.2 翻译的拉盖尔（HiPPO-LagT）的推导<a class="headerlink" href="#d2-hippo-lagt" title="Permanent link">&para;</a></h4>
<p>我们考虑基于广义拉盖尔多项式的测度。对于固定的 <span class="arithmatex">\(\alpha \in \mathbb{R}\)</span>，这些多项式 <span class="arithmatex">\(L^{(\alpha)}(t-x)\)</span> 关于区间 <span class="arithmatex">\([0, \infty)\)</span> 上的测度 <span class="arithmatex">\(x^\alpha e^{-x}\)</span> 是正交的（参见附录 B.1.2）。此推导将涉及到根据另一个参数 <span class="arithmatex">\(\beta\)</span> 对测度进行倾斜。</p>
<p>HiPPO-LagT 的定理 1 的结果是 <span class="arithmatex">\(\alpha=0, \beta=1\)</span> 的情况，对应于基本拉盖尔多项式且没有倾斜。</p>
<h5 id="_10">测度和基函数<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h5>
<p>我们将广义拉盖尔权函数和多项式从 <span class="arithmatex">\([0, \infty)\)</span> 翻转并平移到 <span class="arithmatex">\((-\infty, t]\)</span>。使用方程 (9) 找到归一化。</p>
<div class="arithmatex">\[
\begin{aligned}
\omega(t, x) &amp; = \begin{cases}(t-x)^\alpha e^{x-t} &amp; \text { if } x \leq t \\
0 &amp; \text { if } x&gt;t\end{cases} \\
&amp; =(t-x)^\alpha e^{-(t-x)} \mathbb{I}_{(-\infty, t]} \\
p_n(t, x) &amp; =\frac{\Gamma(n+1)^{\frac{1}{2}}}{\Gamma(n+\alpha+1)^{\frac{1}{2}}} L_n^{(\alpha)}(t-x)
\end{aligned}
\]</div>
<h5 id="_11">倾斜的测度<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h5>
<p>我们选择以下倾斜 <span class="arithmatex">\(\chi\)</span></p>
<div class="arithmatex">\[
\chi(t, x)=(t-x)^\alpha \exp \left(-\frac{1-\beta}{2}(t-x)\right) \mathbb{I}_{(-\infty, t]}
\]</div>
<p>对于某个固定的 <span class="arithmatex">\(\beta \in \mathbb{R}\)</span>。归一化是（对所有 <span class="arithmatex">\(t\)</span> 都是常数）</p>
<div class="arithmatex">\[
\begin{aligned}
\zeta &amp; =\int \frac{\omega}{\chi^2}=\int(t-x)^{-\alpha} e^{-\beta(t-x)} \mathbb{I}_{(-\infty, t]} \mathrm{d} x \\
&amp; =\Gamma(1-\alpha) \beta^{\alpha-1},
\end{aligned}
\]</div>
<p>因此倾斜的测度具有密度</p>
<div class="arithmatex">\[
\zeta(t)^{-1} \frac{\omega^{(t)}}{\left(\chi^{(t)}\right)^2}=\Gamma(1-\alpha)^{-1} \beta^{1-\alpha}(t-x)^{-\alpha} \exp (-\beta(t-x)) \mathbb{I}_{(-\infty, t]} .
\]</div>
<p>我们选择</p>
<div class="arithmatex">\[
\lambda_n=\frac{\Gamma(n+\alpha+1)^{\frac{1}{2}}}{\Gamma(n+1)^{\frac{1}{2}}}
\]</div>
<p>作为广义拉盖尔多项式 <span class="arithmatex">\(L_n^{(\alpha)}\)</span> 的范数，这样 <span class="arithmatex">\(\lambda_n p_n^{(t)}=L_n^{(\alpha)}(t-x)\)</span>，并且（根据方程 (17)）<span class="arithmatex">\(\nu^{(t)}\)</span> 的基函数是</p>
<div class="arithmatex">\[
\begin{aligned}
g_n^{(t)} &amp; =\lambda_n \zeta^{\frac{1}{2}} p_n^{(t)} \chi^{(t)} \\
&amp; =\zeta^{\frac{1}{2}} \chi^{(t)} L_n^{(\alpha)}(t-x)
\end{aligned}\tag{23}
\]</div>
<h5 id="_12">导数<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h5>
<p>我们首先计算密度比</p>
<div class="arithmatex">\[
\frac{\omega}{\chi}(t, x)=\exp \left(-\frac{1+\beta}{2}(t-x)\right) \mathbb{I}_{(-\infty, t]} .
\]</div>
<p>以及它的导数</p>
<div class="arithmatex">\[
\frac{\partial}{\partial t} \frac{\omega}{\chi}(t, x)=-\left(\frac{1+\beta}{2}\right) \frac{\omega}{\chi}(t, x)+\exp \left(-\left(\frac{1+\beta}{2}\right)(t-x)\right) \delta_t .
\]</div>
<p>拉盖尔多项式的导数可以表示为其他拉盖尔多项式的线性组合（参见附录 B.1.2）。</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial t} \lambda_n p_n(t, x) &amp; =\frac{\partial}{\partial t} L_n^{(\alpha)}(t-x) \\
&amp; =-L_0^{(\alpha)}(t-x)-\cdots-L_{n-1}^{(\alpha)}(t-x) \\
&amp; =-\lambda_0 p_0(t, x)-\cdots-\lambda_{n-1} p_{n-1}(t, x)
\end{aligned}
\]</div>
<h5 id="_13">系数动态<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h5>
<p>将这些导数代入方程 (20)（从微分系数方程 (18) 中获得），其中为方便起见，我们忽略对 <span class="arithmatex">\(x\)</span> 的依赖：</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c_n(t)= &amp; \zeta^{-\frac{1}{2}} \int f \cdot\left(\frac{\partial}{\partial t} \lambda_n p_n^{(t)}\right) \frac{\omega^{(t)}}{\chi^{(t)}} \\
&amp; +\int f \cdot\left(\zeta^{-\frac{1}{2}} \lambda_n p_n^{(t)}\right)\left(\frac{\partial}{\partial t} \frac{\omega^{(t)}}{\chi^{(t)}}\right) \\
= &amp; -\sum_{k=0}^{n-1} \int f \cdot\left(\zeta^{-\frac{1}{2}} \lambda_k p_k^{(t)} \chi^{(t)}\right) \frac{\omega^{(t)}}{\left(\chi^{(t)}\right)^2} \\
&amp; -\left(\frac{1+\beta}{2}\right) \int f \cdot\left(\zeta^{-\frac{1}{2}} \lambda_n p_n^{(t)}\right) \frac{\omega^{(t)}}{\chi^{(t)}}+f(t) \cdot \zeta^{-\frac{1}{2}} L_n^{(\alpha)}(0) \\
= &amp; -\sum_{k=0}^{n-1} c_k(t)-\left(\frac{1+\beta}{2}\right) c_n(t)+\Gamma(1-\alpha)^{-\frac{1}{2}} \beta^{\frac{1-\alpha}{2}}\left(\begin{array}{c}
n+\alpha \\
n
\end{array}\right) f(t) .
\end{aligned}
\]</div>
<p>然后我们得到</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c(t) &amp; =-A c(t)+B f(t) \\
A &amp; =\left[\begin{array}{cccc}
\frac{1+\beta}{2} &amp; 0 &amp; \ldots &amp; 0 \\
1 &amp; \frac{1+\beta}{2} &amp; \ldots &amp; 0 \\
\vdots &amp; &amp; \ddots &amp; \\
1 &amp; 1 &amp; \ldots &amp; \frac{1+\beta}{2}
\end{array}\right] \\
B &amp; =\zeta^{-\frac{1}{2}} \cdot\left[\begin{array}{c}
\left(\begin{array}{c}
\alpha \\
0
\end{array}\right) \\
\vdots \\
\left(\begin{array}{c}
N-1+\alpha \\
N-1
\end{array}\right)
\end{array}\right]
\end{aligned}\tag{24}
\]</div>
<h5 id="_14">重构<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h5>
<p>根据方程 (19)，在每个时间 <span class="arithmatex">\(t\)</span>，对于 <span class="arithmatex">\(x \leq t\)</span>，</p>
<div class="arithmatex">\[
\begin{aligned}
f(x) \approx g^{(t)}(x) &amp; =\sum_{n=0}^{N-1} \lambda_n^{-1} \zeta^{\frac{1}{2}} c_n(t) p_n^{(t)} \chi^{(t)} \\
&amp; =\sum_n \frac{n !}{(n+\alpha) !} \zeta^{\frac{1}{2}} c_n(t) \cdot L_n^{(\alpha)}(t-x) \cdot(t-x)^\alpha e^{\left(\frac{\beta-1}{2}\right)(t-x) .}
\end{aligned}
\]</div>
<h5 id="_15">标准化动态<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h5>
<p>最后，遵循方程 (21) 和 (22) 将这些转换为对归一化（概率）测度 <span class="arithmatex">\(\nu^{(t)}\)</span> 的正交基的动态，得到以下 hippo 运算符</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c(t) &amp; =-A c(t)+B f(t) \\
A &amp; =-\Lambda^{-1}\left[\begin{array}{cccc}
\frac{1+\beta}{2} &amp; 0 &amp; \ldots &amp; 0 \\
1 &amp; \frac{1+\beta}{2} &amp; \ldots &amp; 0 \\
\vdots &amp; &amp; \ddots &amp; \\
1 &amp; 1 &amp; \ldots &amp; \frac{1+\beta}{2}
\end{array}\right] \Lambda \\
B &amp; =\Gamma(1-\alpha)^{-\frac{1}{2}} \beta^{\frac{1-\alpha}{2}} \cdot \Lambda^{-1}\left[\begin{array}{c}
\left(\begin{array}{c}
\alpha \\
0
\end{array}\right) \\
\vdots \\
\left(\begin{array}{c}
N-1+\alpha \\
N-1
\end{array}\right)
\end{array}\right] \\
\Lambda &amp; =\operatorname{diag}\left\{\frac{\Gamma(n+\alpha+1)^{\frac{1}{2}}}{\Gamma(n+1)^{\frac{1}{2}}}\right\}
\end{aligned}
\]</div>
<p>相应地，有一个 <code>proj $_t$</code> 运算符：</p>
<div class="arithmatex">\[
\begin{aligned}
f(x) \approx g^{(t)}(x) &amp; =\Gamma(1-\alpha)^{\frac{1}{2}} \beta^{-\frac{1-\alpha}{2}} \sum_n c_n(t) \cdot \frac{\Gamma(n+1)^{\frac{1}{2}}}{\Gamma(n+\alpha+1)^{\frac{1}{2}}} \cdot L_n^{(\alpha)}(t-x) \cdot(t-x)^\alpha e^{\left(\frac{\beta-1}{2}\right)(t-x)} .
\end{aligned}
\]</div>
<h4 id="d3-hippo-legs">D.3 缩放勒让德（HiPPO-LegS）的推导<a class="headerlink" href="#d3-hippo-legs" title="Permanent link">&para;</a></h4>
<p>如第 3 节所讨论的那样，缩放勒让德是我们唯一使用具有不同宽度的测度的方法。</p>
<p>测度与基础 我们在以下情况下实例化框架</p>
<div class="arithmatex">\[
\begin{aligned}
\omega(t, x) &amp; =\frac{1}{t} \mathbb{I}_{[0, t]} \\
g_n(t, x) &amp; =p_n(t, x)=(2 n+1)^{\frac{1}{2}} P_n\left(\frac{2 x}{t}-1\right)
\end{aligned}\tag{27}
\]</div>
<p>这里，<span class="arithmatex">\(P_n\)</span> 是基本的勒让德多项式（附录 B.1.1）。我们不使用倾斜，即 <span class="arithmatex">\(\chi(t, x)=1\)</span>，<span class="arithmatex">\(\zeta(t)=1\)</span>，<span class="arithmatex">\(\lambda_n=1\)</span>，以便函数 <span class="arithmatex">\(g_n(t, x)\)</span> 形成正交基。</p>
<p>导数 我们首先对测度和基进行微分：</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial t} \omega(t, \cdot) &amp; =-t^{-2} \mathbb{I}_{[0, t]}+t^{-1} \delta_t=t^{-1}\left(-\omega(t)+\delta_t\right) \\
\frac{\partial}{\partial t} g_n(t, x) &amp; =-(2 n+1)^{\frac{1}{2}} 2 x t^{-2} P_n^{\prime}\left(\frac{2 x}{t}-1\right) \\
&amp; =-(2 n+1)^{\frac{1}{2}} t^{-1}\left(\frac{2 x}{t}-1+1\right) P_n^{\prime}\left(\frac{2 x}{t}-1\right) .
\end{aligned}\tag{28}
\]</div>
<p>现在定义 <span class="arithmatex">\(z=\frac{2 x}{t}-1\)</span> 为简便起见，并应用勒让德多项式的导数性质（方程（8））。</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial t} g_n(t, x) &amp; =-(2 n+1)^{\frac{1}{2}} t^{-1}(z+1) P_n^{\prime}(z) \\
&amp; =-(2 n+1)^{\frac{1}{2}} t^{-1}\left[n P_n(z)+(2 n-1) P_{n-1}(z)+(2 n-3) P_{n-2}(z)+\ldots\right] \\
&amp; =-t^{-1}(2 n+1)^{\frac{1}{2}}\left[n(2 n+1)^{-\frac{1}{2}} g_n(t, x)+(2 n-1)^{\frac{1}{2}} g_{n-1}(t, x)+(2 n-3)^{\frac{1}{2}} g_{n-2}(t, x)+\ldots\right]
\end{aligned}
\]</div>
<p>系数动力学 将这些代入 20，我们得到</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c_n(t)= &amp; \int f(x)\left(\frac{\partial}{\partial t} g_n(t, x)\right) \omega(t, x) \mathrm{d} x+\int f(x) g_n(t, x)\left(\frac{\partial}{\partial t} \omega(t, x)\right) \mathrm{d} x \\
= &amp; -t^{-1}(2 n+1)^{\frac{1}{2}}\left[n(2 n+1)^{-\frac{1}{2}} c_n(t)+(2 n-1)^{\frac{1}{2}} c_{n-1}(t)+(2 n-3)^{\frac{1}{2}} c_{n-2}(t)+\ldots\right] \\
&amp; \quad-t^{-1} c_n(t)+t^{-1} f(t) g_n(t, t) \\
= &amp; -t^{-1}(2 n+1)^{\frac{1}{2}}\left[(n+1)(2 n+1)^{-\frac{1}{2}} c_n(t)+(2 n-1)^{\frac{1}{2}} c_{n-1}(t)+(2 n-3)^{\frac{1}{2}} c_{n-2}(t)+\ldots\right] \\
&amp; +t^{-1}(2 n+1)^{\frac{1}{2}} f(t)
\end{aligned}
\]</div>
<p>其中我们使用了 <span class="arithmatex">\(g_n(t, t)=(2 n+1)^{\frac{1}{2}} P_n(1)=(2 n+1)^{\frac{1}{2}}\)</span>。将此向量化得到方程（3）：</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c(t) &amp; =-\frac{1}{t} A c(t)+\frac{1}{t} B f(t) \\
A_{n k} &amp; = \begin{cases}(2 n+1)^{1 / 2}(2 k+1)^{1 / 2} &amp; \text { if } n&gt;k \\
n+1 &amp; \text { if } n=k, \\
0 &amp; \text { if } n&lt;k\end{cases} \\
B_n &amp; =(2 n+1)^{\frac{1}{2}}
\end{aligned}\tag{29}
\]</div>
<p>或者，我们可以将其写成</p>
<div class="arithmatex">\[
\frac{d}{d t} c(t)=-t^{-1} D\left[M D^{-1} c(t)+1 f(t)\right]\tag{30}
\]</div>
<p>其中 <span class="arithmatex">\(D:=\operatorname{diag}\left[(2 n+1)^{\frac{1}{2}}\right]_{n=0}^{N-1}, 1\)</span> 是全 1 向量，状态矩阵 <span class="arithmatex">\(M\)</span> 是</p>
<div class="arithmatex">\[
M=\left[\begin{array}{cccccc}
1 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 \\
1 &amp; 2 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 \\
1 &amp; 3 &amp; 3 &amp; 0 &amp; \ldots &amp; 0 \\
1 &amp; 3 &amp; 5 &amp; 4 &amp; \ldots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; 3 &amp; 5 &amp; 7 &amp; \ldots &amp; N
\end{array}\right] \text {，即，} M_{n k}= \begin{cases}2 k+1 &amp; \text {如果} k&lt;n \\
k+1 &amp; \text {如果} k=n \\
0 &amp; \text {如果} k&gt;n\end{cases}
\]</div>
<p>方程（29）是一个线性动态系统，除了被一个时间变化因子 <span class="arithmatex">\(t^{-1}\)</span> 扩展外，这是由缩放测度引起的。</p>
<p>重构 通过方程（19），在每个时刻 <span class="arithmatex">\(t\)</span>，我们有
$$
\begin{aligned}
f(x) \approx g^{(t)}(x) &amp; =\sum_n c_n(t) g_n(t, x) . \
&amp; =\sum_n c_n(t)(2 n+1)^{\frac{1}{2}} P_n\left(\frac{2 x}{t}-1\right) .
\end{aligned}
$$</p>
<h4 id="d4">D.4 傅里叶基的推导<a class="headerlink" href="#d4" title="Permanent link">&para;</a></h4>
<p>在附录 D 的其余部分，我们考虑一些在 HiPPO 框架下可分析的附加基础。这些使用与傅里叶变换的各种形式相关的测度和基。</p>
<h5 id="d41">D.4.1 平移傅里叶<a class="headerlink" href="#d41" title="Permanent link">&para;</a></h5>
<p>类似于 LMU，滑动傅里叶测度也具有固定的窗口长度 <span class="arithmatex">\(\theta\)</span> 参数，并将其沿着时间滑动。</p>
<p>测度 傅里叶基础 <span class="arithmatex">\(e^{2 \pi i n x}\)</span>（对于 <span class="arithmatex">\(n=0, \ldots, N-1\)</span> ）可以看作是关于单位圆 <span class="arithmatex">\(\{z:|z|=1\}\)</span> 上均匀测度的正交多项式基础 <span class="arithmatex">\(z^n\)</span>。通过变量变换 <span class="arithmatex">\(z \rightarrow e^{2 \pi i x}\)</span>（从而将定义域从单位圆变换为 <span class="arithmatex">\([0,1]\)</span> ），我们得到了常规的傅里叶基础 <span class="arithmatex">\(e^{2 \pi i n x}\)</span>。复内积 <span class="arithmatex">\(\langle f, g\rangle\)</span> 定义为 <span class="arithmatex">\(\int_0^1 f(x) \overline{g(x)} \mathrm{d} x\)</span>。注意基础 <span class="arithmatex">\(e^{2 \pi i n x}\)</span> 是正交的。
对于每个 <span class="arithmatex">\(t\)</span>，我们将使用在 <span class="arithmatex">\([t-\theta, t]\)</span> 上均匀的滑动测度，并将基础重新缩放为 <span class="arithmatex">\(e^{2 \pi i n \frac{t-x}{v}}\)</span>（因此它们仍然是正交的，即，具有单位 1 的范数）：</p>
<div class="arithmatex">\[
\begin{aligned}
\omega(t, x) &amp; =\frac{1}{\theta} \mathbb{I}_{[t-\theta, t]} \\
p_n(t, x) &amp; =e^{2 \pi i n \frac{t-x}{\theta}} .
\end{aligned}
\]</div>
<p>我们不使用倾斜（即，<span class="arithmatex">\(\chi(t, x)=1\)</span>）。
导数</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial t} \omega(t, x) &amp; =\frac{1}{\theta} \delta_t-\frac{1}{\theta} \delta_{t-\theta} \\
\frac{\partial}{\partial t} p_n(t, x) &amp; =\frac{2 \pi i n}{\theta} e^{2 \pi i n \frac{t-x}{\theta}}=\frac{2 \pi i n}{\theta} p_n(t, x) .
\end{aligned}
\]</div>
<p>系数更新 将其代入方程（20）得到</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c_n(t) &amp; =\frac{2 \pi i n}{\theta} c_n(t)+\frac{1}{\theta} f(t) p_n(t, t)-\frac{1}{\theta} f(t-\theta) p_n(t, t-\theta) \\
&amp; =\frac{2 \pi i n}{\theta} c_n(t)+\frac{1}{\theta} f(t)-\frac{1}{\theta} f(t-\theta) .
\end{aligned}
\]</div>
<p>注意到 <span class="arithmatex">\(p_n(t, t)=p_n(t, t-\theta)=1\)</span>。此外，在时刻 <span class="arithmatex">\(t\)</span>，我们不再访问 <span class="arithmatex">\(f(t-\theta)\)</span>，但这隐含地表示在我们对函数的压缩表示中：<span class="arithmatex">\(f=\sum_{k=0}^{N-1} c_k(t) p_k(t)\)</span>。因此，我们用 <span class="arithmatex">\(\sum_{k=0}^{N-1} c_k(t)\)</span> 近似 <span class="arithmatex">\(f(t-\theta)\)</span>。最后，这导致</p>
<div class="arithmatex">\[
\frac{d}{d t} c_n(t)=\frac{2 \pi i n}{\theta} c_n(t)+\frac{1}{\theta} f(t)-\frac{1}{\theta} \sum_{k=0}^{N-1} c_k(t) .
\]</div>
<p>因此 <span class="arithmatex">\(\frac{d}{d t} c(t)=A c(t)+B f(t)\)</span>，其中</p>
<div class="arithmatex">\[
A_{n k}=\left\{\begin{array}{ll}
-1 / \theta &amp; \text {如果} k \neq n \\
(2 \pi i n-1) / \theta &amp; \text {如果} k=n
\end{array}, \quad B_n=\frac{1}{\theta} .\right.
\]</div>
<p>重构 在每个时间步 <span class="arithmatex">\(t\)</span>，我们有</p>
<p>$$
f(x) \approx \sum_n c_n(t) p_n(t, x)=\sum_n c_n(t) e^{2 \pi i \frac{t-z}\</p>
<p>theta}}
$$</p>
<h5 id="d42">D.4.2 傅里叶循环单元<a class="headerlink" href="#d42" title="Permanent link">&para;</a></h5>
<p>利用 HiPPO 框架，我们还可以推导出傅里叶循环单元（FRU）[79]。</p>
<p>测度 对于每个 <span class="arithmatex">\(t\)</span>，我们将使用在 <span class="arithmatex">\([t-\theta, t]\)</span> 上均匀的滑动测度和基础 <span class="arithmatex">\(e^{2 \pi i n \frac{x}{\theta}}\)</span>：</p>
<div class="arithmatex">\[
\begin{aligned}
\omega(t, x) &amp; =\frac{1}{\theta} \mathbb{I}_{[t-\theta, t]} \\
p_n(t, x) &amp; =e^{2 \pi i n \frac{z}{\theta}} .
\end{aligned}
\]</div>
<p>通常，基础相对于测度 <span class="arithmatex">\(\omega(t, x)\)</span> 不是正交的，但在 <span class="arithmatex">\(t=\theta\)</span> 处正交性成立。</p>
<p>导数
$$
\begin{aligned}
\frac{\partial}{\partial t} \omega(t, x) &amp; =\frac{1}{\theta} \delta_t-\frac{1}{\theta} \delta_{t-\theta} \
\frac{\partial}{\partial t} p_n(t, x) &amp; =0 .
\end{aligned}
$$</p>
<p>系数更新 将其代入方程 20 得到</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c_n(t) &amp; =\frac{1}{\theta} f(t) p_n(t, t)-\frac{1}{\theta} f(t-\theta) p_n(t, t-\theta) \\
&amp; =\frac{1}{\theta} e^{2 \pi i n \frac{t}{\theta}} f(t)-\frac{1}{\theta} e^{2 \pi i n \frac{t}{\theta}} f(t-\theta) .
\end{aligned}
\]</div>
<p>在时刻 <span class="arithmatex">\(t\)</span>，我们不再访问 <span class="arithmatex">\(f(t-\theta)\)</span>，但我们可以通过忽略此项来近似（假设函数 <span class="arithmatex">\(f\)</span> 仅在 <span class="arithmatex">\([0, \theta]\)</span> 上定义，因此对于 <span class="arithmatex">\(x&lt;0\)</span>，<span class="arithmatex">\(f(x)\)</span> 可以设为零）。最后，这导致</p>
<div class="arithmatex">\[
\frac{d}{d t} c_n(t)=\frac{e^{2 \pi i n \frac{t}{\theta}}}{\theta} f(t) .
\]</div>
<p>应用前向欧拉离散化（步长 <span class="arithmatex">\(=1\)</span>），我们得到：</p>
<div class="arithmatex">\[
c_n(k+1)=c_n(k)+\frac{e^{2 \pi i n \frac{t}{\theta}}}{\theta} f(t) .
\]</div>
<p>取实部得到傅里叶循环单元的更新 [79]。</p>
<p>请注意，每个 <span class="arithmatex">\(n\)</span> 中的递归是独立的，因此我们不需要选择 <span class="arithmatex">\(n=0,1, \ldots, N-1\)</span>。因此，我们可以像 Zhang 等人 [79] 中那样选择随机频率 <span class="arithmatex">\(n\)</span>​。</p>
<h4 id="d5">D.5 平移切比雪夫的推导<a class="headerlink" href="#d5" title="Permanent link">&para;</a></h4>
<p>在 HiPPO 框架下，我们分析的最后一族正交多项式是切比雪夫多项式。切比雪夫多项式可以看作是傅里叶基的纯实模拟；例如，切比雪夫级数通过基变换与傅里叶余弦级数相关联 [8]。</p>
<p>测度和基础 基本的切比雪夫测度是 <span class="arithmatex">\(\omega^{\text {cheb }}=\left(1-x^2\right)^{-1 / 2}\)</span> 在 <span class="arithmatex">\((-1,1)\)</span> 上。根据附录 B.1.3，我们选择以下测度和标准正交基多项式，用切比雪夫第一种多项式 <span class="arithmatex">\(T_n\)</span> 表示。</p>
<div class="arithmatex">\[
\begin{aligned}
\omega(t, x) &amp; =\frac{2}{\theta \pi} \omega^{\text {cheb }}\left(\frac{2(x-t)}{\theta}+1\right) \mathbb{I}_{(t-\theta, t)} \\
&amp; =\frac{1}{\theta \pi}\left(\frac{x-t}{\theta}+1\right)^{-1 / 2}\left(-\frac{x-t}{\theta}\right)^{-1 / 2} \mathbb{I}_{(t-\theta, t)} \\
p_n(t, x) &amp; =\sqrt{2} T_n\left(\frac{2(x-t)}{\theta}+1\right) \quad \text { for } n \geq 1, \\
p_0(t, x) &amp; =T_0\left(\frac{2(x-t)}{\theta}+1\right) .
\end{aligned}
\]</div>
<p>注意，在端点处，这些计算结果为</p>
<div class="arithmatex">\[
\begin{aligned}
p_n(t, t) &amp; = \begin{cases}\sqrt{2} T_n(1)=\sqrt{2} &amp; n \geq 1 \\
T_n(1)=1 &amp; n=0\end{cases} \\
p_n(t, t-\theta) &amp; = \begin{cases}\sqrt{2} T_n(-1)=\sqrt{2}(-1)^n &amp; n \geq 1 \\
T_n(-1)=1 &amp; n=0\end{cases}
\end{aligned}
\]</div>
<p>倾斜测度 现在我们选择</p>
<div class="arithmatex">\[
\chi^{(t)}=8^{-1 / 2} \theta \pi \omega^{(t)},
\]</div>
<p>所以</p>
<div class="arithmatex">\[
\frac{\omega}{\chi^2}=\frac{1}{\frac{\theta^2 \pi^2}{8} \omega}=\frac{8}{\theta \pi}\left(\frac{x-t}{\theta}+1\right)^{1 / 2}\left(-\frac{x-t}{\theta}\right)^{1 / 2} \mathbb{I}_{(t-\theta, t)}
\]</div>
<p>其积分为 1。</p>
<p>我们还选择 <span class="arithmatex">\(\lambda_n=1\)</span>​ 作为规范正交基，因此</p>
<div class="arithmatex">\[
g^{(t)}=p_n^{(t)} \chi^{(t)}
\]</div>
<p>导数 密度的导数是</p>
<div class="arithmatex">\[
\frac{\partial}{\partial t} \frac{\omega}{\chi}=\frac{\partial}{\partial t} \frac{8^{1 / 2}}{\theta \pi} \mathbb{I}_{(t-\theta, t)}=\frac{8^{1 / 2}}{\theta \pi}\left(\delta_t-\delta_{t-\theta}\right) .
\]</div>
<p>我们分别考虑对 <span class="arithmatex">\(n=0, n\)</span> 为偶数和奇数的多项式进行微分，使用方程 (TI)。为了方便起见，定义 <span class="arithmatex">\(z=\frac{2(x-t)}{\theta}+1\)</span>。首先，对于 <span class="arithmatex">\(n\)</span> 为偶数，</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial t} p_n(t, x) &amp; =-\frac{2^{\frac{3}{2}}}{\theta} T_n^{\prime}\left(\frac{2(x-t)}{\theta}+1\right) \\
&amp; =-\frac{2^{\frac{3}{2}}}{\theta} T_n^{\prime}(z) \\
&amp; =-\frac{2^{\frac{3}{2}}}{\theta} \cdot 2 n\left(T_{n-1}(z)+T_{n-3}(z)+\cdots+T_1(z)\right) \\
&amp; =-\frac{4 n}{\theta}\left(p_{n-1}(t, x)+p_{n-3}(t, x)+\cdots+p_1(t, x)\right)
\end{aligned}
\]</div>
<p>对于奇数 <span class="arithmatex">\(n\)</span>，</p>
<div class="arithmatex">\[
\begin{align*}
\frac{\partial}{\partial t} p_n(t, x) &amp; =-\frac{2^{\frac{3}{2}}}{\theta} T_n^{\prime}\left(\frac{2(x-t)}{\theta}+1\right) \\
&amp; =-\frac{2^{\frac{3}{2}}}{\theta} T_n^{\prime}(z) \\
&amp; =-\frac{2^{\frac{3}{2}}}{\theta} \cdot 2 n\left(T_{n-1}(z)+T_{n-3}(z)+\cdots+T_1(z)+\frac{1}{2} T_0(z)\right) \\
&amp; =-\frac{4 n}{\theta}\left(p_{n-1}(t, x)+p_{n-3}(t, x)+\cdots+2^{-\frac{1}{2}} p_0(t, x)\right)
\end{align*}
\]</div>
<p>和</p>
<div class="arithmatex">\[
\frac{\partial}{\partial t} p_0(t, x)=0 .
\]</div>
<p>系数动态</p>
<div class="arithmatex">\[
\begin{aligned}
c_n(t) &amp; =\int f(x) p_n(t, x) \frac{2^{3 / 2}}{\theta \pi} \mathbb{I}_{(t-\theta, t)} \mathrm{d} x \\
\frac{d}{d t} c_n(t) &amp; =\int f(x) \frac{\partial}{\partial t} p_n(t, x) \frac{2^{3 / 2}}{\theta \pi} \mathbb{I}_{(t-\theta, t)} \mathrm{d} x+\frac{2^{3 / 2}}{\theta \pi} f(t) p_n(t, t)-\frac{2^{3 / 2}}{\theta \pi} f(t-\theta) p_n(t, t-\theta) \\
&amp; =-\frac{4 n}{\theta}\left(c_{n-1}+c_{n-3}+\ldots\right)+\frac{2^{3 / 2}}{\theta \pi} f(t)\left\{\begin{array}{ll}
\sqrt{2} &amp; n \geq 1 \\
1 &amp; n=0
\end{array},\right.
\end{aligned}
\]</div>
<p>其中我们取 <span class="arithmatex">\(f(t-\theta)=0\)</span>，因为我们不再能够访问它（这也适用于 <span class="arithmatex">\(t&lt;\theta\)</span>）。通常情况下，我们可以将这写成线性动态方程</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{d t} c(t) &amp; =-\frac{1}{\theta} A c(t)+\frac{1}{\theta} B f(t) \\
A &amp; =4\left[\begin{array}{ccccc}
0 &amp; &amp; &amp; \ldots \\
2^{-\frac{1}{2}} &amp; 0 &amp; &amp; &amp; \\
0 &amp; 2 &amp; 0 &amp; &amp; \ldots \\
2^{-\frac{1}{2}} \cdot 3 &amp; 0 &amp; 3 &amp; 0 &amp; \\
&amp; \ddots &amp; &amp; \ddots &amp;
\end{array}\right] \\
B &amp; =\frac{2^{3 / 2}}{\pi}\left[\begin{array}{c}
1 \\
\sqrt{2} \\
\sqrt{2} \\
\sqrt{2} \\
\vdots
\end{array}\right]
\end{aligned}
\]</div>
<p>重构 在区间 <span class="arithmatex">\((t-\theta, t)\)</span> 中，</p>
<div class="arithmatex">\[
f(x) \approx \sum_{n=0}^{N-1} c_n(t) p_n(t, x) \chi(t, x) .
\]</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../A%20visual-language%20foundation%20model%20for%20computational%20pathology/" class="md-footer__link md-footer__link--prev" aria-label="Previous: A visual language foundation model for computational pathology">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                A visual language foundation model for computational pathology
              </div>
            </div>
          </a>
        
        
          
          <a href="../Modeling%20Dense%20Multimodal%20Interactions%20Between%20Biological%20Pathways%20and%20Histology%20for%20Survival%20Prediction/" class="md-footer__link md-footer__link--next" aria-label="Next: Modeling Dense Multimodal Interactions Between Biological Pathways and Histology for Survival Prediction">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Modeling Dense Multimodal Interactions Between Biological Pathways and Histology for Survival Prediction
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "header.autohide"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="../mathjax-config.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../extra.js"></script>
      
        <script src="../js/toggle_sidebar.js"></script>
      
    
  </body>
</html>