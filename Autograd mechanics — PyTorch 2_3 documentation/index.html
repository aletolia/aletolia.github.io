
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://localhost:8000/Autograd%20mechanics%20%E2%80%94%20PyTorch%202_3%20documentation/">
      
      
        <link rel="prev" href="../Attention%20Generation%20Work%20Flow/">
      
      
        <link rel="next" href="../PyTorch%20Autograd%20Explained%20-%20In-depth%20Tutorial/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Autograd mechanics â€” PyTorch 2 3 documentation - One Last Kiss</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-M0R7V8QGQ7"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-M0R7V8QGQ7",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-M0R7V8QGQ7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#autograd" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="One Last Kiss" class="md-header__button md-logo" aria-label="One Last Kiss" data-md-component="logo">
      
  <img src="../img/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            One Last Kiss
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Autograd mechanics â€” PyTorch 2 3 documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aletolia/aletolia.github.io.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aletolia/aletolia.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
    
  
  ğŸ  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Mygo/" class="md-tabs__link">
          
  
    
  
  â›ï¸ CV and Multimodels

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Session%201/" class="md-tabs__link">
          
  
    
  
  ğŸš€ Re:0 Road to CPath & Visualization

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../1.1%20Single-cell%20RNA%20sequencing/" class="md-tabs__link">
          
  
    
  
  ğŸ’¤ Re:0 Road to scRNA-seq Analysis

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Large-scale%20foundation%20model%20on%20single-cell%20transcriptomics/" class="md-tabs__link">
          
  
    
  
  ğŸ§¬ scRNA Analysis

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../%E7%AC%AC%201%20%E7%AB%A0%20python%20%E5%85%A5%E9%97%A8/" class="md-tabs__link">
          
  
    
  
  ğŸ“ Data Structures

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Best%20practices%20for%20single-cell%20analysis%20across%20modalities/" class="md-tabs__link">
          
  
    
  
  ğŸ’¡ Reviews

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="One Last Kiss" class="md-nav__button md-logo" aria-label="One Last Kiss" data-md-component="logo">
      
  <img src="../img/icon.png" alt="logo">

    </a>
    One Last Kiss
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aletolia/aletolia.github.io.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aletolia/aletolia.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ğŸ  Home
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            ğŸ  Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    â›ï¸ CV and Multimodels
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            â›ï¸ CV and Multimodels
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mygo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MyGO: Discrete Modality Information as Fine-Grained Tokens for Multi-modal Knowledge Graph Completion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GMM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GMM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DINO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DINO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mamba/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mamba
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ViT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ViT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Self-Supervised%20Learning%20MoCo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MoCo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Self-Supervised%20Learning%20MoCoV2%2C3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MoCo V2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E4%B8%80%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer  (ä¸€)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%20%28%E4%BA%8C%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (äºŒ)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E4%B8%89%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer  (ä¸‰)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E5%9B%9B%29%20%28TNT%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (å››)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28%E7%9F%A5%E8%AF%86%E8%92%B8%E9%A6%8F%20%E9%A2%84%E8%AE%AD%E7%BB%83%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer (çŸ¥è¯†è’¸é¦ é¢„è®­ç»ƒï¼‰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Transformer%20%28PyramidTNT%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Transformer(Pyramid TNT)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0%E5%92%8C%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E4%B8%93%E9%A2%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‚…é‡Œå¶çº§æ•°å’Œå‚…é‡Œå¶å˜æ¢ä¸“é¢˜
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Python%20%E5%AD%98%E5%82%A8%E4%B8%8E%E8%AF%BB%E5%8F%96%20HDF5%20%E6%96%87%E4%BB%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python å­˜å‚¨ä¸è¯»å– HDF5 æ–‡ä»¶
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Segment%20Anything%20in%20Medical%20Images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Segment Anything in Medical Images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vision%20Mamba%20Efficient%20Visual%20Representation%20Learning%20with%20Bidirectional%20State%20Space%20Model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Mamba Efficient Visual Representation Learning with Bidirectional State Space Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_18" >
        
          
          <label class="md-nav__link" for="__nav_2_18" id="__nav_2_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸš‘ åŒ»å­¦å½±åƒç›¸å…³
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_18">
            <span class="md-nav__icon md-icon"></span>
            ğŸš‘ åŒ»å­¦å½±åƒç›¸å…³
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Why%20is%20the%20winner%20the%20best/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why is the winner the best
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PORPOISE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PORPOISE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HIPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling Vision Transformers to Gigapixel Images via Hierarchical Self-Supervised Learning(HIPT)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Data-efficient%20and%20weakly%20supervised%20computational%20pathology%20on%20whole-slide%20images%28CLAM%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data efficient and weakly supervised computational pathology on whole slide images(CLAM)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Towards%20a%20general-purpose%20foundation%20model%20for%20computational%20pathology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Towards a general purpose foundation model for computational pathology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20whole-slide%20foundation%20model%20for%20digital%20pathology%20from%20real-world%20data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A whole slide foundation model for digital pathology from real world data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20visual-language%20foundation%20model%20for%20computational%20pathology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A visual language foundation model for computational pathology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Recurrent%20memory%20with%20optimal%20polynomial%20projections./" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recurrent memory with optimal polynomial projections.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Modeling%20Dense%20Multimodal%20Interactions%20Between%20Biological%20Pathways%20and%20Histology%20for%20Survival%20Prediction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Dense Multimodal Interactions Between Biological Pathways and Histology for Survival Prediction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Inferring%20super-resolution%20tissue%20architecture%20by%20integrating%20spatial%20transcriptomics%20with%20histology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inferring super resolution tissue architecture by integrating spatial transcriptomics with histology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Prediction%20of%20recurrence%20risk%20in%20endometrial%20cancer%20with%20multimodal%20deep%20learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prediction of recurrence risk in endometrial cancer with multimodal deep learning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ğŸš€ Re:0 Road to CPath & Visualization
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ğŸš€ Re:0 Road to CPath & Visualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç†è§£å…¨å¹…åˆ‡ç‰‡å›¾åƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%202/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨è®¡ç®—ç—…ç†å­¦ä¸­ç”¨äºç™Œç—‡è¯Šæ–­çš„å¼±ç›‘ç£æ·±åº¦å­¦ä¹ 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Session%203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºäºæ³¨æ„åŠ›çš„å¤šç¤ºä¾‹å­¦ä¹ å¯è§£é‡Šæ€§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../How%20to%20visualize%20Attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to visualize Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AttentionViz%20A%20Global%20View%20of%20Transformer%20Attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AttentionViz A Global View of Transformer Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformer%20Interpretability%20Beyond%20Attention%20Visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer Interpretability Beyond Attention Visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Visualization%20Work%20Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualization Work Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Attention%20Generation%20Work%20Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attention Generation Work Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" checked>
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ğŸª› PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            ğŸª› PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Autograd mechanics â€” PyTorch 2 3 documentation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Autograd mechanics â€” PyTorch 2 3 documentation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#autograd" class="md-nav__link">
    <span class="md-ellipsis">
      Autograd å¦‚ä½•è®°å½•å†å²
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      å·²ä¿å­˜çš„å¼ é‡
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      éå¯å¾®å‡½æ•°çš„æ¢¯åº¦
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      å±€éƒ¨ç¦ç”¨æ¢¯åº¦è®¡ç®—
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å±€éƒ¨ç¦ç”¨æ¢¯åº¦è®¡ç®—">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requires_grad" class="md-nav__link">
    <span class="md-ellipsis">
      è®¾ç½® requires_grad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grad-modes" class="md-nav__link">
    <span class="md-ellipsis">
      Grad Modes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      é»˜è®¤æ¨¡å¼ï¼ˆæ¢¯åº¦æ¨¡å¼ï¼‰
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      æ— æ¢¯åº¦æ¨¡å¼
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨ç†æ¨¡å¼
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nnmoduleeval" class="md-nav__link">
    <span class="md-ellipsis">
      è¯„ä¼°æ¨¡å¼ (nn.Module.eval())
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autograd_1" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ Autograd çš„å°±åœ°æ“ä½œ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ä½¿ç”¨ Autograd çš„å°±åœ°æ“ä½œ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      å°±åœ°æ­£ç¡®æ€§æ£€æŸ¥
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autograd_2" class="md-nav__link">
    <span class="md-ellipsis">
      å¤šçº¿ç¨‹ Autograd
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¤šçº¿ç¨‹ Autograd">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu" class="md-nav__link">
    <span class="md-ellipsis">
      CPU å¹¶å‘
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸ç¡®å®šæ€§
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      ä¿ç•™è®¡ç®—å›¾
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autograd_3" class="md-nav__link">
    <span class="md-ellipsis">
      Autograd èŠ‚ç‚¹ä¸Šçš„çº¿ç¨‹å®‰å…¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      C++ é’©å­ä¸Šçš„çº¿ç¨‹ä¸å®‰å…¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autograd_4" class="md-nav__link">
    <span class="md-ellipsis">
      å¤æ•°çš„ Autograd
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¤æ•°çš„ Autograd">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ä»€ä¹ˆæ˜¯å¤æ•°å¯¼æ•°ï¼Ÿ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      ç»´å°”å»·æ ¼å¾®ç§¯åˆ†ç™»åœº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      ç»´å°”å»·æ ¼å¾®ç§¯åˆ†åœ¨ä¼˜åŒ–ä¸­çš„ä½œç”¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      PyTorch å¦‚ä½•è®¡ç®—å…±è½­ç»´å°”å»·æ ¼å¯¼æ•°ï¼Ÿ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      å¦‚ä½•ä¸ºå¤æ•°å‡½æ•°ç¼–å†™å¯¼æ•°å…¬å¼ï¼Ÿ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      è·¨åŸŸå‡½æ•°å‘¢ï¼Ÿ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      å·²ä¿å­˜å¼ é‡çš„é’©å­
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å·²ä¿å­˜å¼ é‡çš„é’©å­">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      åå‘ä¼ æ’­é’©å­çš„æ‰§è¡Œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      é’©å­æ˜¯å¦ä¼šè§¦å‘
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      é’©å­è§¦å‘é¡ºåº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      ç‰¹æ®Šé’©å­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      ä¿®æ”¹å¼ é‡æ—¶çš„é’©å­è¡Œä¸º
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorregister_hookhook" class="md-nav__link">
    <span class="md-ellipsis">
      Tensor.register_hook(hook)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PyTorch%20Autograd%20Explained%20-%20In-depth%20Tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Autograd Explained   In depth Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ’¤ Re:0 Road to scRNA-seq Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ğŸ’¤ Re:0 Road to scRNA-seq Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Using Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Using Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    â³ CHAPTER 1 ç®€ä»‹
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            â³ CHAPTER 1 ç®€ä»‹
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.1%20Single-cell%20RNA%20sequencing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1.The building block of life
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.2%20Raw%20Data%20Processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 Raw data processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.3%20Analysis%20frameworks%20and%20tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Analysis frameworks and tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸŒ CHAPTER 2 æ•°æ®å‡†å¤‡ä¸å¯è§†åŒ–
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            ğŸŒ CHAPTER 2 æ•°æ®å‡†å¤‡ä¸å¯è§†åŒ–
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1%20quality_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 Quality Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2%20normalization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 Normalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.3_feature_selection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 Feature selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.4_dimensionality_reduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4 Dimensionality Reduction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_3" id="__nav_4_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ€ CHAPTER 3 è¯†åˆ«ç»†èƒç»“æ„
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_3">
            <span class="md-nav__icon md-icon"></span>
            ğŸ€ CHAPTER 3 è¯†åˆ«ç»†èƒç»“æ„
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.1clustering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 Clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.2annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 Annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 Data integration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4" id="__nav_4_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    â±ï¸ CHAPTER 4 æ¨æ–­ç»†èƒè½¨è¿¹
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4">
            <span class="md-nav__icon md-icon"></span>
            â±ï¸ CHAPTER 4 æ¨æ–­ç»†èƒè½¨è¿¹
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pseudotemporal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 Pseudotemporal ordering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rna_velocity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 RNA velocity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lineage_tracing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 Lineage tracing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_5" >
        
          
          <label class="md-nav__link" for="__nav_4_1_5" id="__nav_4_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ CHAPTER 5 åº”å¯¹ç‰¹æ®Šæƒ…å†µ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_5">
            <span class="md-nav__icon md-icon"></span>
            ğŸ CHAPTER 5 åº”å¯¹ç‰¹æ®Šæƒ…å†µ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../differential_gene_expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 Differential gene expression analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compositional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 Compositional analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gsea_pathway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 Gene set enrichment and pathway analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perturbation_modeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4 Perturbation modeling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_6" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6" id="__nav_4_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    âš™ï¸ CHAPTER 6 æœºåˆ¶å»ºæ¨¡
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6">
            <span class="md-nav__icon md-icon"></span>
            âš™ï¸ CHAPTER 6 æœºåˆ¶å»ºæ¨¡
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gene_regulatory_networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 Gene regulatory networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cell_cell_communication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 Cell-cell communication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_7" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7" id="__nav_4_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ”“ CHAPTER 7 åå·ç§¯
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7">
            <span class="md-nav__icon md-icon"></span>
            ğŸ”“ CHAPTER 7 åå·ç§¯
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bulk_deconvolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1 Bulk deconvolution
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç®€æ˜æ˜“æ‡‚çš„å•ç»†èƒåˆ†ææµç¨‹ï¼ˆä½¿ç”¨ R è¯­è¨€ï¼‰
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            ç®€æ˜æ˜“æ‡‚çš„å•ç»†èƒåˆ†ææµç¨‹ï¼ˆä½¿ç”¨ R è¯­è¨€ï¼‰
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%89%8D%E8%A8%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‰è¨€
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¯å¢ƒé…ç½®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.1%20%E6%9E%84%E5%BB%BA%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E5%88%86%E6%9E%90%E7%8E%AF%E5%A2%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1 æ„å»ºå•ç»†èƒ RNA seq åˆ†æç¯å¢ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.2%20R%20%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 R ç¯å¢ƒå®‰è£…
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.3%20Docker%20%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Docker å®‰è£…
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.4%20%E5%9C%A8%20Docker%20%E4%B8%AD%E5%90%AF%E5%8A%A8%20Rstudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4 åœ¨ Docker ä¸­å¯åŠ¨ Rstudio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.5%20%E6%9C%89%E5%85%B3%20Bioconductor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5 æœ‰å…³ Bioconductor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1%20R%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 R çš„åŸºæœ¬ç”¨æ³•
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2%20%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%20DataFrame%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 å¦‚ä½•å¤„ç† DataFrameï¼Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.3%20%E4%BD%BF%E7%94%A8%20ggplot2%20%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 ä½¿ç”¨ ggplot2 å¯è§†åŒ–æ•°æ®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.1%20PCA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 PCA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.2%20%E4%BD%BF%E7%94%A8%20clusterPlofiler%20%E8%BF%9B%E8%A1%8C%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 ä½¿ç”¨ clusterPlofiler è¿›è¡Œå¯Œé›†åˆ†æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3%20%E5%9F%BA%E5%9B%A0%E6%9C%AC%E4%BD%93%EF%BC%88GO%EF%BC%89%E4%B8%AD%E5%90%84%20BP%E3%80%81MF%20%E5%92%8C%20CC%20%E7%9A%84%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 åŸºå› æœ¬ä½“ï¼ˆGOï¼‰ä¸­å„ BPã€MF å’Œ CC çš„å¯Œé›†åˆ†æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.3%20%E4%BD%BF%E7%94%A8%20DEseq2%20%E6%8F%90%E5%8F%96%20RNA-seq%20%E5%88%86%E6%9E%90%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%20DEG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 ä½¿ç”¨ DEseq2 æå– RNA seq åˆ†ææ•°æ®ä¸­çš„ DEG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.4%20%E4%BD%BF%E7%94%A8%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88KEGG%E3%80%81Reactome%20%E7%AD%89%EF%BC%89%E8%BF%9B%E8%A1%8C%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4 ä½¿ç”¨å…¶ä»–æ•°æ®åº“ï¼ˆKEGGã€Reactome ç­‰ï¼‰è¿›è¡Œå¯Œé›†åˆ†æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.1%20scRNA-seq%20%E6%A6%82%E8%A6%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 scRNA seq æ¦‚è¦
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.2%20%E5%87%86%E5%A4%87%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 å‡†å¤‡ä½¿ç”¨ Seurat è¿›è¡Œåˆ†æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.3%20%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 ä½¿ç”¨ Seurat è¿›è¡Œæ•°æ®é¢„å¤„ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.4%20%E4%BD%BF%E7%94%A8%20Seurat%20%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%9A%84%E4%B8%80%E8%88%AC%E9%A1%BA%E5%BA%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4 ä½¿ç”¨ Seurat è¿›è¡Œæ•°æ®åˆ†æçš„ä¸€èˆ¬é¡ºåº
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.1%20%E5%A6%82%E4%BD%95%E6%9F%A5%E6%89%BE%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 å¦‚ä½•æŸ¥æ‰¾å•ç»†èƒ RNA seq æ•°æ®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.2%20%E4%B8%BA%E6%AF%8F%E4%B8%AA%E7%B0%87%E8%87%AA%E5%8A%A8%E6%B7%BB%E5%8A%A0%E7%BB%86%E8%83%9E%E6%B3%A8%E9%87%8A%E6%A0%87%E7%AD%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 ä¸ºæ¯ä¸ªç°‡è‡ªåŠ¨æ·»åŠ ç»†èƒæ³¨é‡Šæ ‡ç­¾
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.3%20%E4%BD%BF%E7%94%A8%20FeaturePlot%20%E6%A3%80%E6%9F%A5%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 ä½¿ç”¨ FeaturePlot æ£€æŸ¥åŸºå› è¡¨è¾¾
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.4%20%E5%B0%86%E5%8D%95%E7%BB%86%E8%83%9E%20RNA-seq%20%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9B%B8%E4%BA%92%E7%BB%93%E5%90%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4 å°†å•ç»†èƒ RNA seq æ•°æ®é›†ç›¸äº’ç»“åˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.5%20%E7%BA%A0%E6%AD%A3%E6%89%B9%E6%AC%A1%E6%95%88%E5%BA%94%EF%BC%8C%E6%AF%94%E8%BE%83%E5%AF%B9%E7%85%A7%E7%BB%84%E5%92%8C%E5%88%BA%E6%BF%80%E7%BB%84/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.5 çº æ­£æ‰¹æ¬¡æ•ˆåº”ï¼Œæ¯”è¾ƒå¯¹ç…§ç»„å’Œåˆºæ¿€ç»„
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.6%20%E7%A1%AE%E5%AE%9A%E6%AF%8F%E4%B8%AA%E7%BE%A4%E7%BB%84%E7%9A%84%E6%A0%87%E8%AE%B0%E5%9F%BA%E5%9B%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.6 ç¡®å®šæ¯ä¸ªç¾¤ç»„çš„æ ‡è®°åŸºå› 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.1%20%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%20Cell%20Ranger%20%E7%BB%9F%E8%AE%A1%20scRNA-seq%20%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%B0%B4%E5%B9%B3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 å¦‚ä½•ä½¿ç”¨ Cell Ranger ç»Ÿè®¡ scRNA seq æ•°æ®ä¸­çš„åŸºå› è¡¨è¾¾æ°´å¹³
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.2%20%E4%BD%BF%E7%94%A8%20Cell%20Ranger%20%E5%A4%84%E7%90%86%20NCBI%20Sequence%20Read%20Archive%20%28SRA%29%20%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 ä½¿ç”¨ Cell Ranger å¤„ç† NCBI Sequence Read Archive (SRA) æ•°æ®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.1%20%E5%85%B3%E4%BA%8E%20scRNA-seq%20%E6%95%B0%E6%8D%AE%E7%9A%84%E8%B4%A8%E9%87%8F%E6%8E%A7%E5%88%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1 å…³äº scRNA seq æ•°æ®çš„è´¨é‡æ§åˆ¶
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.2%20%E4%BD%BF%E7%94%A8%20DoubleFinder%20%E6%A3%80%E6%B5%8B%E5%8F%8C%E9%87%8D%E7%BB%86%E8%83%9E/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.2 ä½¿ç”¨ DoubleFinder æ£€æµ‹åŒé‡ç»†èƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.3%20%E7%94%A8%20CellBender%20%E5%8E%BB%E9%99%A4%E8%83%8C%E6%99%AF%20RNA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.3 ç”¨ CellBender å»é™¤èƒŒæ™¯ RNA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ§¬ scRNA Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            ğŸ§¬ scRNA Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ Using Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            ğŸ Using Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Large-scale%20foundation%20model%20on%20single-cell%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Large scale foundation model on single cell transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scGPT%20toward%20building%20a%20foundation%20model%20for%20single-cell%20multi-omics%20using%20generative%20AI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scGPT toward building a foundation model for single cell multi omics using generative AI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scBERT%20as%20a%20large-scale%20pretrained%20deep%20language%20model%20for%20cell%20type%20annotation%20of%20single-cell%20RNA-seq%20data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scBERT as a large scale pretrained deep language model for cell type annotation of single cell RNA seq data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RNA%20velocity%20of%20single%20cells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RNA velocity of single cells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TFvelo_gene%20regulation%20inspired%20RNA%20velocity%20estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TFvelo gene regulation inspired RNA velocity estimation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Disentanglement%20of%20single-cell%20data%20with%20biolord/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disentanglement of single cell data with biolord
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E2%AD%90%E2%AD%90%E2%AD%90C5aR1%20inhibition%20reprograms%20tumor%20associated%20macrophages%20and%20reverses%20PARP%20inhibitor%20resistance%20in%20breast%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    â­â­â­C5aR1 inhibition reprograms tumor associated macrophages and reverses PARP inhibitor resistance in breast cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Spatial%20transition%20tensor%20of%20single%20cells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial transition tensor of single cells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Statistical%20method%20scDEED%20for%20detecting%20dubious%202D%20single-cell%20embeddings%20and%20optimizing%20t-SNE%20and%20UMAP%20hyperparameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistical method scDEED for detecting dubious 2D single cell embeddings and optimizing t SNE and UMAP hyperparameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scRank%20infers%20drug-responsive%20cell%20types%20from%20untreated%20scRNA-seq%20data%20using%20a%20target-perturbed%20gene%20regulatory%20network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scRank infers drug responsive cell types from untreated scRNA seq data using a target perturbed gene regulatory network
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ“” æ–‡çŒ®
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            ğŸ“” æ–‡çŒ®
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ZNF689%20deficiency%20promotes%20intratumor%20heterogeneity%20and%20immunotherapy%20resistance%20in%20triple-negative%20breast%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZNF689 deficiency promotes intratumor heterogeneity and immunotherapy resistance in triple negative breast cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tumour%20vasculature%20at%20single-cell%20resolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tumour vasculature at single-cell resolution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scRNA-seq%20of%20gastric%20tumor%20shows%20complex%20intercellular%20interaction%20with%20an%20alternative%20T%20cell%20exhaustion%20trajectory%EF%BC%88%E5%8F%82%E8%80%83%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scRNA seq of gastric tumor shows complex intercellular interaction with an alternative T cell exhaustion trajectoryï¼ˆå‚è€ƒï¼‰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20analysis%20reveals%20new%20evolutionary%20complexity%20in%20uveal%20melanoma%EF%BC%88%E5%8F%82%E8%80%83%202%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis reveals new evolutionary complexity in uveal melanomaï¼ˆå‚è€ƒ 2ï¼‰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20characterization%20of%20macrophages%20in%20uveal%20melanoma%20uncovers%20transcriptionally%20heterogeneous%20subsets%20conferring%20poor%20prognosis%20and%20aggressive%20behavior%EF%BC%88%E8%8C%83%E4%BE%8B%201%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell characterization of macrophages in uveal melanoma uncovers transcriptionally heterogeneous subsets conferring poor prognosis and aggressive behaviorï¼ˆèŒƒä¾‹ 1ï¼‰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ScRNA-seq%20of%20gastric%20cancer%20tissues%20reveals%20differences%20in%20the%20immune%20microenvironment%20of%20primary%20tumors%20and%20metastases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScRNA seq of gastric cancer tissues reveals differences in the immune microenvironment of primary tumors and metastases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Blimp-1%20and%20c-Maf%20regulate%20immune%20gene%20networks%20to%20protect%20against%20distinct%20pathways%20of%20pathobiont-induced%20colitis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blimp 1 and c Maf regulate immune gene networks to protect against distinct pathways of pathobiont induced colitis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single%20cell%20analysis%20unveils%20B%20cell-dominated%20immune%20subtypes%20in%20HNSCC%20for%20enhanced%20prognostic%20and%20therapeutic%20stratification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis unveils B cell dominated immune subtypes in HNSCC for enhanced prognostic and therapeutic stratification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20spatial%20multi-omics%20and%20deep%20learning%20dissect%20enhancer-driven%20gene%20regulatory%20networks%20in%20liver%20zonation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell spatial multi omics and deep learning dissect enhancer driven gene regulatory networks in liver zonation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Neutrophil%20profiling%20illuminates%20anti-tumor%20antigen%20presenting%20potency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neutrophil profiling illuminates anti tumor antigen presenting potency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20blueprint%20for%20tumor-infiltrating%20B%20cells%20across%20human%20cancers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A blueprint for tumor infiltrating B cells across human cancers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20transcriptomic%20analyses%20reveal%20distinct%20immune%20cell%20contributions%20to%20epithelial%20barrier%20dysfunction%20in%20checkpoint%20inhibitor%20colitis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell transcriptomic analyses reveal distinct immune cell contributions to epithelial barrier dysfunction in checkpoint inhibitor colitis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Systematic%20dissection%20of%20tumor-normal%20single-cell%20ecosystems%20across%20a%20thousand%20tumors%20of%2030%20cancer%20types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Systematic dissection of tumor normal single cell ecosystems across a thousand tumors of 30 cancer types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../The%20aged%20tumor%20microenvironment%20limits%20T%20cell%20control%20of%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The aged tumor microenvironment limits T cell control of cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TIM-3%2B%20CD8%20T%20cells%20with%20a%20terminally%20exhausted%20phenotype%20retain%20functional%20capacity%20in%20hematological%20malignancies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TIM 3+ CD8 T cells with a terminally exhausted phenotype retain functional capacity in hematological malignancies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20lactate-SREBP2%20signaling%20axis%20drives%20tolerogenic%20dendritic%20cell%20maturation%20and%20promotes%20cancer%20progression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A lactate SREBP2 signaling axis drives tolerogenic dendritic cell maturation and promotes cancer progression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20human%20omentum-specific%20mesothelial-like%20stromal%20population%20inhibits%20adipogenesis%20through%20IGFBP2%20secretion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A human omentum specific mesothelial like stromal population inhibits adipogenesis through IGFBP2 secretion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Interferon-stimulated%20neutrophils%20as%20a%20predictor%20of%20immunotherapy%20response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interferon stimulated neutrophils as a predictor of immunotherapy response
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Repression%20of%20latent%20NF-%CE%BAB%20enhancers%20by%20PDX1%20regulates%20%CE%B2%20cell%20functional%20heterogeneity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repression of latent NF ÎºB enhancers by PDX1 regulates Î² cell functional heterogeneity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20systematic%20pan-cancer%20study%20on%20deep%20learning-based%20prediction%20of%20multi-omic%20biomarkers%20from%20routine%20pathology%20images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A systematic pan cancer study on deep learning based prediction of multi omic biomarkers from routine pathology images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20and%20spatial%20transcriptomics%20analysis%20of%20non-small%20cell%20lung%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell and spatial transcriptomics analysis of non small cell lung cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Seeing%20data%20as%20t-SNE%20and%20UMAP%20do/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seeing data as t SNE and UMAP do
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mapping%20the%20cellular%20biogeography%20of%20human%20bone%20marrow%20niches%20using%20single-cell%20transcriptomics%20and%20proteomic%20imaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mapping the cellular biogeography of human bone marrow niches using single cell transcriptomics and proteomic imaging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Onco-fetal%20Reprogramming%20of%20Endothelial%20Cells%20Drives%20Immunosuppressive%20Macrophages%20in%20Hepatocellular%20Carcinoma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Onco fetal Reprogramming of Endothelial Cells Drives Immunosuppressive Macrophages in Hepatocellular Carcinoma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20analysis%20of%20anti-BCMA%20CAR%20T%20cell%20therapy%20in%20patients%20with%20central%20nervous%20system%20autoimmunity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell analysis of anti BCMA CAR T cell therapy in patients with central nervous system autoimmunity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Single-cell%20sequencing%20depicts%20tumor%20architecture%20and%20empowers%20clinical%20decision%20in%20metastatic%20conjunctival%20melanoma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single cell sequencing depicts tumor architecture and empowers clinical decision in metastatic conjunctival melanoma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PR-SET7%20epigenetically%20restrains%20uterine%20interferon%20response%20and%20cell%20death%20governing%20proper%20postnatal%20stromal%20development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PR SET7 epigenetically restrains uterine interferon response and cell death governing proper postnatal stromal development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Clonal%20associations%20between%20lymphocyte%20subsets%20and%20functional%20states%20in%20rheumatoid%20arthritis%20synovium/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clonal associations between lymphocyte subsets and functional states in rheumatoid arthritis synovium
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ“ Data Structures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            ğŸ“ Data Structures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%201%20%E7%AB%A0%20python%20%E5%85%A5%E9%97%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 1 ç«  python å…¥é—¨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%202%20%E7%AB%A0%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 2 ç«  é¢å‘å¯¹è±¡ç¼–ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%203%20%E7%AB%A0%20%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 3 ç«  ç®—æ³•åˆ†æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%204%20%E7%AB%A0%20%E9%80%92%E5%BD%92/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 4 ç«  é€’å½’
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%205%20%E7%AB%A0%20%E5%9F%BA%E4%BA%8E%E6%95%B0%E7%BB%84%E7%9A%84%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 5 ç«  åŸºäºæ•°ç»„çš„åºåˆ—
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%206%20%E7%AB%A0%20%E6%A0%88%E3%80%81%E9%98%9F%E5%88%97%E5%92%8C%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 6 ç«  æ ˆã€é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%207%20%E7%AB%A0%20%E9%93%BE%E8%A1%A8%28Linked%20Lists%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 7 ç«  é“¾è¡¨(Linked Lists)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%208%20%E7%AB%A0%20%E6%A0%91%20%E2%98%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 8 ç«  æ ‘ â˜…
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%209%20%E7%AB%A0%20%E4%BC%98%E5%85%88%E7%BA%A7%E9%98%9F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬¬ 9 ç«  ä¼˜å…ˆçº§é˜Ÿåˆ—
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ’¡ Reviews
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            ğŸ’¡ Reviews
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ§­ scRNA analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            ğŸ§­ scRNA analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Best%20practices%20for%20single-cell%20analysis%20across%20modalities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Best practices for single cell analysis across modalities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Multi-omics%20integration%20in%20biomedical%20research%20%E2%80%93%20A%20metabolomics-centric%20review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi omics integration in biomedical research â€“ A metabolomics centric review
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Museum%20of%20spatial%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Museum of spatial transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20guide%20to%20artificial%20intelligence%20for%20cancer%20researchers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A guide to artificial intelligence for cancer researchers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ¦  Metabolism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            ğŸ¦  Metabolism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20analysis%20as%20a%20driver%20for%20discovery%2C%20diagnosis%2C%20and%20therapy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic analysis as a driver for discovery, diagnosis, and therapy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20heterogeneity%20in%20cancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic heterogeneity in cancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Toward%20modeling%20metabolic%20state%20from%20single-cell%20transcriptomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toward modeling metabolic state from single cell transcriptomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metabolic%20reprogramming%20and%20cancer%20progression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolic reprogramming and cancer progression
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protein
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Protein
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Proteomic%20and%20interactomic%20insights%20into%20the%20molecular%20basis%20of%20cell%20functional%20diversity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proteomic and interactomic insights into the molecular basis of cell functional diversity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#autograd" class="md-nav__link">
    <span class="md-ellipsis">
      Autograd å¦‚ä½•è®°å½•å†å²
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      å·²ä¿å­˜çš„å¼ é‡
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      éå¯å¾®å‡½æ•°çš„æ¢¯åº¦
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      å±€éƒ¨ç¦ç”¨æ¢¯åº¦è®¡ç®—
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å±€éƒ¨ç¦ç”¨æ¢¯åº¦è®¡ç®—">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requires_grad" class="md-nav__link">
    <span class="md-ellipsis">
      è®¾ç½® requires_grad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grad-modes" class="md-nav__link">
    <span class="md-ellipsis">
      Grad Modes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      é»˜è®¤æ¨¡å¼ï¼ˆæ¢¯åº¦æ¨¡å¼ï¼‰
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      æ— æ¢¯åº¦æ¨¡å¼
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨ç†æ¨¡å¼
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nnmoduleeval" class="md-nav__link">
    <span class="md-ellipsis">
      è¯„ä¼°æ¨¡å¼ (nn.Module.eval())
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autograd_1" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ Autograd çš„å°±åœ°æ“ä½œ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ä½¿ç”¨ Autograd çš„å°±åœ°æ“ä½œ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      å°±åœ°æ­£ç¡®æ€§æ£€æŸ¥
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autograd_2" class="md-nav__link">
    <span class="md-ellipsis">
      å¤šçº¿ç¨‹ Autograd
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¤šçº¿ç¨‹ Autograd">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu" class="md-nav__link">
    <span class="md-ellipsis">
      CPU å¹¶å‘
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸ç¡®å®šæ€§
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      ä¿ç•™è®¡ç®—å›¾
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autograd_3" class="md-nav__link">
    <span class="md-ellipsis">
      Autograd èŠ‚ç‚¹ä¸Šçš„çº¿ç¨‹å®‰å…¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      C++ é’©å­ä¸Šçš„çº¿ç¨‹ä¸å®‰å…¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autograd_4" class="md-nav__link">
    <span class="md-ellipsis">
      å¤æ•°çš„ Autograd
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¤æ•°çš„ Autograd">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ä»€ä¹ˆæ˜¯å¤æ•°å¯¼æ•°ï¼Ÿ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      ç»´å°”å»·æ ¼å¾®ç§¯åˆ†ç™»åœº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      ç»´å°”å»·æ ¼å¾®ç§¯åˆ†åœ¨ä¼˜åŒ–ä¸­çš„ä½œç”¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      PyTorch å¦‚ä½•è®¡ç®—å…±è½­ç»´å°”å»·æ ¼å¯¼æ•°ï¼Ÿ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      å¦‚ä½•ä¸ºå¤æ•°å‡½æ•°ç¼–å†™å¯¼æ•°å…¬å¼ï¼Ÿ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      è·¨åŸŸå‡½æ•°å‘¢ï¼Ÿ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      å·²ä¿å­˜å¼ é‡çš„é’©å­
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å·²ä¿å­˜å¼ é‡çš„é’©å­">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      åå‘ä¼ æ’­é’©å­çš„æ‰§è¡Œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      é’©å­æ˜¯å¦ä¼šè§¦å‘
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      é’©å­è§¦å‘é¡ºåº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      ç‰¹æ®Šé’©å­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      ä¿®æ”¹å¼ é‡æ—¶çš„é’©å­è¡Œä¸º
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorregister_hookhook" class="md-nav__link">
    <span class="md-ellipsis">
      Tensor.register_hook(hook)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/aletolia/aletolia.github.io.git/edit/master/docs/Autograd mechanics â€” PyTorch 2_3 documentation.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/aletolia/aletolia.github.io.git/raw/master/docs/Autograd mechanics â€” PyTorch 2_3 documentation.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Autograd mechanics â€” PyTorch 2 3 documentation</h1>

<p>è¿™ç¯‡è¯´æ˜å°†æ¦‚è¿° autograd å¦‚ä½•è¿è¡Œä»¥åŠè®°å½•æ“ä½œã€‚è™½ç„¶æ²¡æœ‰å¿…è¦æŒæ¡æ‰€æœ‰ç»†èŠ‚ï¼Œä½†æˆ‘ä»¬å»ºè®®æ‚¨ç†Ÿæ‚‰è¿™äº›å†…å®¹ï¼Œå› ä¸ºè¿™æœ‰åŠ©äºç¼–å†™æ›´é«˜æ•ˆã€æ¸…æ™°çš„ç¨‹åºï¼Œå¹¶èƒ½åœ¨è°ƒè¯•ä¸­æä¾›å¸®åŠ©ã€‚</p>
<h3 id="autograd">Autograd å¦‚ä½•è®°å½•å†å²<a class="headerlink" href="#autograd" title="Permanent link">&para;</a></h3>
<p>Autograd æ˜¯ä¸€ç§åå‘è‡ªåŠ¨å¾®åˆ†ç³»ç»Ÿã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œautograd åœ¨æ‚¨æ‰§è¡Œæ“ä½œçš„åŒæ—¶ä¼šè®°å½•ä¸€å¼ åŒ…å«æ‰€æœ‰åˆ›å»ºæ•°æ®æ“ä½œçš„å›¾ï¼Œå¹¶å½¢æˆä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼Œå…¶å¶èŠ‚ç‚¹æ˜¯è¾“å…¥å¼ é‡ï¼Œæ ¹èŠ‚ç‚¹æ˜¯è¾“å‡ºå¼ é‡ã€‚é€šè¿‡ä»æ ¹èŠ‚ç‚¹è¿½æº¯åˆ°å¶èŠ‚ç‚¹ï¼Œæ‚¨å¯ä»¥è‡ªåŠ¨ä½¿ç”¨é“¾å¼æ³•åˆ™è®¡ç®—æ¢¯åº¦ã€‚</p>
<p>åœ¨å†…éƒ¨ï¼Œautograd ä½¿ç”¨ <code>Function</code> å¯¹è±¡ï¼ˆå®é™…æ˜¯è¡¨è¾¾å¼ï¼‰æ¥è¡¨ç¤ºè¿™å¼ å›¾ï¼Œé€šè¿‡ <code>apply()</code> æ–¹æ³•å¯ä»¥è®¡ç®—è¯¥å›¾çš„è¾“å‡ºã€‚åœ¨è®¡ç®—æ­£å‘ä¼ é€’çš„åŒæ—¶ï¼Œautograd ä¼šæ‰§è¡Œæ‰€è¯·æ±‚çš„è®¡ç®—å¹¶æ„å»ºä¸€å¼ å›¾ï¼Œç”¨äºè®¡ç®—æ¢¯åº¦ï¼ˆæ¯ä¸ª <a href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="torch.Tensor"><code>torch.Tensor</code></a> çš„ <code>.grad_fn</code> å±æ€§å°±æ˜¯è¯¥å›¾çš„å…¥å£ï¼‰ã€‚å½“æ­£å‘ä¼ é€’å®Œæˆåï¼Œæˆ‘ä»¬ä¼šåœ¨åå‘ä¼ é€’ä¸­è¯„ä¼°è¿™å¼ å›¾ä»¥è®¡ç®—æ¢¯åº¦ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™å¼ å›¾åœ¨æ¯æ¬¡è¿­ä»£æ—¶éƒ½ä¼šä»å¤´å¼€å§‹é‡å»ºï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„çš„ Python æ§åˆ¶æµè¯­å¥ï¼Œä»è€Œåœ¨æ¯æ¬¡è¿­ä»£æ—¶æ›´æ”¹å›¾çš„æ•´ä½“å½¢çŠ¶å’Œå¤§å°ã€‚æ‚¨æ— éœ€åœ¨å¯åŠ¨è®­ç»ƒä¹‹å‰é¢„å…ˆç¼–ç æ‰€æœ‰å¯èƒ½çš„è·¯å¾„â€”â€”è¿è¡Œçš„å†…å®¹å°±æ˜¯æ‚¨éœ€è¦å¾®åˆ†çš„å†…å®¹ã€‚</p>
<h3 id="_1">å·²ä¿å­˜çš„å¼ é‡<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>æŸäº›æ“ä½œåœ¨æ­£å‘ä¼ é€’æœŸé—´éœ€è¦ä¿å­˜ä¸­é—´ç»“æœï¼Œä»¥åœ¨åå‘ä¼ é€’ä¸­æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œå‡½æ•° <span class="arithmatex">\( x \mapsto x^2 \)</span> ä¼šä¿å­˜è¾“å…¥ <span class="arithmatex">\( x \)</span> ä»¥è®¡ç®—æ¢¯åº¦ã€‚</p>
<p>åœ¨å®šä¹‰è‡ªå®šä¹‰ Python <a href="https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function" title="torch.autograd.Function"><code>Function</code></a> æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>save_for_backward()</code> åœ¨æ­£å‘ä¼ é€’ä¸­ä¿å­˜å¼ é‡ï¼Œå¹¶é€šè¿‡ <code>saved_tensors</code> åœ¨åå‘ä¼ é€’ä¸­æ£€ç´¢å®ƒä»¬ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://pytorch.org/docs/stable/notes/extending.html">æ‰©å±• PyTorch</a>ã€‚</p>
<p>å¯¹äº PyTorch å®šä¹‰çš„æ“ä½œï¼ˆå¦‚ <a href="https://pytorch.org/docs/stable/generated/torch.pow.html#torch.pow" title="torch.pow"><code>torch.pow()</code></a>ï¼‰ï¼Œéœ€è¦æ—¶ä¼šè‡ªåŠ¨ä¿å­˜å¼ é‡ã€‚ä¸ºäº†å­¦ä¹ æˆ–è°ƒè¯•çš„ç›®çš„ï¼Œå¯ä»¥é€šè¿‡æŸ¥æ‰¾å…¶ä»¥ <code>_saved</code> ä¸ºå‰ç¼€çš„å±æ€§ï¼ŒæŸ¥çœ‹ç‰¹å®š <code>grad_fn</code> ä¿å­˜äº†å“ªäº›å¼ é‡ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">grad_fn</span><span class="o">.</span><span class="n">_saved_self</span><span class="p">))</span>  <span class="c1"># True</span>
<span class="linenos" data-linenos="4 "></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="n">y</span><span class="o">.</span><span class="n">grad_fn</span><span class="o">.</span><span class="n">_saved_self</span><span class="p">)</span>  <span class="c1"># True</span>
</code></pre></div>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>y.grad_fn._saved_self</code> æŒ‡å‘ä¸ <code>x</code> ç›¸åŒçš„å¼ é‡å¯¹è±¡ï¼Œä½†æƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="linenos" data-linenos="3 "></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">grad_fn</span><span class="o">.</span><span class="n">_saved_result</span><span class="p">))</span>  <span class="c1"># True</span>
<span class="linenos" data-linenos="4 "></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span> <span class="ow">is</span> <span class="n">y</span><span class="o">.</span><span class="n">grad_fn</span><span class="o">.</span><span class="n">_saved_result</span><span class="p">)</span>  <span class="c1"># False</span>
</code></pre></div>
<p>åœ¨å†…éƒ¨ï¼ŒPyTorch ä¿å­˜å¼ é‡æ—¶ä½¿ç”¨<strong>æ‰“åŒ…</strong>æœºåˆ¶ä»¥é˜²æ­¢å¼•ç”¨å¾ªç¯ï¼Œç„¶ååœ¨è¯»å–æ—¶<strong>è§£åŒ…</strong>ä¸ºä¸åŒçš„å¼ é‡ã€‚åœ¨æ­¤ä¾‹ä¸­ï¼Œ<code>y.grad_fn._saved_result</code> ä¸­è·å–çš„å¼ é‡å¯¹è±¡ä¸ <code>y</code> å¹¶ä¸ç›¸åŒï¼ˆä½†å®ƒä»¬å…±äº«ç›¸åŒçš„å­˜å‚¨ï¼‰ã€‚</p>
<p>å¼ é‡æ˜¯å¦ä¼šè¢«æ‰“åŒ…æˆä¸åŒçš„å¼ é‡å¯¹è±¡å–å†³äºå®ƒæ˜¯å¦æ˜¯å…¶è‡ªèº« <code>grad_fn</code> çš„è¾“å‡ºï¼Œè¿™æ˜¯å®ç°ç»†èŠ‚ï¼Œå¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸åº”ä½œä¸ºä¾èµ–ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡ <a href="https://pytorch.org/docs/stable/notes/autograd.html#saved-tensors-hooks-doc">å·²ä¿å­˜å¼ é‡çš„é’©å­</a> æ¥æ§åˆ¶ PyTorch å¦‚ä½•æ‰“åŒ…/è§£åŒ…ã€‚</p>
<h3 id="_2">éå¯å¾®å‡½æ•°çš„æ¢¯åº¦<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>è‡ªåŠ¨å¾®åˆ†ä¸­çš„æ¢¯åº¦è®¡ç®—ä»…åœ¨æ¯ä¸ªä½¿ç”¨çš„åŸºæœ¬å‡½æ•°å‡å¯å¾®æ—¶æ‰æœ‰æ•ˆã€‚ç„¶è€Œï¼Œè®¸å¤šå®é™…ä½¿ç”¨çš„å‡½æ•°ä¸å…·æœ‰è¿™ä¸€æ€§è´¨ï¼ˆä¾‹å¦‚ <code>relu</code> æˆ– <code>sqrt</code> åœ¨ 0 å¤„ï¼‰ã€‚ä¸ºäº†å°½é‡å‡å°‘éå¯å¾®å‡½æ•°çš„å½±å“ï¼Œæˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹è§„åˆ™å®šä¹‰åŸºæœ¬æ“ä½œçš„æ¢¯åº¦ï¼š</p>
<ol>
<li>
<p>å¦‚æœå‡½æ•°åœ¨å½“å‰ç‚¹å¯å¾®å¹¶ä¸”å­˜åœ¨æ¢¯åº¦ï¼Œåˆ™ç›´æ¥ä½¿ç”¨è¯¥æ¢¯åº¦ã€‚</p>
</li>
<li>
<p>å¦‚æœå‡½æ•°æ˜¯å‡¸çš„ï¼ˆè‡³å°‘å±€éƒ¨å‡¸ï¼‰ï¼Œä½¿ç”¨æœ€å°èŒƒæ•°çš„æ¬¡æ¢¯åº¦ï¼ˆè¿™æ˜¯æœ€é™¡ä¸‹é™æ–¹å‘ï¼‰ã€‚</p>
</li>
<li>
<p>å¦‚æœå‡½æ•°æ˜¯å‡¹çš„ï¼ˆè‡³å°‘å±€éƒ¨å‡¹ï¼‰ï¼Œä½¿ç”¨æœ€å°èŒƒæ•°çš„ä¸Šæ¢¯åº¦ï¼ˆè€ƒè™‘ -f(x) å¹¶åº”ç”¨å‰ä¸€ç‚¹ï¼‰ã€‚</p>
</li>
<li>
<p>å¦‚æœå‡½æ•°å®šä¹‰æ˜ç¡®ï¼Œé€šè¿‡è¿ç»­æ€§åœ¨å½“å‰ç‚¹å®šä¹‰æ¢¯åº¦ï¼ˆæ­¤å¤„å¯èƒ½ä¸ºæ— ç©·ï¼Œä¾‹å¦‚ <code>sqrt(0)</code>ï¼‰ã€‚è‹¥å­˜åœ¨å¤šä¸ªå¯èƒ½å€¼ï¼Œåˆ™éšæœºé€‰å–ä¸€ä¸ªã€‚</p>
</li>
<li>
<p>å¦‚æœå‡½æ•°æœªå®šä¹‰ï¼ˆä¾‹å¦‚ <code>sqrt(-1)</code>ã€<code>log(-1)</code> æˆ–åœ¨è¾“å…¥ä¸º <code>NaN</code> æ—¶çš„å¤§å¤šæ•°å‡½æ•°ï¼‰ï¼Œæ‰€ç”¨çš„æ¢¯åº¦å€¼æ˜¯ä»»æ„çš„ï¼ˆæˆ‘ä»¬å¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ï¼Œä½†ä¸ä¿è¯ä¸€å®šå¦‚æ­¤ï¼‰ã€‚å¤§å¤šæ•°å‡½æ•°ä¼šå°†æ¢¯åº¦è®¾ä¸º <code>NaN</code>ï¼Œä½†å‡ºäºæ€§èƒ½åŸå› ï¼Œéƒ¨åˆ†å‡½æ•°ä¼šä½¿ç”¨å…¶ä»–å€¼ï¼ˆä¾‹å¦‚ <code>log(-1)</code>ï¼‰ã€‚</p>
</li>
<li>
<p>å¦‚æœå‡½æ•°ä¸æ˜¯ç¡®å®šæ€§æ˜ å°„ï¼ˆå³ä¸æ˜¯ä¸€ä¸ª<a href="https://en.wikipedia.org/wiki/Function_(mathematics)" title="æ•°å­¦å‡½æ•°">æ•°å­¦å‡½æ•°</a>ï¼‰ï¼Œåˆ™ä¼šè¢«æ ‡è®°ä¸ºä¸å¯å¾®åˆ†ã€‚å¦‚æœåœ¨éœ€è¦æ¢¯åº¦çš„å¼ é‡ä¸Šä½¿ç”¨æ­¤å‡½æ•°ä¸”ä¸åœ¨ <code>no_grad</code> ç¯å¢ƒä¸­ï¼Œå®ƒä¼šåœ¨åå‘ä¼ æ’­æ—¶æŠ›å‡ºé”™è¯¯ã€‚</p>
</li>
</ol>
<h3 id="_3">å±€éƒ¨ç¦ç”¨æ¢¯åº¦è®¡ç®—<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>åœ¨ Python ä¸­æœ‰å‡ ç§æœºåˆ¶å¯ä»¥å±€éƒ¨ç¦ç”¨æ¢¯åº¦è®¡ç®—ï¼š</p>
<p>ä¸ºäº†ç¦ç”¨æ•´ä¸ªä»£ç å—çš„æ¢¯åº¦è®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨æ— æ¢¯åº¦æ¨¡å¼ï¼ˆno-grad modeï¼‰å’Œæ¨ç†æ¨¡å¼ï¼ˆinference modeï¼‰è¿™ç±»ä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€‚å¯¹äºæ›´ç²¾ç»†åœ°ä»æ¢¯åº¦è®¡ç®—ä¸­æ’é™¤å­å›¾ï¼Œå¯ä»¥è®¾ç½®å¼ é‡çš„ <code>requires_grad</code> å±æ€§ã€‚</p>
<p>é™¤äº†è®¨è®ºä¸Šè¿°æœºåˆ¶å¤–ï¼Œæˆ‘ä»¬è¿˜æè¿°äº†è¯„ä¼°æ¨¡å¼ï¼ˆ<code>nn.Module.eval()</code>ï¼‰ã€‚å°½ç®¡å®ƒä¸ç”¨äºç¦ç”¨æ¢¯åº¦è®¡ç®—ï¼Œä½†å…¶åç§°å¸¸ä¸å…¶ä»–ä¸‰è€…æ··æ·†ã€‚</p>
<h4 id="requires_grad">è®¾ç½® <code>requires_grad</code><a class="headerlink" href="#requires_grad" title="Permanent link">&para;</a></h4>
<p><code>requires_grad</code> æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸º <code>False</code>ï¼ˆé™¤éåŒ…å«åœ¨ <code>nn.Parameter</code> ä¸­ï¼‰ï¼Œç”¨äºç»†ç²’åº¦åœ°å°†å­å›¾ä»æ¢¯åº¦è®¡ç®—ä¸­æ’é™¤ã€‚å®ƒåœ¨æ­£å‘å’Œåå‘ä¼ é€’ä¸­éƒ½ä¼šç”Ÿæ•ˆï¼š</p>
<p>åœ¨æ­£å‘ä¼ é€’ä¸­ï¼Œåªæœ‰å½“æ“ä½œçš„è‡³å°‘ä¸€ä¸ªè¾“å…¥å¼ é‡éœ€è¦æ¢¯åº¦æ—¶ï¼Œæ‰ä¼šè®°å½•è¯¥æ“ä½œã€‚åœ¨åå‘ä¼ é€’ï¼ˆ<code>.backward()</code>ï¼‰ä¸­ï¼Œåªæœ‰ <code>requires_grad=True</code> çš„å¶å¼ é‡æ‰ä¼šå°†æ¢¯åº¦ç´¯ç§¯åˆ°å®ƒä»¬çš„ <code>.grad</code> å­—æ®µã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿æ¯ä¸ªå¼ é‡éƒ½æœ‰æ­¤æ ‡å¿—ï¼Œ<strong>è®¾ç½®</strong>å®ƒä»…å¯¹å¶å¼ é‡ï¼ˆæ²¡æœ‰ <code>grad_fn</code> çš„å¼ é‡ï¼Œä¾‹å¦‚ <code>nn.Module</code> çš„å‚æ•°ï¼‰æœ‰æ•ˆã€‚éå¶å¼ é‡ï¼ˆå…·æœ‰ <code>grad_fn</code> çš„å¼ é‡ï¼‰å…³è”äº†åå‘ä¼ æ’­å›¾ï¼Œå› æ­¤å®ƒä»¬çš„æ¢¯åº¦æ˜¯è®¡ç®—éœ€è¦æ¢¯åº¦çš„å¶å¼ é‡çš„æ¢¯åº¦çš„ä¸­é—´ç»“æœã€‚ä»å®šä¹‰ä¸Šçœ‹ï¼Œæ‰€æœ‰éå¶å¼ é‡éƒ½è‡ªåŠ¨å…·æœ‰ <code>requires_grad=True</code>ã€‚</p>
<p>è®¾ç½® <code>requires_grad</code> åº”è¯¥æ˜¯æ‚¨æ§åˆ¶æ¨¡å‹çš„å“ªäº›éƒ¨åˆ†å‚ä¸æ¢¯åº¦è®¡ç®—çš„ä¸»è¦æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦åœ¨æ¨¡å‹å¾®è°ƒæœŸé—´å†»ç»“é¢„è®­ç»ƒæ¨¡å‹çš„éƒ¨åˆ†å‚æ•°ï¼Œå¯ä»¥ç›´æ¥å°†ä¸å¸Œæœ›æ›´æ–°çš„å‚æ•°è®¾ä¸º <code>.requires_grad_(False)</code>ã€‚æ­£å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œç”±äºè¿™äº›å‚æ•°ä½œä¸ºè¾“å…¥çš„è®¡ç®—ä¸ä¼šè®°å½•åœ¨æ­£å‘ä¼ é€’ä¸­ï¼Œå› æ­¤åœ¨åå‘ä¼ é€’ä¸­å®ƒä»¬çš„ <code>.grad</code> å­—æ®µä¸ä¼šæ›´æ–°ï¼Œå› ä¸ºå®ƒä»¬æœ€åˆå°±ä¸åœ¨åå‘ä¼ æ’­å›¾ä¸­ã€‚</p>
<p>ç”±äºè¿™ç§æ¨¡å¼å¾ˆå¸¸è§ï¼Œ<code>requires_grad</code> ä¹Ÿå¯ä»¥åœ¨æ¨¡å—çº§åˆ«é€šè¿‡ <code>nn.Module.requires_grad_()</code> è®¾ç½®ã€‚å¯¹æ¨¡å—åº”ç”¨ <code>.requires_grad_()</code> ä¼šå½±å“è¯¥æ¨¡å—çš„æ‰€æœ‰å‚æ•°ï¼ˆé»˜è®¤æƒ…å†µä¸‹ <code>requires_grad=True</code>ï¼‰ã€‚</p>
<h3 id="grad-modes">Grad Modes<a href="https://pytorch.org/docs/stable/notes/autograd.html#grad-modes"></a><a class="headerlink" href="#grad-modes" title="Permanent link">&para;</a></h3>
<p>Apart from setting <code>requires_grad</code> there are also three grad modes that can be selected from Python that can affect how computations in PyTorch are processed by autograd internally: default mode (grad mode), no-grad mode, and inference mode, all of which can be togglable via context managers and decorators.</p>
<table><colgroup><col> <col> <col> <col> <col> </colgroup><thead><tr><th><p>Mode</p></th><th><p>Excludes operations from being recorded in backward graph</p></th><th><p>Skips additional autograd tracking overhead</p></th><th><p>Tensors created while the mode is enabled can be used in grad-mode later</p></th><th><p>Examples</p></th></tr></thead><tbody><tr><td><p>default</p></td><td></td><td></td><td><p>âœ“</p></td><td><p>Forward pass</p></td></tr><tr><td><p>no-grad</p></td><td><p>âœ“</p></td><td></td><td><p>âœ“</p></td><td><p>Optimizer updates</p></td></tr><tr><td><p>inference</p></td><td><p>âœ“</p></td><td><p>âœ“</p></td><td></td><td><p>Data processing, model evaluation</p></td></tr></tbody></table>
<h3 id="_4">é»˜è®¤æ¨¡å¼ï¼ˆæ¢¯åº¦æ¨¡å¼ï¼‰<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>â€œé»˜è®¤æ¨¡å¼â€æ˜¯æˆ‘ä»¬åœ¨æœªå¯ç”¨æ— æ¢¯åº¦æ¨¡å¼æˆ–æ¨ç†æ¨¡å¼æ—¶æ‰€å¤„çš„æ¨¡å¼ã€‚ä¸â€œæ— æ¢¯åº¦æ¨¡å¼â€ç›¸å¯¹æ¯”ï¼Œé»˜è®¤æ¨¡å¼æœ‰æ—¶ä¹Ÿç§°ä¸ºâ€œæ¢¯åº¦æ¨¡å¼â€ã€‚</p>
<p>é»˜è®¤æ¨¡å¼æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™æ˜¯å”¯ä¸€ä¸€ä¸ª <code>requires_grad</code> å±æ€§ç”Ÿæ•ˆçš„æ¨¡å¼ã€‚åœ¨æ— æ¢¯åº¦æ¨¡å¼å’Œæ¨ç†æ¨¡å¼ä¸­ï¼Œ<code>requires_grad</code> éƒ½ä¼šè¢«å¼ºåˆ¶è®¾ç½®ä¸º <code>False</code>ã€‚</p>
<h3 id="_5">æ— æ¢¯åº¦æ¨¡å¼<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>åœ¨æ— æ¢¯åº¦æ¨¡å¼ä¸­ï¼Œè®¡ç®—ä¼šè¡¨ç°å¾—å¥½åƒæ²¡æœ‰è¾“å…¥éœ€è¦æ¢¯åº¦ä¸€æ ·ã€‚æ¢å¥è¯è¯´ï¼Œå³ä½¿è¾“å…¥å¼ é‡è®¾ç½®äº† <code>requires_grad=True</code>ï¼Œåœ¨æ— æ¢¯åº¦æ¨¡å¼ä¸­çš„è®¡ç®—ä¹Ÿä¸ä¼šè®°å½•åœ¨åå‘ä¼ æ’­å›¾ä¸­ã€‚</p>
<p>å¦‚æœéœ€è¦æ‰§è¡Œä¸€äº›æ“ä½œï¼Œè¿™äº›æ“ä½œä¸åº”ç”± autograd è®°å½•ï¼Œä½†æ‚¨ä»æƒ³åœ¨ç¨åä»¥æ¢¯åº¦æ¨¡å¼ä½¿ç”¨è¿™äº›è®¡ç®—çš„è¾“å‡ºï¼Œæ­¤æ—¶å¯ä»¥å¯ç”¨æ— æ¢¯åº¦æ¨¡å¼ã€‚è¿™ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨æ–¹ä¾¿åœ°è®©æ‚¨ç¦ç”¨ä¸€æ®µä»£ç æˆ–å‡½æ•°çš„æ¢¯åº¦ï¼Œè€Œæ— éœ€ä¸´æ—¶å°†å¼ é‡çš„ <code>requires_grad</code> å±æ€§è®¾ç½®ä¸º <code>False</code> å†æ¢å¤ä¸º <code>True</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæ— æ¢¯åº¦æ¨¡å¼åœ¨ç¼–å†™ä¼˜åŒ–å™¨æ—¶å¾ˆæœ‰ç”¨ï¼šæ‰§è¡Œè®­ç»ƒæ›´æ–°æ—¶ï¼Œæ‚¨å¸Œæœ›å¯¹å‚æ•°è¿›è¡Œå°±åœ°æ›´æ–°ï¼Œè€Œæ— éœ€è®© autograd è®°å½•è¯¥æ›´æ–°ã€‚æ‚¨è¿˜æ‰“ç®—åœ¨ä¸‹ä¸€æ¬¡å‰å‘ä¼ é€’ä¸­ä»¥æ¢¯åº¦æ¨¡å¼ä½¿ç”¨æ›´æ–°åçš„å‚æ•°ã€‚</p>
<p>åœ¨ <a href="https://pytorch.org/docs/stable/nn.init.html#nn-init-doc">torch.nn.init</a> ä¸­çš„å®ç°ä¹Ÿä¾èµ–äºæ— æ¢¯åº¦æ¨¡å¼ï¼Œä»¥é¿å…åœ¨åˆå§‹åŒ–å‚æ•°æ—¶ï¼Œç”± autograd è·Ÿè¸ªå°±åœ°æ›´æ–°çš„å·²åˆå§‹åŒ–å‚æ•°ã€‚</p>
<h3 id="_6">æ¨ç†æ¨¡å¼<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>æ¨ç†æ¨¡å¼æ˜¯æ— æ¢¯åº¦æ¨¡å¼çš„å¢å¼ºç‰ˆæœ¬ã€‚ä¸æ— æ¢¯åº¦æ¨¡å¼ä¸€æ ·ï¼Œæ¨ç†æ¨¡å¼ä¸­çš„è®¡ç®—ä¸ä¼šè®°å½•åœ¨åå‘ä¼ æ’­å›¾ä¸­ï¼Œä½†å¯ç”¨æ¨ç†æ¨¡å¼å¯ä»¥è¿›ä¸€æ­¥åŠ å¿«æ¨¡å‹çš„è¿è¡Œé€Ÿåº¦ã€‚è¿™ä¸ªæ€§èƒ½æå‡å¸¦æ¥äº†ä¸€ä¸ªç¼ºç‚¹ï¼šåœ¨æ¨ç†æ¨¡å¼ä¸­åˆ›å»ºçš„å¼ é‡åœ¨é€€å‡ºæ¨ç†æ¨¡å¼åæ— æ³•ç”¨äºç”± autograd è®°å½•çš„è®¡ç®—ä¸­ã€‚</p>
<p>å¦‚æœæ‚¨åœ¨æ‰§è¡Œçš„è®¡ç®—ä¸éœ€è¦è®°å½•åœ¨åå‘ä¼ æ’­å›¾ä¸­ï¼Œä¸”æ‚¨ä¸æ‰“ç®—åœ¨åç»­çš„ä»»ä½•ç”± autograd è®°å½•çš„è®¡ç®—ä¸­ä½¿ç”¨æ¨ç†æ¨¡å¼åˆ›å»ºçš„å¼ é‡ï¼Œé‚£ä¹ˆå¯ä»¥å¯ç”¨æ¨ç†æ¨¡å¼ã€‚</p>
<p>å»ºè®®æ‚¨åœ¨ä»£ç ä¸­ä¸éœ€è¦ autograd è·Ÿè¸ªçš„éƒ¨åˆ†ï¼ˆä¾‹å¦‚æ•°æ®å¤„ç†å’Œæ¨¡å‹è¯„ä¼°ï¼‰å°è¯•ä½¿ç”¨æ¨ç†æ¨¡å¼ã€‚å¦‚æœæ‚¨çš„ç”¨ä¾‹ç›´æ¥å¥æ•ˆï¼Œé‚£å°±æ˜¯å…è´¹çš„æ€§èƒ½æå‡ã€‚å¦‚æœå¯ç”¨æ¨ç†æ¨¡å¼åå‡ºç°é”™è¯¯ï¼Œè¯·æ£€æŸ¥æ‚¨æ˜¯å¦åœ¨é€€å‡ºæ¨ç†æ¨¡å¼åï¼Œå°†æ¨ç†æ¨¡å¼åˆ›å»ºçš„å¼ é‡ç”¨äºç”± autograd è®°å½•çš„è®¡ç®—ä¸­ã€‚å¦‚æœæ— æ³•é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥éšæ—¶åˆ‡æ¢å›æ— æ¢¯åº¦æ¨¡å¼ã€‚</p>
<p>æœ‰å…³æ¨ç†æ¨¡å¼çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://pytorch.org/cppdocs/notes/inference_mode.html">æ¨ç†æ¨¡å¼</a>ã€‚</p>
<p>æœ‰å…³æ¨ç†æ¨¡å¼çš„å®ç°ç»†èŠ‚ï¼Œè¯·å‚é˜… <a href="https://github.com/pytorch/rfcs/pull/17">RFC-0011-InferenceMode</a>ã€‚</p>
<h3 id="nnmoduleeval">è¯„ä¼°æ¨¡å¼ (<code>nn.Module.eval()</code>)<a class="headerlink" href="#nnmoduleeval" title="Permanent link">&para;</a></h3>
<p>è¯„ä¼°æ¨¡å¼å¹¶ä¸æ˜¯ä¸€ç§å±€éƒ¨ç¦ç”¨æ¢¯åº¦è®¡ç®—çš„æœºåˆ¶ï¼Œä½†ä»åœ¨æ­¤åˆ—å‡ºï¼Œå› ä¸ºå®ƒæœ‰æ—¶ä¼šè¢«è¯¯è®¤ä¸ºæ˜¯ç¦ç”¨æ¢¯åº¦çš„æ–¹å¼ã€‚</p>
<p>ä»åŠŸèƒ½ä¸Šè®²ï¼Œ<code>module.eval()</code>ï¼ˆæˆ–ç­‰ä»·çš„ <code>module.train(False)</code>ï¼‰ä¸æ— æ¢¯åº¦æ¨¡å¼å’Œæ¨ç†æ¨¡å¼å®Œå…¨æ— å…³ã€‚<code>model.eval()</code> å¦‚ä½•å½±å“æ‚¨çš„æ¨¡å‹ï¼Œå®Œå…¨å–å†³äºæ¨¡å‹ä¸­ä½¿ç”¨çš„ç‰¹å®šæ¨¡å—ä»¥åŠå®ƒä»¬æ˜¯å¦å®šä¹‰äº†è®­ç»ƒæ¨¡å¼ç›¸å…³çš„è¡Œä¸ºã€‚</p>
<p>å¦‚æœæ‚¨çš„æ¨¡å‹ä¾èµ–äºå¯èƒ½æ ¹æ®è®­ç»ƒæ¨¡å¼æœ‰ä¸åŒè¡Œä¸ºçš„æ¨¡å—ï¼ˆä¾‹å¦‚ <a href="https://pytorch.org/docs/stable/generated/torch.nn.Dropout.html#torch.nn.Dropout" title="torch.nn.Dropout"><code>torch.nn.Dropout</code></a> å’Œ <a href="https://pytorch.org/docs/stable/generated/torch.nn.BatchNorm2d.html#torch.nn.BatchNorm2d" title="torch.nn.BatchNorm2d"><code>torch.nn.BatchNorm2d</code></a>ï¼‰ï¼Œè¯·ç¡®ä¿è‡ªè¡Œè°ƒç”¨ <code>model.eval()</code> å’Œ <code>model.train()</code>ï¼Œä»¥é¿å…åœ¨éªŒè¯æ•°æ®ä¸Šæ›´æ–° BatchNorm çš„è¿è¡Œç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<p>å³ä½¿æ‚¨ä¸ç¡®å®šæ¨¡å‹æ˜¯å¦å…·æœ‰è®­ç»ƒæ¨¡å¼ç›¸å…³çš„è¡Œä¸ºï¼Œå»ºè®®æ‚¨åœ¨è®­ç»ƒæ—¶å§‹ç»ˆä½¿ç”¨ <code>model.train()</code>ï¼Œåœ¨è¯„ä¼°æ—¶ï¼ˆéªŒè¯/æµ‹è¯•ï¼‰ä½¿ç”¨ <code>model.eval()</code>ã€‚å› ä¸ºæ‚¨ä½¿ç”¨çš„æ¨¡å—å¯èƒ½ä¼šæ›´æ–°ï¼Œä»è€Œåœ¨è®­ç»ƒå’Œè¯„ä¼°æ¨¡å¼ä¸­è¡¨ç°ä¸åŒã€‚</p>
<h2 id="autograd_1">ä½¿ç”¨ Autograd çš„å°±åœ°æ“ä½œ<a class="headerlink" href="#autograd_1" title="Permanent link">&para;</a></h2>
<p>åœ¨ autograd ä¸­æ”¯æŒå°±åœ°æ“ä½œéå¸¸å›°éš¾ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨ã€‚autograd å…·æœ‰ç§¯æçš„ç¼“å†²åŒºé‡Šæ”¾å’Œé‡ç”¨ç­–ç•¥ï¼Œä½¿å…¶éå¸¸é«˜æ•ˆï¼Œå‡ ä¹æ²¡æœ‰æƒ…å†µèƒ½å¤Ÿé€šè¿‡å°±åœ°æ“ä½œæ˜¾è‘—é™ä½å†…å­˜ä½¿ç”¨ã€‚é™¤éåœ¨æé«˜çš„å†…å­˜å‹åŠ›ä¸‹æ“ä½œï¼Œå¦åˆ™å‡ ä¹ä¸éœ€è¦ä½¿ç”¨å®ƒä»¬ã€‚</p>
<p>å°±åœ°æ“ä½œé€‚ç”¨èŒƒå›´å—é™çš„ä¸¤ä¸ªä¸»è¦åŸå› æ˜¯ï¼š</p>
<ol>
<li>
<p>å°±åœ°æ“ä½œå¯èƒ½ä¼šè¦†ç›–è®¡ç®—æ¢¯åº¦æ‰€éœ€çš„å€¼ã€‚</p>
</li>
<li>
<p>æ¯ä¸ªå°±åœ°æ“ä½œéƒ½è¦æ±‚å®ç°é‡å†™è®¡ç®—å›¾ã€‚éå°±åœ°ç‰ˆæœ¬ä¼šåˆ†é…æ–°å¯¹è±¡å¹¶ä¿ç•™å¯¹æ—§å›¾çš„å¼•ç”¨ï¼Œè€Œå°±åœ°æ“ä½œåˆ™è¦æ±‚æ›´æ”¹ä»£è¡¨è¯¥æ“ä½œçš„ <code>Function</code> æ‰€æœ‰è¾“å…¥çš„åˆ›å»ºè€…ã€‚è¿™å¯èƒ½å¾ˆæ£˜æ‰‹ï¼Œå°¤å…¶æ˜¯å½“è®¸å¤šå¼ é‡å…±äº«ç›¸åŒçš„å­˜å‚¨ç©ºé—´æ—¶ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç´¢å¼•æˆ–è½¬ç½®åˆ›å»ºï¼‰ã€‚å¦‚æœå…¶ä»–ä»»ä½• <code>Tensor</code> å¼•ç”¨äº†å·²ä¿®æ”¹è¾“å…¥çš„å­˜å‚¨ç©ºé—´ï¼Œå°±åœ°å‡½æ•°ä¼šå¼•å‘é”™è¯¯ã€‚</p>
</li>
</ol>
<h3 id="_7">å°±åœ°æ­£ç¡®æ€§æ£€æŸ¥<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>æ¯ä¸ªå¼ é‡éƒ½æœ‰ä¸€ä¸ªç‰ˆæœ¬è®¡æ•°å™¨ï¼Œåœ¨ä»»ä½•æ“ä½œä¸­æ ‡è®°ä¸ºå·²æ›´æ”¹æ—¶ï¼Œè¯¥è®¡æ•°å™¨éƒ½ä¼šé€’å¢ã€‚å½“ <code>Function</code> ä¿å­˜ä»»ä½•å¼ é‡ç”¨äºåå‘ä¼ æ’­æ—¶ï¼Œä¼šåŒæ—¶ä¿å­˜å…¶åŒ…å«å¼ é‡çš„ç‰ˆæœ¬è®¡æ•°å™¨ã€‚ä¸€æ—¦æ‚¨è®¿é—® <code>self.saved_tensors</code>ï¼Œå®ƒå°±ä¼šè¢«æ£€æŸ¥ï¼Œå¦‚æœå…¶å€¼å¤§äºå·²ä¿å­˜çš„å€¼ï¼Œå°†å¼•å‘é”™è¯¯ã€‚è¿™ç¡®ä¿äº†å¦‚æœæ‚¨ä½¿ç”¨å°±åœ°å‡½æ•°ä¸”æœªçœ‹åˆ°ä»»ä½•é”™è¯¯ï¼Œå¯ä»¥ç¡®ä¿¡è®¡ç®—çš„æ¢¯åº¦æ˜¯æ­£ç¡®çš„ã€‚</p>
<h2 id="autograd_2">å¤šçº¿ç¨‹ Autograd<a class="headerlink" href="#autograd_2" title="Permanent link">&para;</a></h2>
<p>autograd å¼•æ“è´Ÿè´£æ‰§è¡Œæ‰€æœ‰åå‘æ“ä½œä»¥å®Œæˆåå‘ä¼ æ’­ã€‚æœ¬èŠ‚å°†æè¿°åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¦‚ä½•æœ€å¥½åœ°åˆ©ç”¨å®ƒçš„æ‰€æœ‰ç»†èŠ‚ï¼ˆè¿™ä»…é€‚ç”¨äº PyTorch 1.6 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œå› ä¸ºä¹‹å‰ç‰ˆæœ¬çš„è¡Œä¸ºä¸åŒï¼‰ã€‚</p>
<p>ç”¨æˆ·å¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹ä»£ç ï¼ˆä¾‹å¦‚ Hogwild è®­ç»ƒï¼‰è®­ç»ƒæ¨¡å‹ï¼Œå¹¶ä¸”ä¸ä¼šè¢«å¹¶å‘çš„åå‘è®¡ç®—é˜»å¡ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1"># å®šä¹‰ä¸€ä¸ªå¯åœ¨ä¸åŒçº¿ç¨‹ä¸­ä½¿ç”¨çš„è®­ç»ƒå‡½æ•°</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">def</span> <span class="nf">train_fn</span><span class="p">():</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="c1"># æ­£å‘</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="c1"># åå‘</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="c1"># å¯èƒ½çš„ä¼˜åŒ–å™¨æ›´æ–°</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="c1"># ç”¨æˆ·ç¼–å†™è‡ªå·±çš„çº¿ç¨‹ä»£ç æ¥é©±åŠ¨ train_fn</span>
<span class="linenos" data-linenos="11 "></span><span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos" data-linenos="12 "></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="linenos" data-linenos="13 "></span>    <span class="n">p</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">train_fn</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span>
<span class="linenos" data-linenos="14 "></span>    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="linenos" data-linenos="15 "></span>    <span class="n">threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
<span class="linenos" data-linenos="18 "></span>    <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div>
<p>éœ€è¦æ³¨æ„ç”¨æˆ·åº”è¯¥äº†è§£ä»¥ä¸‹è¡Œä¸ºï¼š</p>
<h3 id="cpu">CPU å¹¶å‘<a class="headerlink" href="#cpu" title="Permanent link">&para;</a></h3>
<p>åœ¨ CPU ä¸Šé€šè¿‡ Python æˆ– C++ API ä»¥å¤šçº¿ç¨‹æ–¹å¼è¿è¡Œ <code>backward()</code> æˆ– <code>grad()</code> æ—¶ï¼Œåº”çœ‹åˆ°æ›´å¤šçš„å¹¶å‘æ‰§è¡Œï¼Œè€Œä¸æ˜¯æŒ‰ç‰¹å®šé¡ºåºå°†æ‰€æœ‰åå‘è°ƒç”¨ä¸²è¡ŒåŒ–ï¼ˆè¿™æ˜¯ PyTorch 1.6 ä¹‹å‰çš„è¡Œä¸ºï¼‰ã€‚</p>
<h3 id="_8">ä¸ç¡®å®šæ€§<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>å¦‚æœæ‚¨åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¹¶å‘è°ƒç”¨ <code>backward()</code> å¹¶å…±äº«è¾“å…¥ï¼ˆå³ Hogwild CPU è®­ç»ƒï¼‰ï¼Œåˆ™åº”é¢„æœŸå‡ºç°ä¸ç¡®å®šæ€§ã€‚è¿™ç§æƒ…å†µå‘ç”Ÿçš„åŸå› åœ¨äºå‚æ•°åœ¨çº¿ç¨‹é—´è‡ªåŠ¨å…±äº«ï¼Œå› æ­¤å¤šä¸ªçº¿ç¨‹å¯èƒ½ä¼šå°è¯•è®¿é—®å¹¶ç´¯ç§¯ç›¸åŒçš„ <code>.grad</code> å±æ€§ã€‚è¿™åœ¨æŠ€æœ¯ä¸Šå¹¶ä¸å®‰å…¨ï¼Œå¯èƒ½å¯¼è‡´ç«äº‰æ¡ä»¶ï¼Œä½¿ç»“æœæ— æ•ˆã€‚</p>
<p>å¼€å‘å¤šçº¿ç¨‹æ¨¡å‹å¹¶å…±äº«å‚æ•°çš„ç”¨æˆ·ï¼Œåº”ç‰¢è®°å¤šçº¿ç¨‹æ¨¡å‹å¹¶äº†è§£ä¸Šè¿°é—®é¢˜ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨åŠŸèƒ½æ€§ API <a href="https://pytorch.org/docs/stable/generated/torch.autograd.grad.html"><code>torch.autograd.grad()</code></a> æ¥è®¡ç®—æ¢¯åº¦ï¼Œä»¥é¿å…ä¸ç¡®å®šæ€§ï¼Œè€Œéä½¿ç”¨ <code>backward()</code>ã€‚</p>
<h3 id="_9">ä¿ç•™è®¡ç®—å›¾<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>å¦‚æœ autograd å›¾çš„ä¸€éƒ¨åˆ†åœ¨çº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œä¾‹å¦‚ï¼Œå…ˆåœ¨å•çº¿ç¨‹ä¸­è¿è¡Œæ­£å‘ä¼ æ’­çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œç„¶ååœ¨å¤šçº¿ç¨‹ä¸­è¿è¡Œåç»­éƒ¨åˆ†ï¼Œåˆ™ç¬¬ä¸€éƒ¨åˆ†å›¾ä¼šè¢«å…±äº«ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨åŒä¸€ä¸ªå›¾ä¸Šæ‰§è¡Œ <code>grad()</code> æˆ– <code>backward()</code> å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œæ—¶é”€æ¯å›¾çš„é—®é¢˜ï¼Œå¯¼è‡´å…¶ä»–çº¿ç¨‹å´©æºƒã€‚autograd ä¼šå‘ç”¨æˆ·æŠ¥å‘Šé”™è¯¯ï¼Œç±»ä¼¼äºæœªè®¾ç½® <code>retain_graph=True</code> è€Œå¤šæ¬¡è°ƒç”¨ <code>backward()</code>ï¼Œå¹¶æé†’ç”¨æˆ·åº”ä½¿ç”¨ <code>retain_graph=True</code>ã€‚</p>
<h3 id="autograd_3">Autograd èŠ‚ç‚¹ä¸Šçš„çº¿ç¨‹å®‰å…¨<a class="headerlink" href="#autograd_3" title="Permanent link">&para;</a></h3>
<p>ç”±äº Autograd å…è®¸è°ƒç”¨çº¿ç¨‹é©±åŠ¨å…¶åå‘æ‰§è¡Œä»¥å®ç°æ½œåœ¨çš„å¹¶è¡Œæ€§ï¼Œå› æ­¤ç¡®ä¿åœ¨ CPU ä¸Šä»¥å¹¶è¡Œæ–¹å¼è°ƒç”¨ <code>backward()</code> æ—¶çº¿ç¨‹å®‰å…¨æ€§å¾ˆé‡è¦ï¼Œç‰¹åˆ«æ˜¯å…±äº«éƒ¨åˆ†æˆ–æ•´ä¸ª GraphTask æ—¶ã€‚</p>
<p>è‡ªå®šä¹‰ Python <code>autograd.Function</code> è‡ªåŠ¨å›  GIL è€Œçº¿ç¨‹å®‰å…¨ã€‚å¯¹äºå†…ç½®çš„ C++ Autograd èŠ‚ç‚¹ï¼ˆå¦‚ AccumulateGradã€CopySlicesï¼‰å’Œè‡ªå®šä¹‰ <code>autograd::Function</code>ï¼ŒAutograd å¼•æ“ä½¿ç”¨çº¿ç¨‹äº’æ–¥é”æ¥ç¡®ä¿å¯èƒ½å­˜åœ¨çŠ¶æ€è¯»/å†™çš„ autograd èŠ‚ç‚¹ä¸Šçš„çº¿ç¨‹å®‰å…¨ã€‚</p>
<h3 id="c">C++ é’©å­ä¸Šçš„çº¿ç¨‹ä¸å®‰å…¨<a class="headerlink" href="#c" title="Permanent link">&para;</a></h3>
<p>Autograd ä¾èµ–ç”¨æˆ·ç¼–å†™çº¿ç¨‹å®‰å…¨çš„ C++ é’©å­ã€‚å¦‚æœå¸Œæœ›é’©å­åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­æ­£ç¡®åº”ç”¨ï¼Œéœ€è¦ç¼–å†™é€‚å½“çš„çº¿ç¨‹é”å®šä»£ç ï¼Œç¡®ä¿é’©å­çº¿ç¨‹å®‰å…¨ã€‚</p>
<h2 id="autograd_4">å¤æ•°çš„ Autograd<a class="headerlink" href="#autograd_4" title="Permanent link">&para;</a></h2>
<p>ç®€è¦è¯´æ˜ï¼š</p>
<ul>
<li>
<p>å½“æ‚¨ä½¿ç”¨ PyTorch å¯¹ä»»æ„å¤æ•°åŸŸå’Œ/æˆ–å¤æ•°å€¼åŸŸçš„å‡½æ•° <span class="arithmatex">\(f(z)\)</span> æ±‚å¯¼æ—¶ï¼Œæ¢¯åº¦æ˜¯åŸºäºè¯¥å‡½æ•°ä½œä¸ºæ›´å¤§å®å€¼æŸå¤±å‡½æ•° <span class="arithmatex">\(g(\)</span> input <span class="arithmatex">\()=L\)</span> çš„ä¸€éƒ¨åˆ†æ¥è®¡ç®—çš„ã€‚è®¡ç®—çš„æ¢¯åº¦æ˜¯ <span class="arithmatex">\(\frac{\partial L}{\partial z^*}\)</span>ï¼ˆæ³¨æ„ <span class="arithmatex">\(z\)</span> çš„å…±è½­ï¼‰ï¼Œå…¶è´Ÿå€¼æ­£æ˜¯æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸­æœ€é™¡ä¸‹é™çš„æ–¹å‘ã€‚å› æ­¤ï¼Œæ‰€æœ‰ç°æœ‰çš„ä¼˜åŒ–å™¨éƒ½å¯ä»¥ç›´æ¥å¤„ç†å¤æ•°å‚æ•°ã€‚</p>
</li>
<li>
<p>è¿™ç§æ–¹å¼ä¸ TensorFlow çš„å¤æ•°å¾®åˆ†æƒ¯ä¾‹ç›¸ç¬¦ï¼Œä½†ä¸ JAX ä¸åŒï¼ˆJAX è®¡ç®—çš„æ˜¯ <span class="arithmatex">\(\frac{\partial L}{\partial z}\)</span>ï¼‰ã€‚</p>
</li>
<li>
<p>å¦‚æœæœ‰ä¸€ä¸ªå®åˆ°å®çš„å‡½æ•°ï¼Œå†…éƒ¨ä½¿ç”¨å¤æ•°è¿ç®—ï¼Œæ­¤å¤„çš„æƒ¯ä¾‹æ— å…³ç´§è¦ï¼šç»“æœå°†å§‹ç»ˆä¸ä»…ä½¿ç”¨å®æ•°è¿ç®—çš„å®ç°ç›¸åŒã€‚</p>
</li>
</ul>
<p>å¦‚æœæ‚¨å¯¹æ•°å­¦ç»†èŠ‚æ„Ÿå…´è¶£ï¼Œæˆ–è€…æƒ³çŸ¥é“å¦‚ä½•åœ¨ PyTorch ä¸­å®šä¹‰å¤æ•°å¯¼æ•°ï¼Œè¯·ç»§ç»­é˜…è¯»ã€‚</p>
<h3 id="_10">ä»€ä¹ˆæ˜¯å¤æ•°å¯¼æ•°ï¼Ÿ<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>å¤æ•°å¯å¾®åˆ†çš„æ•°å­¦å®šä¹‰å–å¯¼æ•°çš„æé™å®šä¹‰ï¼Œå¹¶å°†å…¶æ¨å¹¿åˆ°å¤æ•°ã€‚è€ƒè™‘å‡½æ•° <span class="arithmatex">\(f:\mathbb{C} \rightarrow \mathbb{C}\)</span>ï¼Œ</p>
<div class="arithmatex">\[
f(z = x + yj) = u(x, y) + v(x, y)j
\]</div>
<p>å…¶ä¸­ <span class="arithmatex">\(u\)</span> å’Œ <span class="arithmatex">\(v\)</span> æ˜¯ä¸¤ä¸ªå˜é‡çš„å®å€¼å‡½æ•°ï¼Œ<span class="arithmatex">\(j\)</span> æ˜¯è™šæ•°å•ä½ã€‚</p>
<p>ä½¿ç”¨å¯¼æ•°å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºï¼š</p>
<div class="arithmatex">\[
f^{\prime}(z) = \lim_{h \rightarrow 0, h \in C}\frac{f(z+h) - f(z)}{h}
\]</div>
<p>ä¸ºäº†ä½¿æ­¤æé™å­˜åœ¨ï¼Œ<span class="arithmatex">\(u\)</span> å’Œ <span class="arithmatex">\(v\)</span> ä¸ä»…å¿…é¡»æ˜¯å®å¯å¾®çš„ï¼Œ<span class="arithmatex">\(f\)</span> è¿˜å¿…é¡»æ»¡è¶³æŸ¯è¥¿-é»æ›¼æ–¹ç¨‹ã€‚æ¢å¥è¯è¯´ï¼ŒæŒ‰å®æ•°å’Œè™šæ•°æ­¥é•¿ <span class="arithmatex">\((h)\)</span> è®¡ç®—çš„æé™å¿…é¡»ç›¸ç­‰ã€‚è¿™æ˜¯ä¸€ä¸ªæ›´ä¸ºä¸¥æ ¼çš„æ¡ä»¶ã€‚</p>
<p>å¤æ•°å¯å¾®çš„å‡½æ•°é€šå¸¸è¢«ç§°ä¸ºå…¨çº¯å‡½æ•°ã€‚å®ƒä»¬æ€§è´¨è‰¯å¥½ï¼Œå…·æœ‰å®æ•°å¯å¾®å‡½æ•°çš„æ‰€æœ‰ä¼˜è‰¯å±æ€§ï¼Œä½†åœ¨ä¼˜åŒ–é¢†åŸŸå‡ ä¹æ— ç”¨ã€‚å¯¹äºä¼˜åŒ–é—®é¢˜ï¼Œç ”ç©¶ç•Œé€šå¸¸åªä½¿ç”¨å®å€¼ç›®æ ‡å‡½æ•°ï¼Œå› ä¸ºå¤æ•°ä¸æ˜¯æœ‰åºåŸŸçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ä½¿ç”¨å¤æ•°å€¼æŸå¤±æ²¡æœ‰å¤šå¤§æ„ä¹‰ã€‚</p>
<p>æ­¤å¤–ï¼Œæ²¡æœ‰æœ‰è¶£çš„å®å€¼ç›®æ ‡å‡½æ•°ç¬¦åˆæŸ¯è¥¿-é»æ›¼æ–¹ç¨‹ã€‚å› æ­¤ï¼Œå…¨çº¯å‡½æ•°çš„ç†è®ºä¸èƒ½ç”¨äºä¼˜åŒ–ï¼Œå¤§å¤šæ•°äººè½¬è€Œä½¿ç”¨ç»´å°”å»·æ ¼å¾®ç§¯åˆ†ã€‚</p>
<h3 id="_11">ç»´å°”å»·æ ¼å¾®ç§¯åˆ†ç™»åœº<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>æˆ‘ä»¬æ‹¥æœ‰å¤æ•°å¯å¾®æ€§å’Œå…¨çº¯å‡½æ•°çš„ç†è®ºï¼Œä½†ç”±äºè®¸å¤šå¸¸ç”¨å‡½æ•°å¹¶éå…¨çº¯ï¼Œæ— æ³•å……åˆ†åˆ©ç”¨è¿™ä¸€ç†è®ºã€‚é‚£ä¹ˆæ•°å­¦å®¶ Wirtinger æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿä»–å‘ç°ï¼Œå³ä½¿ <span class="arithmatex">\(f(z)\)</span> ä¸æ˜¯å…¨çº¯çš„ï¼Œä¹Ÿå¯ä»¥å°†å…¶é‡å†™ä¸ºåŒå˜é‡å‡½æ•° <span class="arithmatex">\(f(z, z^*)\)</span>ï¼Œè¯¥å‡½æ•°æ€»æ˜¯å…¨çº¯çš„ã€‚è¿™æ˜¯å› ä¸º <span class="arithmatex">\(z\)</span> çš„å®éƒ¨å’Œè™šéƒ¨å¯ä»¥é€šè¿‡ <span class="arithmatex">\(z\)</span> å’Œ <span class="arithmatex">\(z^*\)</span> è¡¨ç¤ºä¸ºï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\operatorname{Re}(z) = \frac{z + z^*}{2} \\
\operatorname{Im}(z) = \frac{z - z^*}{2j}
\end{aligned}
\]</div>
<p>ç»´å°”å»·æ ¼å¾®ç§¯åˆ†å»ºè®®ç ”ç©¶ <span class="arithmatex">\(f(z, z^*)\)</span>ï¼Œå¦‚æœ <span class="arithmatex">\(f\)</span> å®å¯å¾®ï¼Œåˆ™è¯¥å‡½æ•°å¯ä¿è¯å…¨çº¯ï¼ˆå¦ä¸€ç§çœ‹æ³•æ˜¯è¿™æ˜¯åæ ‡ç³»çš„æ”¹å˜ï¼Œä» <span class="arithmatex">\(f(x, y)\)</span> å˜ä¸º <span class="arithmatex">\(f(z, z^*)\)</span>ï¼‰ã€‚è¯¥å‡½æ•°å…·æœ‰åå¯¼æ•° <span class="arithmatex">\(\frac{\partial}{\partial z}\)</span> å’Œ <span class="arithmatex">\(\frac{\partial}{\partial z^*}\)</span>ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é“¾å¼æ³•åˆ™å»ºç«‹è¿™äº›åå¯¼æ•°ä¸ <span class="arithmatex">\(z\)</span> çš„å®éƒ¨å’Œè™šéƒ¨çš„åå¯¼æ•°ä¹‹é—´çš„å…³ç³»ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial x} = \frac{\partial z}{\partial x} \cdot \frac{\partial}{\partial z} + \frac{\partial z^*}{\partial x} \cdot \frac{\partial}{\partial z^*} \\
\frac{\partial}{\partial y} = \frac{\partial z}{\partial y} \cdot \frac{\partial}{\partial z} + \frac{\partial z^*}{\partial y} \cdot \frac{\partial}{\partial z^*}
\end{aligned}
\]</div>
<p>ä»ä¸Šè¿°æ–¹ç¨‹å¯å¾—ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial}{\partial z} = \frac{1}{2}\left(\frac{\partial}{\partial x} - 1j \cdot \frac{\partial}{\partial y}\right) \\
\frac{\partial}{\partial z^*} = \frac{1}{2}\left(\frac{\partial}{\partial x} + 1j \cdot \frac{\partial}{\partial y}\right)
\end{aligned}
\]</div>
<p>è¿™å°±æ˜¯æ‚¨åœ¨ç»´åŸºç™¾ç§‘ä¸Šæ‰¾åˆ°çš„ç»´å°”å»·æ ¼å¾®ç§¯åˆ†çš„ç»å…¸å®šä¹‰ã€‚</p>
<p>è¿™ä¸ªæ”¹å˜å¸¦æ¥äº†è®¸å¤šæœ‰è¶£çš„ç»“æœï¼š</p>
<ul>
<li>
<p>é¦–å…ˆï¼ŒæŸ¯è¥¿-é»æ›¼æ–¹ç¨‹ç®€å•åœ°ç¿»è¯‘æˆ <span class="arithmatex">\(\frac{\partial f}{\partial z^*} = 0\)</span>ï¼ˆå³å‡½æ•° <span class="arithmatex">\(f\)</span> å¯ä»¥å®Œå…¨ç”¨ <span class="arithmatex">\(z\)</span> è¡¨ç¤ºï¼Œä¸å¿…æ¶‰åŠ <span class="arithmatex">\(z^*\)</span>ï¼‰ã€‚</p>
</li>
<li>
<p>å¦ä¸€ä¸ªé‡è¦ï¼ˆä¸”çœ‹ä¼¼åç›´è§‰ï¼‰çš„ç»“æœæ˜¯ï¼Œå½“æˆ‘ä»¬å¯¹å®å€¼æŸå¤±è¿›è¡Œä¼˜åŒ–æ—¶ï¼Œæ›´æ–°å˜é‡çš„æ­¥éª¤ç”± <span class="arithmatex">\(\frac{\partial \text{Loss}}{\partial z^*}\)</span> å†³å®šï¼ˆè€Œä¸æ˜¯ <span class="arithmatex">\(\frac{\partial \text{Loss}}{\partial z}\)</span>ï¼‰ã€‚</p>
</li>
</ul>
<p>å¦‚éœ€äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥é˜…ï¼š<a href="https://arxiv.org/pdf/0906.4835.pdf">https://arxiv.org/pdf/0906.4835.pdf</a></p>
<h3 id="_12">ç»´å°”å»·æ ¼å¾®ç§¯åˆ†åœ¨ä¼˜åŒ–ä¸­çš„ä½œç”¨<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>éŸ³é¢‘ç­‰é¢†åŸŸçš„ç ”ç©¶è€…é€šå¸¸ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼Œé€šè¿‡å¤å˜é‡æ¥ä¼˜åŒ–å®å€¼æŸå¤±å‡½æ•°ã€‚è¿™äº›ç ”ç©¶è€…é€šå¸¸å°†å®éƒ¨å’Œè™šéƒ¨åˆ†å¼€å¤„ç†ï¼Œè§†ä¸ºå¯ç‹¬ç«‹æ›´æ–°çš„ä¸¤ä¸ªé€šé“ã€‚å¯¹äºæ­¥é•¿ <span class="arithmatex">\(\alpha / 2\)</span> å’ŒæŸå¤± <span class="arithmatex">\(L\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <span class="arithmatex">\(\mathbb{R}^2\)</span> ä¸­å†™å‡ºä»¥ä¸‹å…¬å¼ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
x_{n+1} &amp; = x_n - (\alpha / 2) \cdot \frac{\partial L}{\partial x} \\
y_{n+1} &amp; = y_n - (\alpha / 2) \cdot \frac{\partial L}{\partial y}
\end{aligned}
\]</div>
<p>è¿™äº›å…¬å¼åœ¨å¤æ•°ç©ºé—´ <span class="arithmatex">\(\mathbb{C}\)</span> ä¸­å¦‚ä½•è½¬æ¢å‘¢ï¼Ÿ</p>
<div class="arithmatex">\[
\begin{aligned}
z_{n+1} &amp; = x_n - (\alpha / 2) \cdot \frac{\partial L}{\partial x} + 1j \cdot \left(y_n - (\alpha / 2) \cdot \frac{\partial L}{\partial y}\right) \\
&amp; = z_n - \alpha \cdot (1 / 2) \cdot \left(\frac{\partial L}{\partial x} + j \frac{\partial L}{\partial y}\right) \\
&amp; = z_n - \alpha \cdot \frac{\partial L}{\partial z^*}
\end{aligned}
\]</div>
<p>è¿™é‡Œå‘ç”Ÿäº†ä¸€ä»¶éå¸¸æœ‰è¶£çš„äº‹æƒ…ï¼šç»´å°”å»·æ ¼å¾®ç§¯åˆ†å‘Šè¯‰æˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°å¤å˜é‡æ›´æ–°å…¬å¼ç®€åŒ–ï¼Œåªå¼•ç”¨å…±è½­çš„ç»´å°”å»·æ ¼å¯¼æ•° <span class="arithmatex">\(\frac{\partial L}{\partial z^*}\)</span>ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨ä¼˜åŒ–ä¸­å°±å¯ä»¥å¾—åˆ°æ­£ç¡®çš„æ›´æ–°æ­¥éª¤ã€‚</p>
<p>ç”±äºå…±è½­ç»´å°”å»·æ ¼å¯¼æ•°èƒ½å¤Ÿç»™å‡ºå®å€¼æŸå¤±å‡½æ•°çš„ç²¾ç¡®æ›´æ–°æ­¥éª¤ï¼Œå½“ä½¿ç”¨ PyTorch å¯¹å…·æœ‰å®å€¼æŸå¤±çš„å‡½æ•°æ±‚å¯¼æ—¶ï¼Œæ‚¨å°†è·å¾—æ­¤å¯¼æ•°ã€‚</p>
<h3 id="pytorch">PyTorch å¦‚ä½•è®¡ç®—å…±è½­ç»´å°”å»·æ ¼å¯¼æ•°ï¼Ÿ<a class="headerlink" href="#pytorch" title="Permanent link">&para;</a></h3>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å¯¼æ•°å…¬å¼å°† <code>grad_output</code> ä½œä¸ºè¾“å…¥ï¼Œå®ƒä»£è¡¨å·²è®¡ç®—çš„å‘é‡-é›…å¯æ¯”ç§¯ï¼Œä¹Ÿå³ <span class="arithmatex">\(\frac{\partial L}{\partial s^*}\)</span>ï¼Œå…¶ä¸­ <span class="arithmatex">\(L\)</span> æ˜¯æ•´ä¸ªè®¡ç®—çš„æŸå¤±ï¼ˆäº§ç”Ÿå®å€¼æŸå¤±ï¼‰ï¼Œ<span class="arithmatex">\(s\)</span> æ˜¯å‡½æ•°çš„è¾“å‡ºã€‚æ­¤å¤„çš„ç›®æ ‡æ˜¯è®¡ç®— <span class="arithmatex">\(\frac{\partial L}{\partial z^*}\)</span>ï¼Œå…¶ä¸­ <span class="arithmatex">\(z\)</span> æ˜¯å‡½æ•°çš„è¾“å…¥ã€‚å®é™…ä¸Šï¼Œå¯¹äºå®å€¼æŸå¤±æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è®¡ç®— <span class="arithmatex">\(\frac{\partial L}{\partial s^*}\)</span>ï¼Œå°½ç®¡é“¾å¼æ³•åˆ™è¡¨æ˜æˆ‘ä»¬è¿˜éœ€è¦è·å– <span class="arithmatex">\(\frac{\partial L}{\partial s}\)</span>ã€‚å¦‚æœæ‚¨æƒ³è·³è¿‡æ­¤æ¨å¯¼ï¼Œå¯ä»¥ç›´æ¥æŸ¥çœ‹æœ¬èŠ‚çš„æœ€åä¸€ä¸ªå…¬å¼ï¼Œç„¶åè·³åˆ°ä¸‹ä¸€èŠ‚ã€‚</p>
<p>ç»§ç»­ç ”ç©¶ <span class="arithmatex">\(f: \mathbb{C} \to \mathbb{C}\)</span>ï¼Œå®šä¹‰ä¸º <span class="arithmatex">\(f(z) = f(x + yj) = u(x, y) + v(x, y)j\)</span>ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œautograd çš„æ¢¯åº¦è§„èŒƒå›´ç»•å®å€¼æŸå¤±å‡½æ•°çš„ä¼˜åŒ–ï¼Œå› æ­¤å‡è®¾ <span class="arithmatex">\(f\)</span> æ˜¯æ›´å¤§å®å€¼æŸå¤±å‡½æ•° <span class="arithmatex">\(g\)</span> çš„ä¸€éƒ¨åˆ†ã€‚ä½¿ç”¨é“¾å¼æ³•åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºï¼š</p>
<div class="arithmatex">\[
\frac{\partial L}{\partial z^*} = \frac{\partial L}{\partial u} \cdot \frac{\partial u}{\partial z^*} + \frac{\partial L}{\partial v} \cdot \frac{\partial v}{\partial z^*}
\]</div>
<p>ç°åœ¨ä½¿ç”¨ç»´å°”å»·æ ¼å¯¼æ•°çš„å®šä¹‰ï¼Œå¯ä»¥å†™å‡ºï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
&amp; \frac{\partial L}{\partial s} = \frac{1}{2}\left(\frac{\partial L}{\partial u} - \frac{\partial L}{\partial v}j\right) \\
&amp; \frac{\partial L}{\partial s^*} = \frac{1}{2}\left(\frac{\partial L}{\partial u} + \frac{\partial L}{\partial v}j\right)
\end{aligned}
\]</div>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº <span class="arithmatex">\(u\)</span> å’Œ <span class="arithmatex">\(v\)</span> æ˜¯å®å‡½æ•°ï¼Œè€Œå‡è®¾ <span class="arithmatex">\(f\)</span> æ˜¯å®å€¼å‡½æ•°çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ <span class="arithmatex">\(L\)</span> ä¹Ÿæ˜¯å®æ•°ã€‚æˆ‘ä»¬æœ‰ï¼š</p>
<div class="arithmatex">\[
\left(\frac{\partial L}{\partial s}\right)^* = \frac{\partial L}{\partial s^*}
\]</div>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class="arithmatex">\(\frac{\partial L}{\partial s}\)</span> ç­‰äº <code>grad_output</code> çš„å…±è½­ã€‚</p>
<p>è§£å‡ºä¸Šè¿°å…³äº <span class="arithmatex">\(\frac{\partial L}{\partial u}\)</span> å’Œ <span class="arithmatex">\(\frac{\partial L}{\partial v}\)</span> çš„æ–¹ç¨‹ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial L}{\partial u} = \frac{\partial L}{\partial s} + \frac{\partial L}{\partial s^*} \\
\frac{\partial L}{\partial v} = -1j \cdot \left(\frac{\partial L}{\partial s} - \frac{\partial L}{\partial s^*}\right)
\end{aligned}
\]</div>
<p>å°†å…¬å¼ (3) ä»£å…¥ (1)ï¼Œå¾—åˆ°ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial L}{\partial z^*} &amp; = \left(\frac{\partial L}{\partial s} + \frac{\partial L}{\partial s^*}\right) \cdot \frac{\partial u}{\partial z^*} - 1j \cdot \left(\frac{\partial L}{\partial s} - \frac{\partial L}{\partial s^*}\right) \cdot \frac{\partial v}{\partial z^*} \\
&amp; = \frac{\partial L}{\partial s} \cdot \left(\frac{\partial u}{\partial z^*} + \frac{\partial v}{\partial z^*}j\right) + \frac{\partial L}{\partial s^*} \cdot \left(\frac{\partial u}{\partial z^*} - \frac{\partial v}{\partial z^*}j\right) \\
&amp; = \frac{\partial L}{\partial s^*} \cdot \frac{\partial (u + vj)}{\partial z^*} + \frac{\partial L}{\partial s} \cdot \frac{\partial (u + vj)^*}{\partial z^*} \\
&amp; = \frac{\partial L}{\partial s} \cdot \frac{\partial s}{\partial z^*} + \frac{\partial L}{\partial s^*} \cdot \frac{\partial s^*}{\partial z^*}
\end{aligned}
\]</div>
<p>æ ¹æ®å…¬å¼ (2)ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<p><img alt="image.png" src="https://raw.githubusercontent.com/aletolia/Pictures/main/202405051505485.png" /></p>
<p>æœ€åä¸€ä¸ªå…¬å¼éå¸¸é‡è¦ï¼Œå®ƒå°†æˆ‘ä»¬çš„å¯¼æ•°å…¬å¼åˆ†è§£ä¸ºä¸€ä¸ªæ›´ç®€å•ã€æ˜“äºæ‰‹åŠ¨è®¡ç®—çš„å½¢å¼ã€‚</p>
<h3 id="_13">å¦‚ä½•ä¸ºå¤æ•°å‡½æ•°ç¼–å†™å¯¼æ•°å…¬å¼ï¼Ÿ<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>ä¸Šé¢æ¡†ä¸­çš„æ–¹ç¨‹ä¸ºå¤æ•°å‡½æ•°çš„æ‰€æœ‰å¯¼æ•°æä¾›äº†é€šç”¨å…¬å¼ï¼Œä½†æˆ‘ä»¬ä»éœ€è®¡ç®— <span class="arithmatex">\(\frac{\partial s}{\partial z}\)</span> å’Œ <span class="arithmatex">\(\frac{\partial s}{\partial z^*}\)</span>ã€‚ä»¥ä¸‹æ˜¯ä¸¤ç§æ–¹æ³•ï¼š</p>
<ul>
<li>
<p>ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥ä½¿ç”¨ç»´å°”å»·æ ¼å¯¼æ•°çš„å®šä¹‰ï¼Œé€šè¿‡ <span class="arithmatex">\(\frac{\partial s}{\partial x}\)</span> å’Œ <span class="arithmatex">\(\frac{\partial s}{\partial y}\)</span>ï¼ˆå¯ä»¥ä»¥å¸¸è§„æ–¹å¼è®¡ç®—ï¼‰è®¡ç®— <span class="arithmatex">\(\frac{\partial s}{\partial z}\)</span> å’Œ <span class="arithmatex">\(\frac{\partial s}{\partial z^*}\)</span>ã€‚</p>
</li>
<li>
<p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨å˜é‡æ›¿æ¢ï¼Œå°† <span class="arithmatex">\(f(z)\)</span> é‡å†™ä¸ºåŒå˜é‡å‡½æ•° <span class="arithmatex">\(f(z, z^*)\)</span>ï¼Œé€šè¿‡å°† <span class="arithmatex">\(z\)</span> å’Œ <span class="arithmatex">\(z^*\)</span> è§†ä¸ºç‹¬ç«‹å˜é‡æ¥è®¡ç®—å…±è½­ç»´å°”å»·æ ¼å¯¼æ•°ã€‚è¿™é€šå¸¸æ›´å®¹æ˜“ï¼›ä¾‹å¦‚ï¼Œå¦‚æœå‡½æ•°å…¨çº¯ï¼Œåˆ™åªä½¿ç”¨ <span class="arithmatex">\(z\)</span>ï¼ˆä¸” <span class="arithmatex">\(\frac{\partial s}{\partial z^*}\)</span> ä¸ºé›¶ï¼‰ã€‚</p>
</li>
</ul>
<p>è®©æˆ‘ä»¬ä»¥å‡½æ•° <span class="arithmatex">\(f(z = x + yj) = c \cdot z = c \cdot (x + yj)\)</span> ä¸ºä¾‹ï¼Œå…¶ä¸­ <span class="arithmatex">\(c \in \mathbb{R}\)</span>ã€‚</p>
<p>ä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ³•è®¡ç®—ç»´å°”å»·æ ¼å¯¼æ•°ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial s}{\partial z} &amp; = \frac{1}{2}\left(\frac{\partial s}{\partial x} - \frac{\partial s}{\partial y}j\right) \\
&amp; = \frac{1}{2}(c - (c \cdot 1j) \cdot 1j) \\
&amp; = c
\end{aligned}
\]</div>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial s}{\partial z^*} &amp; = \frac{1}{2}\left(\frac{\partial s}{\partial x} + \frac{\partial s}{\partial y}j\right) \\
&amp; = \frac{1}{2}(c + (c \cdot 1j) \cdot 1j) \\
&amp; = 0
\end{aligned}
\]</div>
<p>æ ¹æ®å…¬å¼ (4) å¹¶è®¾ <code>grad_output = 1.0</code>ï¼ˆè¿™æ˜¯åœ¨ PyTorch ä¸­å¯¹æ ‡é‡è¾“å‡ºè°ƒç”¨ <code>backward()</code> æ—¶çš„é»˜è®¤æ¢¯åº¦è¾“å‡ºå€¼ï¼‰ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<div class="arithmatex">\[
\frac{\partial L}{\partial z^*} = 1 \cdot 0 + 1 \cdot c = c
\]</div>
<p>ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•è®¡ç®—ç»´å°”å»·æ ¼å¯¼æ•°ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial s}{\partial z} &amp; = \frac{\partial (c \cdot z)}{\partial z} \\
&amp; = c \\
\frac{\partial s}{\partial z^*} &amp; = \frac{\partial (c \cdot z)}{\partial z^*} \\
&amp; = 0
\end{aligned}
\]</div>
<p>å†æ¬¡ä½¿ç”¨å…¬å¼ (4)ï¼Œæˆ‘ä»¬å¾—åˆ° <span class="arithmatex">\(\frac{\partial L}{\partial z^*} = c\)</span>ã€‚ç”±æ­¤å¯è§ï¼Œç¬¬äºŒç§æ–¹æ³•è®¡ç®—æ›´å°‘ï¼Œæ›´æ–¹ä¾¿äºå¿«é€Ÿè®¡ç®—ã€‚</p>
<h3 id="_14">è·¨åŸŸå‡½æ•°å‘¢ï¼Ÿ<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p>æœ‰äº›å‡½æ•°ä»å¤æ•°è¾“å…¥æ˜ å°„åˆ°å®æ•°è¾“å‡ºï¼Œæˆ–åä¹‹äº¦ç„¶ã€‚è¿™äº›å‡½æ•°æ˜¯å…¬å¼ (4) çš„ç‰¹æ®Šæƒ…å†µï¼Œå¯ä»¥é€šè¿‡é“¾å¼æ³•åˆ™æ¨å¯¼ï¼š</p>
<ul>
<li>å¯¹äº <span class="arithmatex">\(f: \mathbb{C} \to \mathbb{R}\)</span>ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</li>
</ul>
<div class="arithmatex">\[
\frac{\partial L}{\partial z^*} = 2 \cdot \text{grad\_output} \cdot \frac{\partial s}{\partial z^*}
\]</div>
<ul>
<li>å¯¹äº <span class="arithmatex">\(f: \mathbb{R} \to \mathbb{C}\)</span>ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</li>
</ul>
<div class="arithmatex">\[
\frac{\partial L}{\partial z^*} = 2 \cdot \operatorname{Re}\left(\text{grad\_output}^* \cdot \frac{\partial s}{\partial z^*}\right)
\]</div>
<h2 id="_15">å·²ä¿å­˜å¼ é‡çš„é’©å­<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h2>
<p>å¯ä»¥é€šè¿‡å®šä¹‰ <code>pack_hook</code> / <code>unpack_hook</code> é’©å­å¯¹æ¥æ§åˆ¶å·²ä¿å­˜å¼ é‡çš„æ‰“åŒ…/è§£åŒ…æ–¹å¼ã€‚<code>pack_hook</code> å‡½æ•°åº”ä»¥å¼ é‡ä½œä¸ºå”¯ä¸€å‚æ•°ï¼Œä½†å¯ä»¥è¿”å›ä»»ä½• Python å¯¹è±¡ï¼ˆä¾‹å¦‚å¦ä¸€ä¸ªå¼ é‡ã€å…ƒç»„ï¼Œç”šè‡³åŒ…å«æ–‡ä»¶åçš„å­—ç¬¦ä¸²ï¼‰ã€‚<code>unpack_hook</code> å‡½æ•°çš„å”¯ä¸€å‚æ•°æ˜¯ <code>pack_hook</code> çš„è¾“å‡ºï¼Œå¹¶åº”è¿”å›ç”¨äºåå‘ä¼ æ’­çš„å¼ é‡ã€‚<code>unpack_hook</code> è¿”å›çš„å¼ é‡åªéœ€ä¸ä¼ é€’ç»™ <code>pack_hook</code> çš„å¼ é‡å†…å®¹ç›¸åŒï¼Œç‰¹åˆ«æ˜¯ä»»ä½•ä¸ autograd ç›¸å…³çš„å…ƒæ•°æ®éƒ½å¯ä»¥å¿½ç•¥ï¼Œå› ä¸ºå®ƒä»¬ä¼šåœ¨è§£åŒ…è¿‡ç¨‹ä¸­è¢«è¦†ç›–ã€‚</p>
<p>è¿™å¯¹é’©å­çš„ä¸€ä¸ªç¤ºä¾‹æ˜¯ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="n">y</span><span class="o">.</span><span class="n">grad_fn</span><span class="o">.</span><span class="n">_raw_saved_self</span><span class="o">.</span><span class="n">register_hooks</span><span class="p">(</span><span class="n">pack_hook</span><span class="p">,</span> <span class="n">unpack_hook</span><span class="p">)</span>
</code></pre></div>
<p>åœ¨æ³¨å†Œæˆå¯¹çš„é’©å­æ—¶ç«‹å³è°ƒç”¨ <code>pack_hook</code> æ–¹æ³•ï¼Œè€Œæ¯æ¬¡éœ€è¦è®¿é—®ä¿å­˜çš„å¼ é‡æ—¶ï¼ˆé€šè¿‡ <code>y.grad_fn._saved_self</code> æˆ–åœ¨åå‘ä¼ æ’­æœŸé—´ï¼‰ï¼Œéƒ½ä¼šè°ƒç”¨ <code>unpack_hook</code> æ–¹æ³•ã€‚</p>
<p><strong>è­¦å‘Š</strong></p>
<p>å¦‚æœåœ¨ä¿å­˜çš„å¼ é‡å·²è¢«é‡Šæ”¾ï¼ˆå³åå‘ä¼ æ’­è°ƒç”¨åï¼‰ä»ä¿ç•™å¯¹ <code>SavedTensor</code> çš„å¼•ç”¨ï¼Œåˆ™ç¦æ­¢è°ƒç”¨å…¶ <code>register_hooks()</code>ã€‚PyTorch é€šå¸¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¸ä¼šæŠ›é”™ï¼Œå¹¶å¯èƒ½å‡ºç°æœªå®šä¹‰è¡Œä¸ºã€‚</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1"># ä»…å°†å¤§å° &gt;= 1000 çš„å¼ é‡ä¿å­˜åœ¨ç£ç›˜ä¸Š</span>
<span class="linenos" data-linenos=" 2 "></span><span class="n">SAVE_ON_DISK_THRESHOLD</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">def</span> <span class="nf">pack_hook</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">SAVE_ON_DISK_THRESHOLD</span><span class="p">:</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">return</span> <span class="n">x</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="n">temp_file</span> <span class="o">=</span> <span class="n">SelfDeletingTempFile</span><span class="p">()</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">temp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">return</span> <span class="n">temp_file</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="k">def</span> <span class="nf">unpack_hook</span><span class="p">(</span><span class="n">tensor_or_sctf</span><span class="p">):</span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tensor_or_sctf</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="linenos" data-linenos="13 "></span>        <span class="k">return</span> <span class="n">tensor_or_sctf</span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">tensor_or_sctf</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="linenos" data-linenos="17 "></span>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="linenos" data-linenos="18 "></span>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">saved_tensors_hooks</span><span class="p">(</span><span class="n">pack_hook</span><span class="p">,</span> <span class="n">unpack_hook</span><span class="p">):</span>
<span class="linenos" data-linenos="19 "></span>            <span class="c1"># è®¡ç®—è¾“å‡º</span>
<span class="linenos" data-linenos="20 "></span>            <span class="n">output</span> <span class="o">=</span> <span class="n">x</span>
<span class="linenos" data-linenos="21 "></span>        <span class="k">return</span> <span class="n">output</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="linenos" data-linenos="24 "></span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>
<p>ä½¿ç”¨è¯¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨å®šä¹‰çš„é’©å­æ˜¯çº¿ç¨‹å±€éƒ¨çš„ã€‚å› æ­¤ï¼Œä»¥ä¸‹ä»£ç ä¸ä¼šäº§ç”Ÿé¢„æœŸçš„æ•ˆæœï¼Œå› ä¸ºé’©å­æ— æ³•é€šè¿‡ <code>DataParallel</code>ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1"># ç¤ºä¾‹ï¼šä¸è¦è¿™æ ·åš</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">saved_tensors_hooks</span><span class="p">(</span><span class="n">pack_hook</span><span class="p">,</span> <span class="n">unpack_hook</span><span class="p">):</span>
<span class="linenos" data-linenos="5 "></span>    <span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</code></pre></div>
<p>è¯·æ³¨æ„ï¼Œä½¿ç”¨è¿™äº›é’©å­ä¼šç¦ç”¨ä¸ºå‡å°‘ Tensor å¯¹è±¡åˆ›å»ºè€Œè¿›è¡Œçš„ä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">saved_tensors_hooks</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">):</span>
<span class="linenos" data-linenos="2 "></span>    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span>    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
</code></pre></div>
<p>åœ¨æ²¡æœ‰é’©å­çš„æƒ…å†µä¸‹ï¼Œ<code>x</code>ã€<code>y.grad_fn._saved_self</code> å’Œ <code>y.grad_fn._saved_other</code> éƒ½å¼•ç”¨åŒä¸€ä¸ªå¼ é‡å¯¹è±¡ã€‚ä½†æœ‰é’©å­æ—¶ï¼ŒPyTorch ä¼šå°† <code>x</code> æ‰“åŒ…å’Œè§£åŒ…æˆä¸¤ä¸ªæ–°çš„å¼ é‡å¯¹è±¡ï¼Œå®ƒä»¬ä¸åŸå§‹çš„ <code>x</code> å…±äº«ç›¸åŒçš„å­˜å‚¨ï¼ˆä¸ä¼šæ‰§è¡Œå¤åˆ¶æ“ä½œï¼‰ã€‚</p>
<h3 id="_16">åå‘ä¼ æ’­é’©å­çš„æ‰§è¡Œ<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>æœ¬èŠ‚å°†è®¨è®ºä½•æ—¶è§¦å‘ä¸åŒçš„é’©å­ï¼Œä½•æ—¶ä¸ä¼šè§¦å‘ï¼Œç„¶åè®¨è®ºè§¦å‘é¡ºåºã€‚æ¶µç›–çš„é’©å­æœ‰ï¼šé€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.Tensor.register_hook.html" title="torch.Tensor.register_hook"><code>torch.Tensor.register_hook()</code></a> æ³¨å†Œåˆ°å¼ é‡çš„åå‘é’©å­ï¼Œé€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.Tensor.register_post_accumulate_grad_hook.html" title="torch.Tensor.register_post_accumulate_grad_hook"><code>torch.Tensor.register_post_accumulate_grad_hook()</code></a> æ³¨å†Œåˆ°å¼ é‡çš„æ¢¯åº¦ç´¯ç§¯åé’©å­ï¼Œé€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.autograd.graph.Node.register_hook.html" title="torch.autograd.graph.Node.register_hook"><code>torch.autograd.graph.Node.register_hook()</code></a> æ³¨å†Œåˆ°èŠ‚ç‚¹çš„åé’©å­ï¼Œä»¥åŠé€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.autograd.graph.Node.register_prehook.html" title="torch.autograd.graph.Node.register_prehook"><code>torch.autograd.graph.Node.register_prehook()</code></a> æ³¨å†Œåˆ°èŠ‚ç‚¹çš„å‰é’©å­ã€‚</p>
<h3 id="_17">é’©å­æ˜¯å¦ä¼šè§¦å‘<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>é€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.Tensor.register_hook.html" title="torch.Tensor.register_hook"><code>torch.Tensor.register_hook()</code></a> æ³¨å†Œåˆ°å¼ é‡çš„é’©å­ï¼Œä¼šåœ¨ä¸ºè¯¥å¼ é‡è®¡ç®—æ¢¯åº¦æ—¶æ‰§è¡Œï¼ˆæ³¨æ„ï¼Œè¿™ä¸è¦æ±‚æ‰§è¡Œè¯¥å¼ é‡çš„ <code>grad_fn</code>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¯¥å¼ é‡ä½œä¸º <a href="https://pytorch.org/docs/stable/generated/torch.autograd.grad.html" title="torch.autograd.grad"><code>torch.autograd.grad()</code></a> çš„ <code>inputs</code> å‚æ•°çš„ä¸€éƒ¨åˆ†ä¼ é€’ï¼Œå¯èƒ½ä¸ä¼šæ‰§è¡Œå¼ é‡çš„ <code>grad_fn</code>ï¼Œä½†è¯¥å¼ é‡çš„é’©å­å§‹ç»ˆä¼šè¢«æ‰§è¡Œï¼‰ã€‚</p>
<p>é€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.Tensor.register_post_accumulate_grad_hook.html" title="torch.Tensor.register_post_accumulate_grad_hook"><code>torch.Tensor.register_post_accumulate_grad_hook()</code></a> æ³¨å†Œåˆ°å¼ é‡çš„é’©å­ï¼Œåœ¨è¯¥å¼ é‡çš„æ¢¯åº¦ç´¯ç§¯ä¹‹åæ‰§è¡Œï¼Œè¿™æ„å‘³ç€è¯¥å¼ é‡çš„ <code>grad</code> å­—æ®µå·²ç»è®¾ç½®ã€‚é€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.Tensor.register_hook.html" title="torch.Tensor.register_hook"><code>torch.Tensor.register_hook()</code></a> æ³¨å†Œçš„é’©å­åœ¨è®¡ç®—æ¢¯åº¦æ—¶æ‰§è¡Œï¼Œè€Œé€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.Tensor.register_post_accumulate_grad_hook.html" title="torch.Tensor.register_post_accumulate_grad_hook"><code>torch.Tensor.register_post_accumulate_grad_hook()</code></a> æ³¨å†Œçš„é’©å­åªä¼šåœ¨åå‘ä¼ æ’­ç»“æŸæ—¶ï¼Œautograd æ›´æ–°å¼ é‡çš„ <code>grad</code> å­—æ®µåè§¦å‘ã€‚å› æ­¤ï¼Œæ¢¯åº¦ç´¯ç§¯åé’©å­åªèƒ½ä¸ºå¶å¼ é‡æ³¨å†Œã€‚å¦‚æœå°è¯•åœ¨éå¶å¼ é‡ä¸Šæ³¨å†Œï¼Œä¼šæŠ›å‡ºé”™è¯¯ï¼Œå³ä½¿ <code>backward(retain_graph=True)</code> è¢«è°ƒç”¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p>é€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.autograd.graph.Node.register_hook.html" title="torch.autograd.graph.Node.register_hook"><code>torch.autograd.graph.Node.register_hook()</code></a> æˆ– <a href="https://pytorch.org/docs/stable/generated/torch.autograd.graph.Node.register_prehook.html" title="torch.autograd.graph.Node.register_prehook"><code>torch.autograd.graph.Node.register_prehook()</code></a> æ³¨å†Œåˆ° <code>torch.autograd.graph.Node</code> çš„é’©å­ï¼Œåªæœ‰åœ¨èŠ‚ç‚¹æ‰§è¡Œæ—¶æ‰ä¼šè§¦å‘ã€‚</p>
<p>ç‰¹å®šèŠ‚ç‚¹æ˜¯å¦æ‰§è¡Œå–å†³äºåå‘ä¼ æ’­æ˜¯å¦é€šè¿‡ <a href="https://pytorch.org/docs/stable/generated/torch.autograd.grad.html" title="torch.autograd.grad"><code>torch.autograd.grad()</code></a> æˆ– <a href="https://pytorch.org/docs/stable/generated/torch.autograd.backward.html" title="torch.autograd.backward"><code>torch.autograd.backward()</code></a> è°ƒç”¨ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœæ‚¨åœ¨å¯¹åº”äºä¼ é€’ç»™ <code>inputs</code> å‚æ•°çš„å¼ é‡çš„èŠ‚ç‚¹ä¸Šæ³¨å†Œé’©å­ï¼Œåº”äº†è§£è¿™ä¸¤è€…ä¹‹é—´çš„å·®å¼‚ã€‚</p>
<p>å¦‚æœä½¿ç”¨ <a href="https://pytorch.org/docs/stable/generated/torch.autograd.backward.html" title="torch.autograd.backward"><code>torch.autograd.backward()</code></a>ï¼Œä¸Šè¿°æ‰€æœ‰é’©å­éƒ½ä¼šæ‰§è¡Œï¼Œæ— è®ºæ˜¯å¦æŒ‡å®šäº† <code>inputs</code> å‚æ•°ã€‚è¿™æ˜¯å› ä¸º <code>.backward()</code> ä¼šæ‰§è¡Œæ‰€æœ‰èŠ‚ç‚¹ï¼Œå³ä½¿å®ƒä»¬å¯¹åº”äºä½œä¸ºè¾“å…¥æŒ‡å®šçš„å¼ é‡ã€‚ï¼ˆæ³¨æ„ï¼Œæ‰§è¡Œé¢å¤–çš„èŠ‚ç‚¹é€šå¸¸æ˜¯ä¸å¿…è¦çš„ï¼Œä½†ä»ä¼šè¿™æ ·åšã€‚è¿™ç§è¡Œä¸ºå¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤ä¸åº”ä¾èµ–å®ƒã€‚ï¼‰</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½¿ç”¨ <a href="https://pytorch.org/docs/stable/generated/torch.autograd.grad.html" title="torch.autograd.grad"><code>torch.autograd.grad()</code></a>ï¼Œä¼ é€’ç»™ <code>input</code> çš„å¼ é‡æ‰€å¯¹åº”èŠ‚ç‚¹ä¸Šçš„åå‘é’©å­å¯èƒ½ä¸ä¼šæ‰§è¡Œï¼Œå› ä¸ºé™¤éæœ‰å¦ä¸€ä¸ªè¾“å…¥ä¾èµ–äºè¯¥èŠ‚ç‚¹çš„æ¢¯åº¦ç»“æœï¼Œå¦åˆ™ä¸ä¼šæ‰§è¡Œè¿™äº›èŠ‚ç‚¹ã€‚</p>
<h3 id="_18">é’©å­è§¦å‘é¡ºåº<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š</p>
<ol>
<li>é’©å­æ³¨å†Œåˆ°å¼ é‡æ—¶æ‰§è¡Œ</li>
<li>é’©å­æ³¨å†Œåˆ°èŠ‚ç‚¹çš„å‰é’©å­æ—¶æ‰§è¡Œï¼ˆå¦‚æœèŠ‚ç‚¹æ‰§è¡Œï¼‰</li>
<li>ä¸ºä¿ç•™æ¢¯åº¦çš„å¼ é‡æ›´æ–° <code>.grad</code> å­—æ®µ</li>
<li>èŠ‚ç‚¹æ‰§è¡Œï¼ˆå—ä¸Šè¿°è§„åˆ™çº¦æŸï¼‰</li>
<li>æ¢¯åº¦ç´¯ç§¯çš„å¶å¼ é‡æ‰§è¡Œæ¢¯åº¦ç´¯ç§¯åé’©å­</li>
<li>é’©å­æ³¨å†Œåˆ°èŠ‚ç‚¹çš„åé’©å­æ—¶æ‰§è¡Œï¼ˆå¦‚æœèŠ‚ç‚¹æ‰§è¡Œï¼‰</li>
</ol>
<p>å¦‚æœåŒç±»å‹çš„å¤šä¸ªé’©å­æ³¨å†Œåˆ°åŒä¸€ä¸ªå¼ é‡æˆ–èŠ‚ç‚¹ï¼Œå°†æŒ‰æ³¨å†Œé¡ºåºæ‰§è¡Œã€‚åæ‰§è¡Œçš„é’©å­å¯ä»¥çœ‹åˆ°ä¹‹å‰é’©å­å¯¹æ¢¯åº¦çš„ä¿®æ”¹ã€‚</p>
<h3 id="_19">ç‰¹æ®Šé’©å­<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p><a href="https://pytorch.org/docs/stable/autograd.html#torch.autograd.graph.register_multi_grad_hook" title="torch.autograd.graph.register_multi_grad_hook"><code>torch.autograd.graph.register_multi_grad_hook()</code></a> æ˜¯ä½¿ç”¨æ³¨å†Œåˆ°å¼ é‡çš„é’©å­å®ç°çš„ã€‚æ¯ä¸ªå•ç‹¬çš„å¼ é‡é’©å­æŒ‰ç…§ä¸Šè¿°é¡ºåºæ‰§è¡Œï¼Œå·²æ³¨å†Œçš„å¤šé‡æ¢¯åº¦é’©å­ä¼šåœ¨è®¡ç®—æœ€åä¸€ä¸ªå¼ é‡çš„æ¢¯åº¦æ—¶è§¦å‘ã€‚</p>
<p><a href="https://pytorch.org/docs/stable/generated/torch.nn.modules.module.register_module_full_backward_hook.html" title="torch.nn.modules.module.register_module_full_backward_hook"><code>torch.nn.modules.module.register_module_full_backward_hook()</code></a> æ˜¯ä½¿ç”¨æ³¨å†Œåˆ°èŠ‚ç‚¹çš„é’©å­å®ç°çš„ã€‚è®¡ç®—æ­£å‘ä¼ æ’­æ—¶ï¼Œé’©å­ä¼šæ³¨å†Œåˆ°æ¨¡å—çš„è¾“å…¥å’Œè¾“å‡ºçš„ <code>grad_fn</code>ã€‚ç”±äºæ¨¡å—å¯èƒ½æœ‰å¤šä¸ªè¾“å…¥å¹¶è¿”å›å¤šä¸ªè¾“å‡ºï¼Œå› æ­¤è‡ªå®šä¹‰çš„ <code>autograd</code> å‡½æ•°é¦–å…ˆåº”ç”¨äºæ¨¡å—çš„è¾“å…¥ï¼Œå†åº”ç”¨äºæ¨¡å—çš„è¾“å‡ºï¼Œä»¥ç¡®ä¿è¿™äº›å¼ é‡å…±äº«ä¸€ä¸ª <code>grad_fn</code>ï¼Œä»è€Œå¯ä»¥å°†é’©å­é™„åŠ åˆ°å…¶ä¸­ã€‚</p>
<h3 id="_20">ä¿®æ”¹å¼ é‡æ—¶çš„é’©å­è¡Œä¸º<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>é€šå¸¸ï¼Œæ³¨å†Œåˆ°å¼ é‡çš„é’©å­ä¼šæ¥æ”¶ç›¸å¯¹äºè¯¥å¼ é‡çš„è¾“å‡ºæ¢¯åº¦ï¼Œæ­¤æ—¶å¼ é‡çš„å€¼æ˜¯æ‰§è¡Œåå‘ä¼ æ’­æ—¶çš„å€¼ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ‚¨åœ¨æ³¨å†Œé’©å­åä¿®æ”¹å¼ é‡ï¼Œä¿®æ”¹å‰æ³¨å†Œçš„é’©å­ä¹Ÿä¼šæ¥æ”¶ç›¸å¯¹äºè¯¥å¼ é‡çš„è¾“å‡ºæ¢¯åº¦ï¼Œä½†æ­¤æ—¶å¼ é‡çš„å€¼æ˜¯ä¿®æ”¹å‰çš„å€¼ã€‚</p>
<p>å¦‚æœæ›´å–œæ¬¢å‰ä¸€ç§æƒ…å†µçš„è¡Œä¸ºï¼Œåº”åœ¨ä¿®æ”¹å¼ é‡åå†æ³¨å†Œé’©å­ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span>
<span class="linenos" data-linenos="2 "></span><span class="n">t</span><span class="o">.</span><span class="n">cos_</span><span class="p">()</span>
<span class="linenos" data-linenos="3 "></span><span class="n">t</span><span class="o">.</span><span class="n">register_hook</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="n">t</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</code></pre></div>
<p>æ­¤å¤–ï¼Œéœ€è¦çŸ¥é“æ³¨å†Œåˆ°å¼ é‡çš„é’©å­å®é™…ä¸Šæ°¸ä¹…ç»‘å®šåˆ°è¯¥å¼ é‡çš„ <code>grad_fn</code> ä¸Šã€‚å› æ­¤ï¼Œå¦‚æœä¿®æ”¹å¼ é‡ï¼Œå³ä½¿è¯¥å¼ é‡ç°åœ¨æœ‰ä¸€ä¸ªæ–°çš„ <code>grad_fn</code>ï¼Œä¿®æ”¹å‰æ³¨å†Œçš„é’©å­ä»ä¼šä¸æ—§çš„ <code>grad_fn</code> å…³è”ã€‚ä¾‹å¦‚ï¼Œå½“ autograd å¼•æ“åœ¨è®¡ç®—å›¾ä¸­è¾¾åˆ°è¯¥å¼ é‡çš„æ—§ <code>grad_fn</code> æ—¶ï¼Œå®ƒä»¬å°†ä¼šè§¦å‘ã€‚</p>
<h3 id="tensorregister_hookhook"><code>Tensor.register_hook(hook)</code><a class="headerlink" href="#tensorregister_hookhook" title="Permanent link">&para;</a></h3>
<p>æ³¨å†Œä¸€ä¸ªåå‘ä¼ æ’­é’©å­ã€‚</p>
<p>æ¯æ¬¡è®¡ç®—è¯¥å¼ é‡çš„æ¢¯åº¦æ—¶éƒ½ä¼šè°ƒç”¨è¯¥é’©å­ã€‚é’©å­çš„ç­¾ååº”å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">hook</span><span class="p">(</span><span class="n">grad</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span> <span class="ow">or</span> <span class="kc">None</span>
</code></pre></div>
<p>é’©å­ä¸åº”ä¿®æ”¹å…¶å‚æ•°ï¼Œä½†å¯ä»¥é€‰æ‹©æ€§åœ°è¿”å›ä¸€ä¸ªæ–°çš„æ¢¯åº¦ï¼Œç”¨ä»¥æ›¿æ¢åŸæ¥çš„ <a href="https://pytorch.org/docs/stable/generated/torch.Tensor.grad.html" title="torch.Tensor.grad"><code>grad</code></a>ã€‚</p>
<p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¥æŸ„ï¼Œå…·æœ‰ <code>handle.remove()</code> æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å°†é’©å­ä»æ¨¡å—ä¸­ç§»é™¤ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<p>æœ‰å…³æ­¤é’©å­ä½•æ—¶æ‰§è¡Œä»¥åŠå…¶ä¸å…¶ä»–é’©å­çš„æ‰§è¡Œé¡ºåºï¼Œè¯·å‚é˜…<a href="https://pytorch.org/docs/stable/notes/autograd.html#backward-hooks-execution">åå‘ä¼ æ’­é’©å­çš„æ‰§è¡Œ</a>ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">v</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="n">h</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">register_hook</span><span class="p">(</span><span class="k">lambda</span> <span class="n">grad</span><span class="p">:</span> <span class="n">grad</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># å°†æ¢¯åº¦ç¿»å€</span>
<span class="linenos" data-linenos="3 "></span><span class="n">v</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]))</span>
<span class="linenos" data-linenos="4 "></span><span class="n">v</span><span class="o">.</span><span class="n">grad</span>
<span class="linenos" data-linenos="5 "></span><span class="c1"># è¾“å‡ºï¼š</span>
<span class="linenos" data-linenos="6 "></span><span class="c1"># tensor([2., 4., 6.])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">h</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>  <span class="c1"># ç§»é™¤é’©å­</span>
</code></pre></div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../Attention%20Generation%20Work%20Flow/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Attention Generation Work Flow">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Attention Generation Work Flow
              </div>
            </div>
          </a>
        
        
          
          <a href="../PyTorch%20Autograd%20Explained%20-%20In-depth%20Tutorial/" class="md-footer__link md-footer__link--next" aria-label="Next: PyTorch Autograd Explained   In depth Tutorial">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                PyTorch Autograd Explained   In depth Tutorial
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "header.autohide"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="../mathjax-config.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../extra.js"></script>
      
        <script src="../js/toggle_sidebar.js"></script>
      
    
  </body>
</html>